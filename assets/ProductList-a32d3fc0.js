import{d as I,r as p,e as O,o as T,v as D,w as n,f as e,a as t,h as v,x as Z,I as F,aK as E,l as R,an as G,H as A,D as M,J as X,_ as j,a2 as Y,dZ as B,aT as x,ar as H,c as J,t as K,av as $,F as Q,k as W,c0 as ee,__tla as ae}from"./index-f0743f71.js";import{_ as te,__tla as le}from"./DictTag-4f08045a.js";import{g as re,__tla as oe}from"./index-71d2ef9b.js";import{D as q,__tla as ne}from"./dict-4a9940b3.js";import{f as z,__tla as ie}from"./formatter-d3f1795f.js";import{__tla as ue}from"./Table.vue_vue_type_style_index_0_scoped_b4105caf_lang-6757bef5.js";import{_ as de,__tla as pe}from"./Dialog-8f786edd.js";import{_ as se,__tla as ce}from"./index-cf7b3541.js";import"./color-f5b6e279.js";import{__tla as _e}from"./tsxHelper-0d496dea.js";import{__tla as me}from"./index-8beae3df.js";let L,fe=Promise.all([(()=>{try{return ae}catch{}})(),(()=>{try{return le}catch{}})(),(()=>{try{return oe}catch{}})(),(()=>{try{return ne}catch{}})(),(()=>{try{return ie}catch{}})(),(()=>{try{return ue}catch{}})(),(()=>{try{return pe}catch{}})(),(()=>{try{return ce}catch{}})(),(()=>{try{return _e}catch{}})(),(()=>{try{return me}catch{}})()]).then(async()=>{let S;S=j(I({name:"TableSelectForm",__name:"TableSelectForm",props:{modelValue:{type:Array,required:!0,default:()=>[]},title:{type:String,required:!0,default:"\u9009\u62E9"}},emits:["update:modelValue"],setup(k,{expose:P,emit:w}){const b=p([]),u=p(0),s=p(!1),c=p(!1),y=p(!1),f=O({pageNo:1,pageSize:10}),V=w,a=p(),l=p([]),_=d=>{l.value=d},g=()=>{y.value=!0;try{V("update:modelValue",l.value)}finally{y.value=!1,c.value=!1}},r=async d=>{s.value=!0;try{const i=await d(f);b.value=i.list,u.value=i.total}finally{s.value=!1}};return P({open:async d=>{c.value=!0,await G(),l.value.length>0&&a.value.clearSelection(),await r(d)}}),(d,i)=>{const U=A,o=se,h=M,C=de,N=X;return T(),D(C,{modelValue:t(c),"onUpdate:modelValue":i[3]||(i[3]=m=>R(c)?c.value=m:null),appendToBody:!0,scroll:!0,title:d.title,width:"60%"},{footer:n(()=>[e(h,{disabled:t(y),type:"primary",onClick:g},{default:n(()=>[v("\u786E \u5B9A")]),_:1},8,["disabled"]),e(h,{onClick:i[2]||(i[2]=m=>c.value=!1)},{default:n(()=>[v("\u53D6 \u6D88")]),_:1})]),default:n(()=>[Z((T(),D(t(F),{ref_key:"multipleTableRef",ref:a,data:t(b),"show-overflow-tooltip":!0,stripe:!0,onSelectionChange:_},{default:n(()=>[e(U,{type:"selection",width:"55"}),E(d.$slots,"default")]),_:3},8,["data"])),[[N,t(s)]]),e(o,{limit:t(f).pageSize,"onUpdate:limit":i[0]||(i[0]=m=>t(f).pageSize=m),page:t(f).pageNo,"onUpdate:page":i[1]||(i[1]=m=>t(f).pageNo=m),total:t(u),onPagination:r},null,8,["limit","page","total"])]),_:3},8,["modelValue","title"])}}}),[["__file","E:/newCode/GYZX-UI-ADMIN/src/components/Table/src/TableSelectForm.vue"]]),L=j(I({name:"ProductList",__name:"ProductList",props:{modelValue:{type:Array,required:!0,default:()=>[]}},emits:["update:modelValue"],setup(k,{emit:P}){const w=k,b=P,u=p([]),s=p([]),c=p(),y=()=>{var a;(a=c.value)==null||a.open(re)},f=Y(()=>a=>{const l=Number(a.price)/100*Number(a.count)*(1-Number(a.discountPercent)/100);return a.totalPrice=isNaN(l)?0:B(l),isNaN(l)?0:l.toFixed(2)}),V=p(!1);return x(()=>w.modelValue,a=>{a&&a.length!==0&&!V.value&&(u.value=[...w.modelValue.map(l=>(l.totalPrice=H(l.totalPrice),l))],V.value=!0)},{immediate:!0,deep:!0}),x(u,a=>{a&&a.length!==0&&b("update:modelValue",u.value)},{deep:!0}),x(s,a=>{if(!a||a.length===0)return;const l=u.value.map(g=>g.id),_=s.value.filter(g=>l.indexOf(g.id)===-1);_&&_.length!==0&&u.value.push(..._)},{deep:!0}),(a,l)=>{const _=M,g=W,r=A,d=te,i=ee,U=F;return T(),J(Q,null,[e(g,{justify:"end"},{default:n(()=>[e(_,{plain:"",type:"primary",onClick:y},{default:n(()=>[v("\u6DFB\u52A0\u4EA7\u54C1")]),_:1})]),_:1}),e(U,{data:t(u),"show-overflow-tooltip":!0,stripe:!0},{default:n(()=>[e(r,{align:"center",label:"\u4EA7\u54C1\u540D\u79F0",prop:"name",width:"120"}),e(r,{formatter:t(z),align:"center",label:"\u4EF7\u683C",prop:"price",width:"100"},null,8,["formatter"]),e(r,{align:"center",label:"\u4EA7\u54C1\u7C7B\u578B",prop:"categoryName",width:"100"}),e(r,{align:"center",label:"\u4EA7\u54C1\u5355\u4F4D",prop:"unit"},{default:n(o=>[e(d,{type:t(q).CRM_PRODUCT_UNIT,value:o.row.unit},null,8,["type","value"])]),_:1}),e(r,{align:"center",label:"\u4EA7\u54C1\u7F16\u7801",prop:"no"}),e(r,{align:"center",fixed:"right",label:"\u6570\u91CF",prop:"count",width:"100"},{default:n(({row:o})=>[e(i,{modelValue:o.count,"onUpdate:modelValue":h=>o.count=h,"controls-position":"right",min:0,precision:0,class:"!w-100%"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(r,{align:"center",fixed:"right",label:"\u6298\u6263(%)",prop:"discountPercent",width:"120"},{default:n(({row:o})=>[e(i,{modelValue:o.discountPercent,"onUpdate:modelValue":h=>o.discountPercent=h,"controls-position":"right",min:0,max:100,precision:0,class:"!w-100%"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(r,{align:"center",fixed:"right",label:"\u5408\u8BA1",prop:"totalPrice",width:"100"},{default:n(({row:o})=>[v(K(t($)(t(f)(o))),1)]),_:1}),e(r,{align:"center",fixed:"right",label:"\u64CD\u4F5C",width:"60"},{default:n(o=>[e(_,{link:"",type:"danger",onClick:h=>(C=>{const N=u.value.findIndex(m=>m.id===C);N!==-1&&u.value.splice(N,1)})(o.row.id)},{default:n(()=>[v(" \u79FB\u9664")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),e(t(S),{ref_key:"tableSelectFormRef",ref:c,modelValue:t(s),"onUpdate:modelValue":l[0]||(l[0]=o=>R(s)?s.value=o:null),title:"\u9009\u62E9\u4EA7\u54C1"},{default:n(()=>[e(r,{align:"center",label:"\u4EA7\u54C1\u540D\u79F0",prop:"name",width:"160"}),e(r,{align:"center",label:"\u4EA7\u54C1\u7C7B\u578B",prop:"categoryName",width:"160"}),e(r,{align:"center",label:"\u4EA7\u54C1\u5355\u4F4D",prop:"unit"},{default:n(o=>[e(d,{type:t(q).CRM_PRODUCT_UNIT,value:o.row.unit},null,8,["type","value"])]),_:1}),e(r,{align:"center",label:"\u4EA7\u54C1\u7F16\u7801",prop:"no"}),e(r,{formatter:t(z),align:"center",label:"\u4EF7\u683C\uFF08\u5143\uFF09",prop:"price",width:"100"},null,8,["formatter"])]),_:1},8,["modelValue"])],64)}}}),[["__file","E:/newCode/GYZX-UI-ADMIN/src/views/crm/contract/components/ProductList.vue"]])});export{fe as __tla,L as default};
