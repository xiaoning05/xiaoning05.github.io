import{d as B,r as c,cq as H,a2 as M,e7 as K,b9 as L,p as ee,o as m,c as f,f as s,w as r,g as e,a as t,h as y,t as h,l as w,F as P,q as A,v as ae,al as le,Q as te,D as se,y as re,z as ue,_ as ne,__tla as oe}from"./index-f0743f71.js";import{f as de,__tla as ie}from"./formatTime-e6df2ea5.js";import{g as ce,__tla as me}from"./index-5f468446.js";import{u as pe,__tla as ve}from"./useMessage-75a00a06.js";import{E as _e,__tla as fe}from"./index-a48a5540.js";let F,ye=Promise.all([(()=>{try{return oe}catch{}})(),(()=>{try{return ie}catch{}})(),(()=>{try{return me}catch{}})(),(()=>{try{return ve}catch{}})(),(()=>{try{return fe}catch{}})()]).then(async()=>{let g,b,V,k,U,I,N,S,D,O,$,J;g={class:"flex"},b=e("div",{class:"card-header"},[e("span",null,"\u8FDE\u63A5")],-1),V={class:"flex items-center"},k=e("span",{class:"mr-4 text-lg font-medium"}," \u8FDE\u63A5\u72B6\u6001: ",-1),U=e("hr",{class:"my-4"},null,-1),I={class:"flex"},N=e("p",{class:"mt-4 text-lg font-medium"},"\u6D88\u606F\u8F93\u5165\u6846",-1),S=e("hr",{class:"my-4"},null,-1),D=e("div",{class:"card-header"},[e("span",null,"\u6D88\u606F\u8BB0\u5F55")],-1),O={class:"max-h-80 overflow-auto"},$={class:"flex items-center"},J=e("span",{class:"text-primary mr-2 font-medium"},"\u6536\u5230\u6D88\u606F:",-1),F=ne(B({name:"InfraWebSocket",__name:"index",setup(he){const x=pe(),p=c("http://192.168.35.229:48080/infra/ws".replace("http","ws")+"?token="+H()),o=M(()=>C.value==="OPEN"),G=M(()=>o.value?"success":"red"),{status:C,data:d,send:Q,close:W,open:X}=K(p.value,{autoReconnect:!1,heartbeat:!0}),v=c([]);L(()=>{if(d.value)try{if(d.value==="pong")return;const n=JSON.parse(d.value),l=n.type,u=JSON.parse(n.content);if(!l)return void x.error("\u672A\u77E5\u7684\u6D88\u606F\u7C7B\u578B\uFF1A"+d.value);if(l==="demo-message-receive")return void(u.single?v.value.push({text:`\u3010\u5355\u53D1\u3011\u7528\u6237\u7F16\u53F7(${u.fromUserId})\uFF1A${u.text}`,time:new Date().getTime()}):v.value.push({text:`\u3010\u7FA4\u53D1\u3011\u7528\u6237\u7F16\u53F7(${u.fromUserId})\uFF1A${u.text}`,time:new Date().getTime()}));if(l==="notice-push")return void v.value.push({text:`\u3010\u7CFB\u7EDF\u901A\u77E5\u3011\uFF1A${u.title}`,time:new Date().getTime()});x.error("\u672A\u5904\u7406\u6D88\u606F\uFF1A"+d.value)}catch(n){x.error("\u5904\u7406\u6D88\u606F\u53D1\u751F\u5F02\u5E38\uFF1A"+d.value),console.error(n)}});const i=c(""),_=c(""),Y=()=>{const n=JSON.stringify({text:i.value,toUserId:_.value}),l=JSON.stringify({type:"demo-message-send",content:n});Q(l),i.value=""},Z=()=>{o.value?W():X()},E=c([]);return ee(async()=>{E.value=await ce()}),(n,l)=>{const u=le,R=te,T=se,q=re,j=ue,z=_e;return m(),f("div",g,[s(z,{gutter:12,class:"w-1/2",shadow:"always"},{header:r(()=>[b]),default:r(()=>[e("div",V,[k,s(u,{color:t(G)},{default:r(()=>[y(h(t(C)),1)]),_:1},8,["color"])]),U,e("div",I,[s(R,{modelValue:t(p),"onUpdate:modelValue":l[0]||(l[0]=a=>w(p)?p.value=a:null),disabled:""},{prepend:r(()=>[y("\u670D\u52A1\u5730\u5740")]),_:1},8,["modelValue"]),s(T,{type:t(o)?"danger":"primary",onClick:Z},{default:r(()=>[y(h(t(o)?"\u5173\u95ED\u8FDE\u63A5":"\u5F00\u542F\u8FDE\u63A5"),1)]),_:1},8,["type"])]),N,S,s(R,{modelValue:t(i),"onUpdate:modelValue":l[1]||(l[1]=a=>w(i)?i.value=a:null),autosize:{minRows:2,maxRows:4},disabled:!t(o),clearable:"",type:"textarea",placeholder:"\u8BF7\u8F93\u5165\u4F60\u8981\u53D1\u9001\u7684\u6D88\u606F"},null,8,["modelValue","disabled"]),s(j,{modelValue:t(_),"onUpdate:modelValue":l[2]||(l[2]=a=>w(_)?_.value=a:null),class:"mt-4",placeholder:"\u8BF7\u9009\u62E9\u53D1\u9001\u4EBA"},{default:r(()=>[s(q,{key:"",label:"\u6240\u6709\u4EBA",value:""}),(m(!0),f(P,null,A(t(E),a=>(m(),ae(q,{key:a.id,label:a.nickname,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),s(T,{disabled:!t(o),block:"",class:"ml-2 mt-4",type:"primary",onClick:Y},{default:r(()=>[y(" \u53D1\u9001 ")]),_:1},8,["disabled"])]),_:1}),s(z,{gutter:12,class:"w-1/2",shadow:"always"},{header:r(()=>[D]),default:r(()=>[e("div",O,[e("ul",null,[(m(!0),f(P,null,A(t(v).reverse(),a=>(m(),f("li",{key:a.time,class:"mt-2"},[e("div",$,[J,e("span",null,h(t(de)(a.time)),1)]),e("div",null,h(a.text),1)]))),128))])])]),_:1})])}}}),[["__file","E:/newCode/GYZX-UI-ADMIN/src/views/infra/webSocket/index.vue"]])});export{ye as __tla,F as default};
