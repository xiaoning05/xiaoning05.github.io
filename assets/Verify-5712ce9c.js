import{_ as ee,i as te,bY as ie,am as se,r as t,e as j,a2 as oe,aT as He,p as ce,o as W,c as O,a as e,aw as w,g as n,x as ae,a4 as le,f as $e,w as Oe,S as Z,t as J,a5 as U,U as Ce,an as ue,dq as pe,dr as ve,F as Ne,q as Ve,b9 as Be,h as Ee,v as De,aR as Me,__tla as je}from"./index-f0743f71.js";import{C as Y,__tla as Je}from"./index-21698e53.js";let he,Le=Promise.all([(()=>{try{return je}catch{}})(),(()=>{try{return Je}catch{}})()]).then(async()=>{function q(a,g="XwKsGlMcdPMEhR1B"){const l=Y.enc.Utf8.parse(g),o=Y.enc.Utf8.parse(a);return Y.AES.encrypt(o,l,{mode:Y.mode.ECB,padding:Y.pad.Pkcs7}).toString()}function ne(a){let g,l,o,h;const r=window,c=a.$el.parentNode.offsetWidth||r.offsetWidth,f=a.$el.parentNode.offsetHeight||r.offsetHeight;return g=a.imgSize.width.indexOf("%")!=-1?parseInt(a.imgSize.width)/100*c+"px":a.imgSize.width,l=a.imgSize.height.indexOf("%")!=-1?parseInt(a.imgSize.height)/100*f+"px":a.imgSize.height,o=a.barSize.width.indexOf("%")!=-1?parseInt(a.barSize.width)/100*c+"px":a.barSize.width,h=a.barSize.height.indexOf("%")!=-1?parseInt(a.barSize.height)/100*f+"px":a.barSize.height,{imgWidth:g,imgHeight:l,barWidth:o,barHeight:h}}const de={style:{position:"relative"}},ge=["src"],fe=[n("i",{class:"iconfont icon-refresh"},null,-1)],ye=["textContent"],me=["textContent"],be=["src"],Se=ee({__name:"VerifySlide",props:{captchaType:{type:String},type:{type:String,default:"1"},mode:{type:String,default:"fixed"},vSpace:{type:Number,default:5},explain:{type:String,default:""},imgSize:{type:Object,default:()=>({width:"310px",height:"155px"})},blockSize:{type:Object,default:()=>({width:"50px",height:"50px"})},barSize:{type:Object,default:()=>({width:"310px",height:"30px"})}},setup(a){const g=a,{t:l}=te(),{mode:o,captchaType:h,type:r,blockSize:c,explain:f}=ie(g),{proxy:p}=se();let u=t(""),x=t(""),L=t(""),P=t(""),T=t(""),y=t(""),V=t(""),m=t(""),z=t(""),B=t(""),v=j({imgHeight:0,imgWidth:0,barHeight:0,barWidth:0}),C=t(void 0),_=t(void 0),H=t(void 0),N=t("#ddd"),$=t(void 0),E=t("icon-right"),D=t(!1),s=t(!1),d=t(!0),b=t(""),S=t(""),X=t(0);const M=oe(()=>p.$el.querySelector(".verify-bar-area")),A=()=>{f.value===""?z.value=l("captcha.slide"):z.value=f.value,re(),ue(()=>{let{imgHeight:i,imgWidth:k,barHeight:I,barWidth:Q}=ne(p);v.imgHeight=i,v.imgWidth=k,v.barHeight=I,v.barWidth=Q,p.$parent.$emit("ready",p)}),window.removeEventListener("touchmove",function(i){R(i)}),window.removeEventListener("mousemove",function(i){R(i)}),window.removeEventListener("touchend",function(){K()}),window.removeEventListener("mouseup",function(){K()}),window.addEventListener("touchmove",function(i){R(i)}),window.addEventListener("mousemove",function(i){R(i)}),window.addEventListener("touchend",function(){K()}),window.addEventListener("mouseup",function(){K()})};He(r,()=>{A()}),ce(()=>{A(),p.$el.onselectstart=function(){return!1}});const G=i=>{if((i=i||window.event).touches)k=i.touches[0].pageX;else var k=i.clientX;X.value=Math.floor(k-M.value.getBoundingClientRect().left),y.value=+new Date,s.value==0&&(z.value="",H.value="#337ab7",N.value="#337AB7",$.value="#fff",i.stopPropagation(),D.value=!0)},R=i=>{if(i=i||window.event,D.value&&s.value==0){if(i.touches)k=i.touches[0].pageX;else var k=i.clientX;var I=k-M.value.getBoundingClientRect().left;I>=M.value.offsetWidth-parseInt(parseInt(c.value.width)/2)-2&&(I=M.value.offsetWidth-parseInt(parseInt(c.value.width)/2)-2),I<=0&&(I=parseInt(parseInt(c.value.width)/2)),C.value=I-X.value+"px",_.value=I-X.value+"px"}},K=()=>{if(V.value=+new Date,D.value&&s.value==0){var i=parseInt((C.value||"0").replace("px",""));i=310*i/parseInt(v.imgWidth);let k={captchaType:h.value,pointJson:u.value?q(JSON.stringify({x:i,y:5}),u.value):JSON.stringify({x:i,y:5}),token:T.value};pe(k).then(I=>{if(I.repCode=="0000"){H.value="#5cb85c",N.value="#5cb85c",$.value="#fff",E.value="icon-check",d.value=!1,s.value=!0,o.value=="pop"&&setTimeout(()=>{p.$parent.clickShow=!1,F()},1500),x.value=!0,m.value=`${((V.value-y.value)/1e3).toFixed(2)}s
            ${l("captcha.success")}`;var Q=u.value?q(T.value+"---"+JSON.stringify({x:i,y:5}),u.value):T.value+"---"+JSON.stringify({x:i,y:5});setTimeout(()=>{m.value="",p.$parent.closeBox(),p.$parent.$emit("success",{captchaVerification:Q})},1e3)}else H.value="#d9534f",N.value="#d9534f",$.value="#fff",E.value="icon-close",x.value=!1,setTimeout(function(){F()},1e3),p.$parent.$emit("error",p),m.value=l("captcha.fail"),setTimeout(()=>{m.value=""},1e3)}),D.value=!1}},F=async()=>{d.value=!0,B.value="",b.value="left .3s",C.value=0,_.value=void 0,S.value="width .3s",N.value="#ddd",H.value="#fff",$.value="#000",E.value="icon-right",s.value=!1,await re(),setTimeout(()=>{S.value="",b.value="",z.value=f.value},300)},re=async()=>{h.value;const i=await ve();i.repCode=="0000"?(L.value=i.repData.originalImageBase64,P.value=i.repData.jigsawImageBase64,T.value=i.repData.token,u.value=i.repData.secretKey):m.value=i.repMsg};return(i,k)=>(W(),O("div",de,[e(r)==="2"?(W(),O("div",{key:0,style:w({height:parseInt(e(v).imgHeight)+a.vSpace+"px"}),class:"verify-img-out"},[n("div",{style:w({width:e(v).imgWidth,height:e(v).imgHeight}),class:"verify-img-panel"},[n("img",{src:"data:image/png;base64,"+e(L),alt:"",style:{display:"block",width:"100%",height:"100%"}},null,8,ge),ae(n("div",{class:"verify-refresh",onClick:F},[...fe],512),[[le,e(d)]]),$e(Ce,{name:"tips"},{default:Oe(()=>[e(m)?(W(),O("span",{key:0,class:Z([e(x)?"suc-bg":"err-bg","verify-tips"])},J(e(m)),3)):U("",!0)]),_:1})],4)],4)):U("",!0),n("div",{style:w({width:e(v).imgWidth,height:a.barSize.height,"line-height":a.barSize.height}),class:"verify-bar-area"},[n("span",{class:"verify-msg",textContent:J(e(z))},null,8,ye),n("div",{style:w({width:e(_)!==void 0?e(_):a.barSize.height,height:a.barSize.height,"border-color":e(N),transaction:e(S)}),class:"verify-left-bar"},[n("span",{class:"verify-msg",textContent:J(e(B))},null,8,me),n("div",{style:w({width:a.barSize.height,height:a.barSize.height,"background-color":e(H),left:e(C),transition:e(b)}),class:"verify-move-block",onMousedown:G,onTouchstart:G},[n("i",{class:Z(["verify-icon iconfont",e(E)]),style:w({color:e($)})},null,6),e(r)==="2"?(W(),O("div",{key:0,style:w({width:Math.floor(47*parseInt(e(v).imgWidth)/310)+"px",height:e(v).imgHeight,top:"-"+(parseInt(e(v).imgHeight)+a.vSpace)+"px","background-size":e(v).imgWidth+" "+e(v).imgHeight}),class:"verify-sub-block"},[n("img",{src:"data:image/png;base64,"+e(P),alt:"",style:{display:"block",width:"100%",height:"100%","-webkit-user-drag":"none"}},null,8,be)],4)):U("",!0)],36)],4)],4)]))}},[["__file","E:/newCode/GYZX-UI-ADMIN/src/components/Verifition/src/Verify/VerifySlide.vue"]]),we={style:{position:"relative"}},xe={class:"verify-img-out"},ze=[n("i",{class:"iconfont icon-refresh"},null,-1)],ke=["src"],Ie={class:"verify-msg"},We={name:"Vue3Verify",components:{VerifySlide:Se,VerifyPoints:ee({__name:"VerifyPoints",props:{mode:{type:String,default:"fixed"},captchaType:{type:String},vSpace:{type:Number,default:5},imgSize:{type:Object,default:()=>({width:"310px",height:"155px"})},barSize:{type:Object,default:()=>({width:"310px",height:"40px"})}},setup(a){const g=a,{t:l}=te(),{mode:o,captchaType:h}=ie(g),{proxy:r}=se();let c=t(""),f=t(3),p=j([]),u=j([]),x=t(1),L=t(""),P=j([]),T=t(""),y=j({imgHeight:0,imgWidth:0,barHeight:0,barWidth:0}),V=j([]),m=t(""),z=t(void 0),B=t(void 0),v=t(!0),C=t(!0);ce(()=>{p.splice(0,p.length),u.splice(0,u.length),x.value=1,E(),ue(()=>{let{imgHeight:s,imgWidth:d,barHeight:b,barWidth:S}=ne(r);y.imgHeight=s,y.imgWidth=d,y.barHeight=b,y.barWidth=S,r.$parent.$emit("ready",r)}),r.$el.onselectstart=function(){return!1}});const _=t(null),H=function(s,d){return{x:d.offsetX,y:d.offsetY}},N=function(s){return V.push(Object.assign({},s)),x.value+1},$=async function(){V.splice(0,V.length),z.value="#000",B.value="#ddd",C.value=!0,p.splice(0,p.length),u.splice(0,u.length),x.value=1,await E(),v.value=!0},E=async()=>{h.value;const s=await ve();s.repCode=="0000"?(L.value=s.repData.originalImageBase64,T.value=s.repData.token,c.value=s.repData.secretKey,P.value=s.repData.wordList,m.value=l("captcha.point")+"\u3010"+P.value.join(",")+"\u3011"):m.value=s.repMsg},D=function(s,d){return s.map(b=>({x:Math.round(310*b.x/parseInt(d.imgWidth)),y:Math.round(155*b.y/parseInt(d.imgHeight))}))};return(s,d)=>(W(),O("div",we,[n("div",xe,[n("div",{style:w({width:e(y).imgWidth,height:e(y).imgHeight,"background-size":e(y).imgWidth+" "+e(y).imgHeight,"margin-bottom":a.vSpace+"px"}),class:"verify-img-panel"},[ae(n("div",{class:"verify-refresh",style:{"z-index":"3"},onClick:$},[...ze],512),[[le,e(v)]]),n("img",{ref_key:"canvas",ref:_,src:"data:image/png;base64,"+e(L),alt:"",style:{display:"block",width:"100%",height:"100%"},onClick:d[0]||(d[0]=b=>e(C)?(S=>{if(u.push(H(_,S)),x.value==f.value){x.value=N(H(_,S));let X=D(u,y);u.length=0,u.push(...X),setTimeout(()=>{var M=c.value?q(T.value+"---"+JSON.stringify(u),c.value):T.value+"---"+JSON.stringify(u);let A={captchaType:h.value,pointJson:c.value?q(JSON.stringify(u),c.value):JSON.stringify(u),token:T.value};pe(A).then(G=>{G.repCode=="0000"?(z.value="#4cae4c",B.value="#5cb85c",m.value=l("captcha.success"),C.value=!1,o.value=="pop"&&setTimeout(()=>{r.$parent.clickShow=!1,$()},1500),r.$parent.$emit("success",{captchaVerification:M})):(r.$parent.$emit("error",r),z.value="#d9534f",B.value="#d9534f",m.value=l("captcha.fail"),setTimeout(()=>{$()},700))})},400)}x.value<f.value&&(x.value=N(H(_,S)))})(b):void 0)},null,8,ke),(W(!0),O(Ne,null,Ve(e(V),(b,S)=>(W(),O("div",{key:S,style:w({"background-color":"#1abd6c",color:"#fff","z-index":9999,width:"20px",height:"20px","text-align":"center","line-height":"20px","border-radius":"50%",position:"absolute",top:parseInt(b.y-10)+"px",left:parseInt(b.x-10)+"px"}),class:"point-area"},J(S+1),5))),128))],4)]),n("div",{style:w({width:e(y).imgWidth,color:e(z),"border-color":e(B),"line-height":a.barSize.height}),class:"verify-bar-area"},[n("span",Ie,J(e(m)),1)],4)]))}},[["__file","E:/newCode/GYZX-UI-ADMIN/src/components/Verifition/src/Verify/VerifyPoints.vue"]])},props:{captchaType:{type:String,required:!0},figure:{type:Number},arith:{type:Number},mode:{type:String,default:"pop"},vSpace:{type:Number},explain:{type:String},imgSize:{type:Object,default:()=>({width:"310px",height:"155px"})},blockSize:{type:Object},barSize:{type:Object}},setup(a){const{t:g}=te(),{captchaType:l,mode:o}=ie(a),h=t(!1),r=t(void 0),c=t(void 0),f=t({}),p=oe(()=>o.value!="pop"||h.value);return Be(()=>{switch(l.value){case"blockPuzzle":r.value="2",c.value="VerifySlide";break;case"clickWord":r.value="",c.value="VerifyPoints"}}),{t:g,clickShow:h,verifyType:r,componentType:c,instance:f,showBox:p,closeBox:()=>{h.value=!1,f.value.refresh&&f.value.refresh()},show:()=>{o.value=="pop"&&(h.value=!0)}}}},Te={key:0,class:"verifybox-top"},_e=[n("i",{class:"iconfont icon-close"},null,-1)];he=ee(We,[["render",function(a,g,l,o,h,r){return ae((W(),O("div",{class:Z(l.mode=="pop"?"mask":"")},[n("div",{class:Z(l.mode=="pop"?"verifybox":""),style:w({"max-width":parseInt(l.imgSize.width)+20+"px"})},[l.mode=="pop"?(W(),O("div",Te,[Ee(J(o.t("captcha.verification"))+" ",1),n("span",{class:"verifybox-close",onClick:g[0]||(g[0]=(...c)=>o.closeBox&&o.closeBox(...c))},[..._e])])):U("",!0),n("div",{style:w({padding:l.mode=="pop"?"10px":"0"}),class:"verifybox-bottom"},[o.componentType?(W(),De(Me(o.componentType),{key:0,ref:"instance",arith:l.arith,barSize:l.barSize,blockSize:l.blockSize,captchaType:l.captchaType,explain:l.explain,figure:l.figure,imgSize:l.imgSize,mode:l.mode,type:o.verifyType,vSpace:l.vSpace},null,8,["arith","barSize","blockSize","captchaType","explain","figure","imgSize","mode","type","vSpace"])):U("",!0)],4)],6)],2)),[[le,o.showBox]])}],["__file","E:/newCode/GYZX-UI-ADMIN/src/components/Verifition/src/Verify.vue"]])});export{he as _,Le as __tla};
