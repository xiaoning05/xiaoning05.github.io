import{d as q,i as z,r as u,e as B,o as v,v as h,w as s,f as d,a,h as c,x as J,t as b,c as K,F as X,q as Z,l as S,a5 as H,al as L,A as Q,y as $,z as W,G as ee,a0 as ae,dV as le,D as te,J as oe,_ as se,__tla as de}from"./index-f0743f71.js";import{_ as ue,__tla as re}from"./Dialog-8f786edd.js";import{a as ce,D as ne,__tla as me}from"./dict-4a9940b3.js";import{d as _e,h as ie}from"./tree-02f455f9.js";import{m as C}from"./constants-99751ef9.js";import{g as pe,__tla as ve}from"./index-cb25e840.js";import{b as fe,__tla as ye}from"./index-4c66278d.js";import{u as he,__tla as Se}from"./useMessage-75a00a06.js";import{E as xe,__tla as Ve}from"./index-a48a5540.js";let w,ke=Promise.all([(()=>{try{return de}catch{}})(),(()=>{try{return re}catch{}})(),(()=>{try{return me}catch{}})(),(()=>{try{return ve}catch{}})(),(()=>{try{return ye}catch{}})(),(()=>{try{return Se}catch{}})(),(()=>{try{return Ve}catch{}})()]).then(async()=>{w=se(q({name:"SystemRoleDataPermissionForm",__name:"RoleDataPermissionForm",emits:["success"],setup(De,{expose:P,emit:U}){const{t:E}=z(),I=he(),n=u(!1),f=u(!1),o=B({id:0,name:"",code:"",dataScope:void 0,dataScopeDeptIds:[]}),k=u(),x=u([]),m=u(!0),_=u(),i=u(!1),p=u(!0);P({open:async l=>{var e;n.value=!0,M(),x.value=ie(await pe()),o.id=l.id,o.name=l.name,o.code=l.code,o.dataScope=l.dataScope,(e=l.dataScopeDeptIds)==null||e.forEach(r=>{_.value.setChecked(r,!0,!1)})}});const T=U,F=async()=>{f.value=!0;try{const l={roleId:o.id,dataScope:o.dataScope,dataScopeDeptIds:o.dataScope!==C.DEPT_CUSTOM?[]:_.value.getCheckedKeys(!1)};await fe(l),I.success(E("common.updateSuccess")),n.value=!1,T("success")}finally{f.value=!1}},M=()=>{var l,e;i.value=!1,m.value=!0,p.value=!0,o.value={id:0,name:"",code:"",dataScope:void 0,dataScopeDeptIds:[]},(l=_.value)==null||l.setCheckedNodes([]),(e=k.value)==null||e.resetFields()},R=()=>{var e;const l=(e=_.value)==null?void 0:e.store.nodesMap;for(let r in l)l[r].expanded!==m.value&&(l[r].expanded=m.value)};return(l,e)=>{const r=L,y=Q,g=$,A=W,N=ee,V=ae,O=le,G=xe,D=te,Y=ue,j=oe;return v(),h(Y,{modelValue:a(n),"onUpdate:modelValue":e[6]||(e[6]=t=>S(n)?n.value=t:null),title:"\u83DC\u5355\u6743\u9650",width:"800"},{footer:s(()=>[d(D,{disabled:a(f),type:"primary",onClick:F},{default:s(()=>[c("\u786E \u5B9A")]),_:1},8,["disabled"]),d(D,{onClick:e[5]||(e[5]=t=>n.value=!1)},{default:s(()=>[c("\u53D6 \u6D88")]),_:1})]),default:s(()=>[J((v(),h(N,{ref_key:"formRef",ref:k,model:a(o),"label-width":"80px"},{default:s(()=>[d(y,{label:"\u89D2\u8272\u540D\u79F0"},{default:s(()=>[d(r,null,{default:s(()=>[c(b(a(o).name),1)]),_:1})]),_:1}),d(y,{label:"\u89D2\u8272\u6807\u8BC6"},{default:s(()=>[d(r,null,{default:s(()=>[c(b(a(o).code),1)]),_:1})]),_:1}),d(y,{label:"\u6743\u9650\u8303\u56F4"},{default:s(()=>[d(A,{modelValue:a(o).dataScope,"onUpdate:modelValue":e[0]||(e[0]=t=>a(o).dataScope=t)},{default:s(()=>[(v(!0),K(X,null,Z(a(ce)(a(ne).SYSTEM_DATA_SCOPE),t=>(v(),h(g,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])),[[j,a(f)]]),a(o).dataScope===a(C).DEPT_CUSTOM?(v(),h(y,{key:0,label:"\u6743\u9650\u8303\u56F4",style:{display:"flex"}},{default:s(()=>[d(G,{class:"card",shadow:"never"},{header:s(()=>[c(" \u5168\u9009/\u5168\u4E0D\u9009: "),d(V,{modelValue:a(i),"onUpdate:modelValue":e[1]||(e[1]=t=>S(i)?i.value=t:null),"active-text":"\u662F","inactive-text":"\u5426","inline-prompt":"",onChange:e[2]||(e[2]=t=>{_.value.setCheckedNodes(i.value?x.value:[])})},null,8,["modelValue"]),c(" \u5168\u90E8\u5C55\u5F00/\u6298\u53E0: "),d(V,{modelValue:a(m),"onUpdate:modelValue":e[3]||(e[3]=t=>S(m)?m.value=t:null),"active-text":"\u5C55\u5F00","inactive-text":"\u6298\u53E0","inline-prompt":"",onChange:R},null,8,["modelValue"]),c(" \u7236\u5B50\u8054\u52A8(\u9009\u4E2D\u7236\u8282\u70B9\uFF0C\u81EA\u52A8\u9009\u62E9\u5B50\u8282\u70B9): "),d(V,{modelValue:a(p),"onUpdate:modelValue":e[4]||(e[4]=t=>S(p)?p.value=t:null),"active-text":"\u662F","inactive-text":"\u5426","inline-prompt":""},null,8,["modelValue"])]),default:s(()=>[d(O,{ref_key:"treeRef",ref:_,"check-strictly":!a(p),data:a(x),props:a(_e),"default-expand-all":"","empty-text":"\u52A0\u8F7D\u4E2D\uFF0C\u8BF7\u7A0D\u540E","node-key":"id","show-checkbox":""},null,8,["check-strictly","data","props"])]),_:1})]),_:1})):H("",!0)]),_:1},8,["modelValue"])}}}),[["__file","E:/newCode/GYZX-UI-ADMIN/src/views/system/role/RoleDataPermissionForm.vue"]])});export{ke as __tla,w as default};
