import{d as O,k as Z,r as i,n as z,p as J,o as b,q as y,e as l,b as a,a as r,h as p,w as K,c as Q,F as W,g as ee,t as ae,j as le,at as P,ar as te,dY as U,L as re,y as oe,af as ue,ag as se,bY as de,E as ne,bX as ie,B as ce,i as me,A as pe,C as fe,v as _e,_ as ge,__tla as he}from"./index-aaa5adb3.js";import{_ as Ve,__tla as Ce}from"./Dialog-9a73a39c.js";import{a as ve,D as be,__tla as xe}from"./dict-f2796e71.js";import{a as we,c as ye,u as Pe,__tla as Ue}from"./index-6e8ca6a6.js";import{g as Te,__tla as ke}from"./index-380f2c90.js";import{d as Ee}from"./tree-02f455f9.js";import{u as Me,__tla as Ie}from"./useMessage-873da1e2.js";let A,Se=Promise.all([(()=>{try{return he}catch{}})(),(()=>{try{return Ce}catch{}})(),(()=>{try{return xe}catch{}})(),(()=>{try{return Ue}catch{}})(),(()=>{try{return ke}catch{}})(),(()=>{try{return Ie}catch{}})()]).then(async()=>{A=ge(O({__name:"ExpressTemplateForm",emits:["success"],setup(qe,{expose:F,emit:R}){const{t:x}=Z(),T=Me(),k={...Ee,multiple:!0},f=i(!1),E=i(""),_=i(!1),M=i(""),o=i({id:void 0,name:"",chargeMode:1,sort:0,charges:[],frees:[]}),g=new Map,h=i({startCountTitle:"\u9996\u4EF6",extraCountTitle:"\u7EED\u4EF6",freeCountTitle:"\u5305\u90AE\u4EF6\u6570"}),X=z({name:[{required:!0,message:"\u6A21\u677F\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],chargeMode:[{required:!0,message:"\u914D\u9001\u8BA1\u8D39\u65B9\u5F0F\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],sort:[{required:!0,message:"\u5206\u7C7B\u6392\u5E8F\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),v=i();F({open:async(s,t)=>{f.value=!0,E.value=x("action."+s),M.value=s,G();try{t&&(_.value=!0,o.value=await we(t),h.value=g.get(o.value.chargeMode),o.value.charges.forEach(n=>{n.startPrice=P(n.startPrice),n.extraPrice=P(n.extraPrice)}),o.value.frees.forEach(n=>{n.freePrice=P(n.freePrice)}))}finally{_.value=!1}}});const Y=R,D=async()=>{if(v&&await v.value.validate()){_.value=!0;try{const s=te(o.value);s.charges.forEach(t=>{t.startPrice=U(t.startPrice),t.extraPrice=U(t.extraPrice)}),s.frees.forEach(t=>{t.freePrice=U(t.freePrice)}),M.value==="create"?(await ye(s),T.success(x("common.createSuccess"))):(await Pe(s),T.success(x("common.updateSuccess"))),f.value=!1,Y("success")}finally{_.value=!1}}},G=()=>{var s;o.value={id:void 0,name:"",chargeMode:1,charges:[{areaIds:[1],startCount:2,startPrice:5,extraCount:5,extraPrice:10}],frees:[],sort:0},h.value=g.get(1),(s=v.value)==null||s.resetFields()},j=s=>{h.value=g.get(s)},w=i([]);return J(()=>{(async()=>(g.set(1,{startCountTitle:"\u9996\u4EF6",extraCountTitle:"\u7EED\u4EF6",freeCountTitle:"\u5305\u90AE\u4EF6\u6570"}),g.set(2,{startCountTitle:"\u9996\u4EF6\u91CD\u91CF(kg)",extraCountTitle:"\u7EED\u4EF6\u91CD\u91CF(kg)",freeCountTitle:"\u5305\u90AE\u91CD\u91CF(kg)"}),g.set(3,{startCountTitle:"\u9996\u4EF6\u4F53\u79EF(m\xB3)",extraCountTitle:"\u7EED\u4EF6\u4F53\u79EF(m\xB3)",freeCountTitle:"\u5305\u90AE\u4F53\u79EF(m\xB3)"}),w.value=await Te()))()}),(s,t)=>{const n=re,c=oe,$=ue,B=se,I=de,d=ne,m=ie,V=ce,S=me,q=pe,H=fe,L=Ve,N=_e;return b(),y(L,{title:r(E),modelValue:r(f),"onUpdate:modelValue":t[6]||(t[6]=e=>le(f)?f.value=e:null),width:"1300px"},{footer:l(()=>[a(V,{onClick:D,type:"primary",disabled:r(_)},{default:l(()=>[p("\u786E \u5B9A")]),_:1},8,["disabled"]),a(V,{onClick:t[5]||(t[5]=e=>f.value=!1)},{default:l(()=>[p("\u53D6 \u6D88")]),_:1})]),default:l(()=>[K((b(),y(H,{ref_key:"formRef",ref:v,model:r(o),rules:r(X),"label-width":"80px"},{default:l(()=>[a(c,{label:"\u6A21\u677F\u540D\u79F0",prop:"name"},{default:l(()=>[a(n,{modelValue:r(o).name,"onUpdate:modelValue":t[0]||(t[0]=e=>r(o).name=e),placeholder:"\u8BF7\u8F93\u5165\u6A21\u677F\u540D\u79F0"},null,8,["modelValue"])]),_:1}),a(c,{label:"\u8BA1\u8D39\u65B9\u5F0F",prop:"chargeMode"},{default:l(()=>[a(B,{modelValue:r(o).chargeMode,"onUpdate:modelValue":t[1]||(t[1]=e=>r(o).chargeMode=e),onChange:j},{default:l(()=>[(b(!0),Q(W,null,ee(r(ve)(r(be).EXPRESS_CHARGE_MODE),e=>(b(),y($,{key:e.value,label:e.value},{default:l(()=>[p(ae(e.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(c,{label:"\u8FD0\u8D39",prop:"charges"},{default:l(()=>[a(S,{border:"",style:{width:"100%"},data:r(o).charges},{default:l(()=>[a(d,{align:"center",label:"\u533A\u57DF",width:"360"},{default:l(({row:e})=>[a(I,{modelValue:e.areaIds,"onUpdate:modelValue":u=>e.areaIds=u,options:r(w),props:k,class:"w-1/1",clearable:"",placeholder:"\u8BF7\u9009\u62E9\u5730\u533A",filterable:"","collapse-tags":""},null,8,["modelValue","onUpdate:modelValue","options"])]),_:1}),a(d,{align:"center",label:r(h).startCountTitle,width:"180",prop:"startCount"},{default:l(({row:e})=>[a(m,{modelValue:e.startCount,"onUpdate:modelValue":u=>e.startCount=u,min:1},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"]),a(d,{width:"180",align:"center",label:"\u8FD0\u8D39(\u5143)",prop:"startPrice"},{default:l(({row:e})=>[a(m,{modelValue:e.startPrice,"onUpdate:modelValue":u=>e.startPrice=u,min:1},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),a(d,{width:"180",align:"center",label:r(h).extraCountTitle,prop:"extraCount"},{default:l(({row:e})=>[a(m,{modelValue:e.extraCount,"onUpdate:modelValue":u=>e.extraCount=u,min:1},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"]),a(d,{width:"180",align:"center",label:"\u7EED\u8D39(\u5143)",prop:"extraPrice"},{default:l(({row:e})=>[a(m,{modelValue:e.extraPrice,"onUpdate:modelValue":u=>e.extraPrice=u,min:1},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),a(d,{label:"\u64CD\u4F5C",align:"center"},{default:l(e=>[a(V,{link:"",type:"danger",onClick:u=>{return C=e.$index,void o.value.charges.splice(C,1);var C}},{default:l(()=>[p(" \u5220\u9664 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1}),a(c,null,{default:l(()=>[a(V,{type:"primary",plain:"",onClick:t[2]||(t[2]=e=>{o.value.charges.push({areaIds:[],startCount:1,startPrice:1,extraCount:1,extraPrice:1})})},{default:l(()=>[a(q,{icon:"ep:plus",class:"mr-5px"}),p(" \u6DFB\u52A0\u533A\u57DF ")]),_:1})]),_:1}),a(c,{label:"\u5305\u90AE\u533A\u57DF",prop:"frees"},{default:l(()=>[a(S,{border:"",style:{width:"100%"},data:r(o).frees},{default:l(()=>[a(d,{align:"center",label:"\u533A\u57DF",width:"360"},{default:l(({row:e})=>[a(I,{modelValue:e.areaIds,"onUpdate:modelValue":u=>e.areaIds=u,options:r(w),props:k,class:"w-1/1",clearable:"",placeholder:"\u8BF7\u9009\u62E9\u5546\u54C1\u5206\u7C7B",filterable:"","collapse-tags":""},null,8,["modelValue","onUpdate:modelValue","options"])]),_:1}),a(d,{align:"center",label:r(h).freeCountTitle,prop:"freeCount"},{default:l(({row:e})=>[a(m,{modelValue:e.freeCount,"onUpdate:modelValue":u=>e.freeCount=u,min:1},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["label"]),a(d,{align:"center",label:"\u5305\u90AE\u91D1\u989D\uFF08\u5143\uFF09",prop:"freePrice"},{default:l(({row:e})=>[a(m,{modelValue:e.freePrice,"onUpdate:modelValue":u=>e.freePrice=u,min:1},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),a(d,{label:"\u64CD\u4F5C",align:"center"},{default:l(e=>[a(V,{link:"",type:"danger",onClick:u=>{return C=e.$index,void o.value.frees.splice(C,1);var C}},{default:l(()=>[p(" \u5220\u9664 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1}),a(c,null,{default:l(()=>[a(V,{type:"primary",plain:"",onClick:t[3]||(t[3]=e=>{o.value.frees.push({areaIds:[],freeCount:1,freePrice:1})})},{default:l(()=>[a(q,{icon:"ep:plus",class:"mr-5px"}),p(" \u6DFB\u52A0\u533A\u57DF ")]),_:1})]),_:1}),a(c,{label:"\u6392\u5E8F",prop:"sort"},{default:l(()=>[a(m,{modelValue:r(o).sort,"onUpdate:modelValue":t[4]||(t[4]=e=>r(o).sort=e),"controls-position":"right",min:0},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])),[[N,r(_)]])]),_:1},8,["title","modelValue"])}}}),[["__file","E:/newCode/GYZX-UI-ADMIN/src/views/mall/trade/delivery/expressTemplate/ExpressTemplateForm.vue"]])});export{Se as __tla,A as default};
