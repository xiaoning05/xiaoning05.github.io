import{d as ue,k as de,r,n as F,o as _,q as b,e as o,b as l,a,h as V,w as re,i as se,c as B,F as O,g as q,j as ie,L as ne,y as ce,E as me,a9 as pe,ab as _e,B as ve,dT as fe,s as ye,x as be,z as Ve,C as he,v as ge,_ as we,__tla as Ue}from"./index-aaa5adb3.js";import{_ as Ie,__tla as ke}from"./Dialog-9a73a39c.js";import{_ as Te,__tla as Se}from"./index-b47c179c.js";import{_ as Ce,__tla as Pe}from"./DictTag-1c1088ae.js";import{g as Ne,c as Re,u as xe,__tla as Ee}from"./index-dbe340e2.js";import{g as ze,a as Le,__tla as Me}from"./index-899b453d.js";import{g as Fe,__tla as Be}from"./index-2eccb211.js";import{D as Y,__tla as Oe}from"./dict-f2796e71.js";import{u as qe,__tla as Ye}from"./useMessage-873da1e2.js";import{__tla as je}from"./index-c602062a.js";import"./color-f5b6e279.js";let j,Ae=Promise.all([(()=>{try{return Ue}catch{}})(),(()=>{try{return ke}catch{}})(),(()=>{try{return Se}catch{}})(),(()=>{try{return Pe}catch{}})(),(()=>{try{return Ee}catch{}})(),(()=>{try{return Me}catch{}})(),(()=>{try{return Be}catch{}})(),(()=>{try{return Oe}catch{}})(),(()=>{try{return Ye}catch{}})(),(()=>{try{return je}catch{}})()]).then(async()=>{j=we(ue({__name:"BusinessForm",emits:["success"],setup(De,{expose:A,emit:D}){const{t:h}=de(),U=qe(),i=r(!1),I=r(""),n=r(!1),k=r(""),u=r({id:void 0,name:void 0,statusTypeId:void 0,statusId:void 0,contactNextTime:void 0,customerId:void 0,dealTime:void 0,price:void 0,discountPercent:void 0,productPrice:void 0,remark:void 0,ownerUserId:void 0,roUserIds:void 0,rwUserIds:void 0,endStatus:void 0,endRemark:void 0,contactLastTime:void 0,followUpStatus:void 0}),G=F({name:[{required:!0,message:"\u5546\u673A\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),f=r(),T=r([]),S=r([]),C=r(!0),P=r(0),N=r([]);A({open:async(d,t)=>{if(i.value=!0,I.value=h("action."+d),k.value=d,Z(),t){n.value=!0;try{u.value=await Ne(t)}finally{n.value=!1}}S.value=await ze()}});const W=D,X=async()=>{if(f&&await f.value.validate()){n.value=!0;try{const d=u.value;k.value==="create"?(await Re(d),U.success(h("common.createSuccess"))):(await xe(d),U.success(h("common.updateSuccess"))),i.value=!1,W("success")}finally{n.value=!1}}},Z=()=>{var d;u.value={id:void 0,name:void 0,statusTypeId:void 0,statusId:void 0,contactNextTime:void 0,customerId:void 0,dealTime:void 0,price:void 0,discountPercent:void 0,productPrice:void 0,remark:void 0,ownerUserId:void 0,roUserIds:void 0,rwUserIds:void 0,endStatus:void 0,endRemark:void 0,contactLastTime:void 0,followUpStatus:void 0},(d=f.value)==null||d.resetFields()},H=async d=>{T.value=await Le(d)},c=F({pageNo:1,pageSize:10,name:null,mobile:null,industryId:null,level:null,source:null,pool:!1}),m=r(!1),J=()=>{m.value=!m.value,c.pageNo=1,R()},R=async()=>{C.value=!0;try{const d=await Fe(c);N.value=d.list,P.value=d.total}finally{C.value=!1}},g=r(),w=r(),K=({},d)=>{w.value=d,g.value.clearSelection(),g.value.toggleRowSelection(d,void 0)},Q=()=>{u.value.customerId=w.value.id,u.value.customerName=w.value.name,m.value=!m.value};return(d,t)=>{const p=ne,s=ce,v=me,x=Ce,$=Te,E=pe,z=_e,y=ve,ee=fe,L=ye,M=be,le=Ve,ae=he,te=Ie,oe=ge;return _(),b(te,{title:a(I),modelValue:a(i),"onUpdate:modelValue":t[13]||(t[13]=e=>ie(i)?i.value=e:null)},{footer:o(()=>[l(y,{onClick:X,type:"primary",disabled:a(n)},{default:o(()=>[V("\u786E \u5B9A")]),_:1},8,["disabled"]),l(y,{onClick:t[12]||(t[12]=e=>i.value=!1)},{default:o(()=>[V("\u53D6 \u6D88")]),_:1})]),default:o(()=>[re((_(),b(ae,{ref_key:"formRef",ref:f,model:a(u),rules:a(G),"label-width":"100px"},{default:o(()=>[l(s,{label:"\u5546\u673A\u540D\u79F0",prop:"name"},{default:o(()=>[l(p,{modelValue:a(u).name,"onUpdate:modelValue":t[0]||(t[0]=e=>a(u).name=e),placeholder:"\u8BF7\u8F93\u5165\u5546\u673A\u540D\u79F0"},null,8,["modelValue"])]),_:1}),l(s,{label:"\u5BA2\u6237\u540D\u79F0",prop:"customerName"},{default:o(()=>[l(ee,{placement:"bottom",width:600,trigger:"click",teleported:!1,visible:a(m),offset:10},{reference:o(()=>[l(p,{placeholder:"\u8BF7\u9009\u62E9\u5BA2\u6237",onClick:J,modelValue:a(u).customerName,"onUpdate:modelValue":t[1]||(t[1]=e=>a(u).customerName=e)},null,8,["modelValue"])]),default:o(()=>[l(a(se),{data:a(N),ref_key:"multipleTableRef",ref:g,onSelect:K},{default:o(()=>[l(v,{width:"55",label:"\u9009\u62E9",type:"selection"}),l(v,{width:"100",label:"\u7F16\u53F7",property:"id"}),l(v,{width:"150",label:"\u5BA2\u6237\u540D\u79F0",property:"name"}),l(v,{width:"100",label:"\u5BA2\u6237\u6765\u6E90",prop:"source",align:"center"},{default:o(e=>[l(x,{type:a(Y).CRM_CUSTOMER_SOURCE,value:e.row.source},null,8,["type","value"])]),_:1}),l(v,{label:"\u5BA2\u6237\u7B49\u7EA7",align:"center",prop:"level",width:"120"},{default:o(e=>[l(x,{type:a(Y).CRM_CUSTOMER_LEVEL,value:e.row.level},null,8,["type","value"])]),_:1})]),_:1},8,["data"]),l(z,{gutter:20},{default:o(()=>[l(E,null,{default:o(()=>[l($,{total:a(P),page:a(c).pageNo,"onUpdate:page":t[2]||(t[2]=e=>a(c).pageNo=e),limit:a(c).pageSize,"onUpdate:limit":t[3]||(t[3]=e=>a(c).pageSize=e),onPagination:R,layout:"sizes, prev, pager, next"},null,8,["total","page","limit"])]),_:1})]),_:1}),l(z,{gutter:20},{default:o(()=>[l(E,{span:10,offset:13},{default:o(()=>[l(y,{onClick:Q},{default:o(()=>[V("\u786E\u8BA4")]),_:1}),l(y,{onClick:t[4]||(t[4]=e=>m.value=!1)},{default:o(()=>[V("\u53D6\u6D88")]),_:1})]),_:1})]),_:1})]),_:1},8,["visible"])]),_:1}),l(s,{label:"\u5546\u673A\u72B6\u6001\u7C7B\u578B",prop:"statusTypeId"},{default:o(()=>[l(M,{modelValue:a(u).statusTypeId,"onUpdate:modelValue":t[5]||(t[5]=e=>a(u).statusTypeId=e),placeholder:"\u8BF7\u9009\u62E9\u5546\u673A\u72B6\u6001\u7C7B\u578B",clearable:"",onChange:H},{default:o(()=>[(_(!0),B(O,null,q(a(S),e=>(_(),b(L,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(s,{label:"\u5546\u673A\u72B6\u6001",prop:"statusId"},{default:o(()=>[l(M,{modelValue:a(u).statusId,"onUpdate:modelValue":t[6]||(t[6]=e=>a(u).statusId=e),placeholder:"\u8BF7\u9009\u62E9\u5546\u673A\u72B6\u6001",clearable:""},{default:o(()=>[(_(!0),B(O,null,q(a(T),e=>(_(),b(L,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(s,{label:"\u9884\u8BA1\u6210\u4EA4\u65E5\u671F",prop:"dealTime"},{default:o(()=>[l(le,{modelValue:a(u).dealTime,"onUpdate:modelValue":t[7]||(t[7]=e=>a(u).dealTime=e),type:"date","value-format":"x",placeholder:"\u9009\u62E9\u9884\u8BA1\u6210\u4EA4\u65E5\u671F"},null,8,["modelValue"])]),_:1}),l(s,{label:"\u5546\u673A\u91D1\u989D",prop:"price"},{default:o(()=>[l(p,{modelValue:a(u).price,"onUpdate:modelValue":t[8]||(t[8]=e=>a(u).price=e),placeholder:"\u8BF7\u8F93\u5165\u5546\u673A\u91D1\u989D"},null,8,["modelValue"])]),_:1}),l(s,{label:"\u6574\u5355\u6298\u6263",prop:"discountPercent"},{default:o(()=>[l(p,{modelValue:a(u).discountPercent,"onUpdate:modelValue":t[9]||(t[9]=e=>a(u).discountPercent=e),placeholder:"\u8BF7\u8F93\u5165\u6574\u5355\u6298\u6263"},null,8,["modelValue"])]),_:1}),l(s,{label:"\u4EA7\u54C1\u603B\u91D1\u989D",prop:"productPrice"},{default:o(()=>[l(p,{modelValue:a(u).productPrice,"onUpdate:modelValue":t[10]||(t[10]=e=>a(u).productPrice=e),placeholder:"\u8BF7\u8F93\u5165\u4EA7\u54C1\u603B\u91D1\u989D"},null,8,["modelValue"])]),_:1}),l(s,{label:"\u5907\u6CE8",prop:"remark"},{default:o(()=>[l(p,{modelValue:a(u).remark,"onUpdate:modelValue":t[11]||(t[11]=e=>a(u).remark=e),placeholder:"\u8BF7\u8F93\u5165\u5907\u6CE8"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])),[[oe,a(n)]])]),_:1},8,["title","modelValue"])}}}),[["__file","E:/newCode/GYZX-UI-ADMIN/src/views/crm/business/BusinessForm.vue"]])});export{Ae as __tla,j as default};
