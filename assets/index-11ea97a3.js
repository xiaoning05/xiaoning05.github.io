import{d as Q,r as i,co as X,a1 as E,e5 as Y,b8 as Z,p as ee,o as m,c as f,f as s,w as r,g as e,a as t,h,t as y,l as g,F as j,q as F,v as ae,ak as le,P as te,C as se,y as re,z as ue,__tla as ne}from"./index-d2088aec.js";import{f as oe,__tla as de}from"./formatTime-c7e0c543.js";import{g as ce,__tla as ie}from"./index-456c5cde.js";import{u as me,__tla as pe}from"./useMessage-c5990e2c.js";import{E as ve,__tla as _e}from"./index-82efac34.js";let W,fe=Promise.all([(()=>{try{return ne}catch{}})(),(()=>{try{return de}catch{}})(),(()=>{try{return ie}catch{}})(),(()=>{try{return pe}catch{}})(),(()=>{try{return _e}catch{}})()]).then(async()=>{let w,b,k,V,U,N,O,S,$,I,J,C;w={class:"flex"},b=e("div",{class:"card-header"},[e("span",null,"\u8FDE\u63A5")],-1),k={class:"flex items-center"},V=e("span",{class:"mr-4 text-lg font-medium"}," \u8FDE\u63A5\u72B6\u6001: ",-1),U=e("hr",{class:"my-4"},null,-1),N={class:"flex"},O=e("p",{class:"mt-4 text-lg font-medium"},"\u6D88\u606F\u8F93\u5165\u6846",-1),S=e("hr",{class:"my-4"},null,-1),$=e("div",{class:"card-header"},[e("span",null,"\u6D88\u606F\u8BB0\u5F55")],-1),I={class:"max-h-80 overflow-auto"},J={class:"flex items-center"},C=e("span",{class:"text-primary mr-2 font-medium"},"\u6536\u5230\u6D88\u606F:",-1),W=Q({name:"InfraWebSocket",__name:"index",setup(he){const x=me(),p=i("http://localhost:48080/infra/ws".replace("http","ws")+"?token="+X()),n=E(()=>D.value==="OPEN"),A=E(()=>n.value?"success":"red"),{status:D,data:o,send:B,close:G,open:H}=Y(p.value,{autoReconnect:!1,heartbeat:!0}),v=i([]);Z(()=>{if(o.value)try{if(o.value==="pong")return;const d=JSON.parse(o.value),l=d.type,u=JSON.parse(d.content);if(!l)return void x.error("\u672A\u77E5\u7684\u6D88\u606F\u7C7B\u578B\uFF1A"+o.value);if(l==="demo-message-receive")return void(u.single?v.value.push({text:`\u3010\u5355\u53D1\u3011\u7528\u6237\u7F16\u53F7(${u.fromUserId})\uFF1A${u.text}`,time:new Date().getTime()}):v.value.push({text:`\u3010\u7FA4\u53D1\u3011\u7528\u6237\u7F16\u53F7(${u.fromUserId})\uFF1A${u.text}`,time:new Date().getTime()}));if(l==="notice-push")return void v.value.push({text:`\u3010\u7CFB\u7EDF\u901A\u77E5\u3011\uFF1A${u.title}`,time:new Date().getTime()});x.error("\u672A\u5904\u7406\u6D88\u606F\uFF1A"+o.value)}catch{x.error("\u5904\u7406\u6D88\u606F\u53D1\u751F\u5F02\u5E38\uFF1A"+o.value)}});const c=i(""),_=i(""),K=()=>{const d=JSON.stringify({text:c.value,toUserId:_.value}),l=JSON.stringify({type:"demo-message-send",content:d});B(l),c.value=""},L=()=>{n.value?G():H()},P=i([]);return ee(async()=>{P.value=await ce()}),(d,l)=>{const u=le,R=te,T=se,q=re,M=ue,z=ve;return m(),f("div",w,[s(z,{gutter:12,class:"w-1/2",shadow:"always"},{header:r(()=>[b]),default:r(()=>[e("div",k,[V,s(u,{color:t(A)},{default:r(()=>[h(y(t(D)),1)]),_:1},8,["color"])]),U,e("div",N,[s(R,{modelValue:t(p),"onUpdate:modelValue":l[0]||(l[0]=a=>g(p)?p.value=a:null),disabled:""},{prepend:r(()=>[h("\u670D\u52A1\u5730\u5740")]),_:1},8,["modelValue"]),s(T,{type:t(n)?"danger":"primary",onClick:L},{default:r(()=>[h(y(t(n)?"\u5173\u95ED\u8FDE\u63A5":"\u5F00\u542F\u8FDE\u63A5"),1)]),_:1},8,["type"])]),O,S,s(R,{modelValue:t(c),"onUpdate:modelValue":l[1]||(l[1]=a=>g(c)?c.value=a:null),autosize:{minRows:2,maxRows:4},disabled:!t(n),clearable:"",type:"textarea",placeholder:"\u8BF7\u8F93\u5165\u4F60\u8981\u53D1\u9001\u7684\u6D88\u606F"},null,8,["modelValue","disabled"]),s(M,{modelValue:t(_),"onUpdate:modelValue":l[2]||(l[2]=a=>g(_)?_.value=a:null),class:"mt-4",placeholder:"\u8BF7\u9009\u62E9\u53D1\u9001\u4EBA"},{default:r(()=>[s(q,{key:"",label:"\u6240\u6709\u4EBA",value:""}),(m(!0),f(j,null,F(t(P),a=>(m(),ae(q,{key:a.id,label:a.nickname,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),s(T,{disabled:!t(n),block:"",class:"ml-2 mt-4",type:"primary",onClick:K},{default:r(()=>[h(" \u53D1\u9001 ")]),_:1},8,["disabled"])]),_:1}),s(z,{gutter:12,class:"w-1/2",shadow:"always"},{header:r(()=>[$]),default:r(()=>[e("div",I,[e("ul",null,[(m(!0),f(j,null,F(t(v).reverse(),a=>(m(),f("li",{key:a.time,class:"mt-2"},[e("div",J,[C,e("span",null,y(t(oe)(a.time)),1)]),e("div",null,y(a.text),1)]))),128))])])]),_:1})])}}})});export{fe as __tla,W as default};
