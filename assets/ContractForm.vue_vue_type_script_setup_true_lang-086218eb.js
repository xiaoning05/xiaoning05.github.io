import{d as X,i as Y,r as m,e as $,aS as E,a1 as ee,o as n,v as c,w as t,f as l,a,h as w,x as le,c as b,F as v,q as y,t as ae,au as te,l as ue,P as de,A as re,j as oe,y as se,z as ne,B as me,bZ as pe,k as ce,D as ie,C as _e,I as fe,__tla as Ve}from"./index-d2088aec.js";import{_ as be,__tla as ve}from"./Dialog.vue_vue_type_style_index_0_lang-4d2024bd.js";import{b as ye,__tla as Ie}from"./index-8fa07f93.js";import{a as he,c as ge,u as Ue,__tla as we}from"./index-2a8c377b.js";import{g as ke,__tla as Pe}from"./index-456c5cde.js";import{g as xe,__tla as Te}from"./index-3b1c9cde.js";import{h as qe,__tla as Ce}from"./index-63130e49.js";import{_ as De,__tla as Fe}from"./ProductList.vue_vue_type_script_setup_true_lang-60623b80.js";import{u as Se,__tla as Ne}from"./useMessage-c5990e2c.js";let F,ze=Promise.all([(()=>{try{return Ve}catch{}})(),(()=>{try{return ve}catch{}})(),(()=>{try{return Ie}catch{}})(),(()=>{try{return we}catch{}})(),(()=>{try{return Pe}catch{}})(),(()=>{try{return Te}catch{}})(),(()=>{try{return Ce}catch{}})(),(()=>{try{return Fe}catch{}})(),(()=>{try{return Ne}catch{}})()]).then(async()=>{F=X({__name:"ContractForm",emits:["success"],setup(Be,{expose:S,emit:N}){const{t:h}=Y(),k=Se(),i=m(!1),P=m(""),_=m(!1),x=m(""),u=m({}),z=$({name:[{required:!0,message:"\u5408\u540C\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],customerId:[{required:!0,message:"\u5BA2\u6237\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],orderDate:[{required:!0,message:"\u4E0B\u5355\u65E5\u671F\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],ownerUserId:[{required:!0,message:"\u8D1F\u8D23\u4EBA\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],no:[{required:!0,message:"\u5408\u540C\u7F16\u53F7\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),I=m();E(()=>u.value.productItems,r=>{r&&r.length!==0?u.value.productPrice=r.reduce((d,p)=>isNaN(d+p.totalPrice)?0:d+p.totalPrice,0):u.value.productPrice=0},{deep:!0}),S({open:async(r,d)=>{if(i.value=!0,P.value=h("action."+r),x.value=r,j(),d){_.value=!0;try{u.value=await he(d)}finally{_.value=!1}}await A()}});const B=N,L=async()=>{if(I&&await I.value.validate()){_.value=!0;try{const r=a(u.value);x.value==="create"?(await ge(r),k.success(h("common.createSuccess"))):(await Ue(r),k.success(h("common.updateSuccess"))),i.value=!1,B("success")}finally{_.value=!1}}},j=()=>{var r;u.value={},(r=I.value)==null||r.resetFields()},A=async()=>{await Promise.all([R(),H(),G(),J()])},T=m([]),R=async()=>{T.value=await ye()},q=m([]),Z=ee(()=>q.value.filter(r=>r.customerId===u.value.customerId)),G=async()=>{q.value=await xe()},g=m([]),H=async()=>{g.value=await ke()},C=m([]),J=async()=>{C.value=await qe()};return(r,d)=>{const p=de,o=re,s=oe,f=se,V=ne,U=me,K=pe,M=ce,O=ie,D=_e,Q=be,W=fe;return n(),c(Q,{modelValue:a(i),"onUpdate:modelValue":d[15]||(d[15]=e=>ue(i)?i.value=e:null),title:a(P),width:"820"},{footer:t(()=>[l(D,{disabled:a(_),type:"primary",onClick:L},{default:t(()=>[w("\u4FDD\u5B58")]),_:1},8,["disabled"]),l(D,{onClick:d[14]||(d[14]=e=>i.value=!1)},{default:t(()=>[w("\u53D6 \u6D88")]),_:1})]),default:t(()=>[le((n(),c(O,{ref_key:"formRef",ref:I,model:a(u),rules:a(z),"label-width":"110px"},{default:t(()=>[l(M,{gutter:20},{default:t(()=>[l(s,{span:12},{default:t(()=>[l(o,{label:"\u5408\u540C\u7F16\u53F7",prop:"no"},{default:t(()=>[l(p,{modelValue:a(u).no,"onUpdate:modelValue":d[0]||(d[0]=e=>a(u).no=e),placeholder:"\u8BF7\u8F93\u5165\u5408\u540C\u7F16\u53F7"},null,8,["modelValue"])]),_:1})]),_:1}),l(s,{span:12},{default:t(()=>[l(o,{label:"\u5408\u540C\u540D\u79F0",prop:"name"},{default:t(()=>[l(p,{modelValue:a(u).name,"onUpdate:modelValue":d[1]||(d[1]=e=>a(u).name=e),placeholder:"\u8BF7\u8F93\u5165\u5408\u540C\u540D\u79F0"},null,8,["modelValue"])]),_:1})]),_:1}),l(s,{span:12},{default:t(()=>[l(o,{label:"\u5BA2\u6237\u540D\u79F0",prop:"customerId"},{default:t(()=>[l(V,{modelValue:a(u).customerId,"onUpdate:modelValue":d[2]||(d[2]=e=>a(u).customerId=e)},{default:t(()=>[(n(!0),b(v,null,y(a(T),e=>(n(),c(f,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(s,{span:12},{default:t(()=>[l(o,{label:"\u5546\u673A\u540D\u79F0",prop:"businessId"},{default:t(()=>[l(V,{modelValue:a(u).businessId,"onUpdate:modelValue":d[3]||(d[3]=e=>a(u).businessId=e)},{default:t(()=>[(n(!0),b(v,null,y(a(C),e=>(n(),c(f,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(s,{span:12},{default:t(()=>[l(o,{label:"\u4E0B\u5355\u65E5\u671F",prop:"orderDate"},{default:t(()=>[l(U,{modelValue:a(u).orderDate,"onUpdate:modelValue":d[4]||(d[4]=e=>a(u).orderDate=e),placeholder:"\u9009\u62E9\u4E0B\u5355\u65E5\u671F",type:"date","value-format":"x"},null,8,["modelValue"])]),_:1})]),_:1}),l(s,{span:12},{default:t(()=>[l(o,{label:"\u5408\u540C\u91D1\u989D",prop:"price"},{default:t(()=>[l(p,{modelValue:a(u).price,"onUpdate:modelValue":d[5]||(d[5]=e=>a(u).price=e),placeholder:"\u8BF7\u8F93\u5165\u5408\u540C\u91D1\u989D"},null,8,["modelValue"])]),_:1})]),_:1}),l(s,{span:12},{default:t(()=>[l(o,{label:"\u5F00\u59CB\u65F6\u95F4",prop:"startTime"},{default:t(()=>[l(U,{modelValue:a(u).startTime,"onUpdate:modelValue":d[6]||(d[6]=e=>a(u).startTime=e),placeholder:"\u9009\u62E9\u5F00\u59CB\u65F6\u95F4",type:"date","value-format":"x"},null,8,["modelValue"])]),_:1})]),_:1}),l(s,{span:12},{default:t(()=>[l(o,{label:"\u7ED3\u675F\u65F6\u95F4",prop:"endTime"},{default:t(()=>[l(U,{modelValue:a(u).endTime,"onUpdate:modelValue":d[7]||(d[7]=e=>a(u).endTime=e),placeholder:"\u9009\u62E9\u7ED3\u675F\u65F6\u95F4",type:"date","value-format":"x"},null,8,["modelValue"])]),_:1})]),_:1}),l(s,{span:12},{default:t(()=>[l(o,{label:"\u516C\u53F8\u7B7E\u7EA6\u4EBA",prop:"signUserId"},{default:t(()=>[l(V,{modelValue:a(u).signUserId,"onUpdate:modelValue":d[8]||(d[8]=e=>a(u).signUserId=e)},{default:t(()=>[(n(!0),b(v,null,y(a(g),e=>(n(),c(f,{key:e.id,label:e.nickname,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(s,{span:12},{default:t(()=>[l(o,{label:"\u5BA2\u6237\u7B7E\u7EA6\u4EBA",prop:"contactId"},{default:t(()=>[l(V,{modelValue:a(u).contactId,"onUpdate:modelValue":d[9]||(d[9]=e=>a(u).contactId=e),disabled:!a(u).customerId},{default:t(()=>[(n(!0),b(v,null,y(a(Z),e=>(n(),c(f,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1})]),_:1}),l(s,{span:12},{default:t(()=>[l(o,{label:"\u8D1F\u8D23\u4EBA",prop:"ownerUserId"},{default:t(()=>[l(V,{modelValue:a(u).ownerUserId,"onUpdate:modelValue":d[10]||(d[10]=e=>a(u).ownerUserId=e)},{default:t(()=>[(n(!0),b(v,null,y(a(g),e=>(n(),c(f,{key:e.id,label:e.nickname,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(s,{span:24},{default:t(()=>[l(o,{label:"\u5907\u6CE8",prop:"remark"},{default:t(()=>[l(p,{modelValue:a(u).remark,"onUpdate:modelValue":d[11]||(d[11]=e=>a(u).remark=e),rows:3,placeholder:"\u8BF7\u8F93\u5165\u5907\u6CE8",type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1}),l(s,{span:24},{default:t(()=>[l(o,{label:"\u4EA7\u54C1\u5217\u8868",prop:"productList"},{default:t(()=>[l(De,{modelValue:a(u).productItems,"onUpdate:modelValue":d[12]||(d[12]=e=>a(u).productItems=e)},null,8,["modelValue"])]),_:1})]),_:1}),l(s,{span:12},{default:t(()=>[l(o,{label:"\u6574\u5355\u6298\u6263(%)",prop:"discountPercent"},{default:t(()=>[l(K,{modelValue:a(u).discountPercent,"onUpdate:modelValue":d[13]||(d[13]=e=>a(u).discountPercent=e),min:0,max:100,precision:0,placeholder:"\u8BF7\u8F93\u5165\u6574\u5355\u6298\u6263",class:"!w-100%"},null,8,["modelValue"])]),_:1})]),_:1}),l(s,{span:12},{default:t(()=>[l(o,{label:"\u4EA7\u54C1\u603B\u91D1\u989D(\u5143)",prop:"productPrice"},{default:t(()=>[w(ae(a(te)(a(u).productPrice)),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])),[[W,a(_)]])]),_:1},8,["modelValue","title"])}}})});export{F as _,ze as __tla};
