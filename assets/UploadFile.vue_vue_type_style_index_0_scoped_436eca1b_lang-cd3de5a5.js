import{d as C,ah as i,r as p,aT as D,o as L,c as P,f as v,cw as E,w as _,a as y,l as G,a_ as z,bm as H,g as f,h as m,t as S,C as J,D as K,__tla as N}from"./index-f0743f71.js";import{u as Q,__tla as W}from"./useUpload-27a6f734.js";import{u as X,__tla as Y}from"./useMessage-75a00a06.js";let U,Z=Promise.all([(()=>{try{return N}catch{}})(),(()=>{try{return W}catch{}})(),(()=>{try{return Y}catch{}})()]).then(async()=>{let h,x,g,b,O;h={class:"upload-file"},x={style:{"font-size":"8px"}},g={style:{color:"#f56c6c"}},b={style:{"font-size":"8px"}},O={style:{color:"#f56c6c"}},U=C({name:"UploadFile",__name:"UploadFile",props:{modelValue:i.oneOfType([String,Array]).isRequired,title:i.string.def("\u6587\u4EF6\u4E0A\u4F20"),fileType:i.array.def(["doc","xls","ppt","txt","pdf"]),fileSize:i.number.def(5),limit:i.number.def(5),autoUpload:i.bool.def(!0),drag:i.bool.def(!1),isShowTip:i.bool.def(!0)},emits:["update:modelValue"],setup(r,{emit:w}){const s=X(),I=w,t=r,V=p(),n=p([]),a=p([]),c=p(0),{uploadUrl:q,httpRequest:$}=Q(),j=e=>{if(a.value.length>=t.limit)return s.error(`\u4E0A\u4F20\u6587\u4EF6\u6570\u91CF\u4E0D\u80FD\u8D85\u8FC7${t.limit}\u4E2A!`),!1;let l="";e.name.lastIndexOf(".")>-1&&(l=e.name.slice(e.name.lastIndexOf(".")+1));const o=t.fileType.some(d=>e.type.indexOf(d)>-1||!!(l&&l.indexOf(d)>-1)),u=e.size<1024*t.fileSize*1024;return o?u?(s.success("\u6B63\u5728\u4E0A\u4F20\u6587\u4EF6\uFF0C\u8BF7\u7A0D\u5019..."),void c.value++):(s.error(`\u4E0A\u4F20\u6587\u4EF6\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC7${t.fileSize}MB!`),!1):(s.error(`\u6587\u4EF6\u683C\u5F0F\u4E0D\u6B63\u786E, \u8BF7\u4E0A\u4F20${t.fileType.join("/")}\u683C\u5F0F!`),!1)},R=e=>{s.success("\u4E0A\u4F20\u6210\u529F");const l=a.value.findIndex(o=>{var u;return((u=o.response)==null?void 0:u.data)===e.data});a.value.splice(l,1),n.value.push({name:e.data,url:e.data}),n.value.length==c.value&&(a.value.push(...n.value),n.value=[],c.value=0,T())},k=()=>{s.error(`\u4E0A\u4F20\u6587\u4EF6\u6570\u91CF\u4E0D\u80FD\u8D85\u8FC7${t.limit}\u4E2A!`)},B=()=>{s.error("\u5BFC\u5165\u6570\u636E\u5931\u8D25\uFF0C\u8BF7\u60A8\u91CD\u65B0\u4E0A\u4F20\uFF01")},F=e=>{const l=a.value.map(o=>o.name).indexOf(e.name);l>-1&&(a.value.splice(l,1),T())},M=e=>{console.log(e)};D(()=>t.modelValue,e=>{e?(a.value=[],z(e)?a.value.push(...e.split(",").map(l=>({name:l.substring(l.lastIndexOf("/")+1),url:l}))):a.value.push(...e.map(l=>({name:l.substring(l.lastIndexOf("/")+1),url:l})))):a.value=[]},{immediate:!0,deep:!0});const T=()=>{let e=a.value.map(l=>l.url);(t.limit===1||z(t.modelValue))&&(e=e.join(",")),I("update:modelValue",e)};return(e,l)=>{const o=J,u=K,d=H;return L(),P("div",h,[v(d,{ref_key:"uploadRef",ref:V,"file-list":y(a),"onUpdate:fileList":l[0]||(l[0]=A=>G(a)?a.value=A:null),action:y(q),"auto-upload":r.autoUpload,"before-upload":j,drag:r.drag,limit:t.limit,multiple:t.limit>1,"on-error":B,"on-exceed":k,"on-preview":M,"on-remove":F,"on-success":R,"show-file-list":!0,"http-request":y($),class:"upload-file-uploader",name:"file"},E({default:_(()=>[v(u,{type:"primary"},{default:_(()=>[v(o,{icon:"ep:upload-filled"}),m(" \u9009\u53D6\u6587\u4EF6 ")]),_:1})]),_:2},[r.isShowTip?{name:"tip",fn:_(()=>[f("div",x,[m(" \u5927\u5C0F\u4E0D\u8D85\u8FC7 "),f("b",g,S(r.fileSize)+"MB",1)]),f("div",b,[m(" \u683C\u5F0F\u4E3A "),f("b",O,S(r.fileType.join("/")),1),m(" \u7684\u6587\u4EF6 ")])]),key:"0"}:void 0]),1032,["file-list","action","auto-upload","drag","limit","multiple","http-request"])])}}})});export{U as _,Z as __tla};
