import{aq as u,d as R,r as h,K as x,p as P,aT as M,o as d,v as j,w as m,f as i,g as v,t as A,c as w,h as U,F as g,a as D,H as E,I as F,_ as G,__tla as H}from"./index-f0743f71.js";import{_ as K,__tla as L}from"./XTextButton-218458ac.js";import{S as C}from"./constants-99751ef9.js";import{g as T,__tla as X}from"./profile-4443740b.js";import{u as Y,__tla as Z}from"./useMessage-75a00a06.js";let k,$=Promise.all([(()=>{try{return H}catch{}})(),(()=>{try{return L}catch{}})(),(()=>{try{return X}catch{}})(),(()=>{try{return Z}catch{}})()]).then(async()=>{let y,_;y=["src"],_={class:"mr-5"},k=G(R({name:"UserSocial",__name:"UserSocial",props:{activeName:{type:String,required:!0}},emits:["update:activeName"],setup(z,{emit:S}){const f=Y(),c=h([]),l=h(),n=x(),I=S,b=()=>{const a=(t="type",new URL(decodeURIComponent(location.href)).searchParams.get(t)??"");var t;const e=n.query.code,s=n.query.state;e&&((o,r,p)=>u.post({url:"/system/social-user/bind",data:{type:o,code:r,state:p}}))(a,e,s).then(()=>{f.success("\u7ED1\u5B9A\u6210\u529F"),I("update:activeName","userSocial")})},q=a=>{const t=location.origin+"/user/profile?"+encodeURIComponent(`type=${a.type}`);((e,s)=>u.get({url:"/system/auth/social-auth-redirect?type="+e+"&redirectUri="+s}))(a.type,encodeURIComponent(t)).then(e=>{window.location.href=e})},N=async a=>{var t,e;await(t=a.type,e=a.openid,u.delete({url:"/system/social-user/unbind",data:{type:t,openid:e}}))&&(a.openid=void 0),f.success("\u89E3\u7ED1\u6210\u529F")};return P(async()=>{await(async()=>{var t;c.value=[];const a=await T();l.value=a;for(const e in C){const s={...C[e]};if(c.value.push(s),(t=l.value)==null?void 0:t.socialUsers){for(const o in l.value.socialUsers)if(s.type===l.value.socialUsers[o].type){s.openid=l.value.socialUsers[o].openid;break}}}})()}),M(()=>n,()=>{b()},{immediate:!0}),(a,t)=>{const e=E,s=K,o=F;return d(),j(o,{data:D(c),"show-header":!1},{default:m(()=>[i(e,{fixed:"left",title:"\u5E8F\u53F7",type:"seq",width:"60"}),i(e,{align:"left",label:"\u793E\u4EA4\u5E73\u53F0",width:"120"},{default:m(({row:r})=>[v("img",{src:r.img,alt:"",class:"h-5 align-middle"},null,8,y),v("p",_,A(r.title),1)]),_:1}),i(e,{align:"center",label:"\u64CD\u4F5C"},{default:m(({row:r})=>[r.openid?(d(),w(g,{key:0},[U(" \u5DF2\u7ED1\u5B9A "),i(s,{class:"mr-5",title:"(\u89E3\u7ED1)",type:"primary",onClick:p=>N(r)},null,8,["onClick"])],64)):(d(),w(g,{key:1},[U(" \u672A\u7ED1\u5B9A "),i(s,{class:"mr-5",title:"(\u7ED1\u5B9A)",type:"primary",onClick:p=>q(r)},null,8,["onClick"])],64))]),_:1})]),_:1},8,["data"])}}}),[["__file","E:/newCode/GYZX-UI-ADMIN/src/views/Profile/components/UserSocial.vue"]])});export{$ as __tla,k as default};
