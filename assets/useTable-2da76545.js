import{_ as I,__tla as J}from"./Table.vue_vue_type_style_index_0_scoped_1ee0f9ba_lang-2efd46fd.js";import{_ as E}from"./_plugin-vue_export-helper-1b428a4d.js";import{_ as G,__tla as H}from"./Form-e9fe9dea.js";import{d as K,ag as u,i as M,r as v,a1 as C,as as Q,a as s,c7 as U,o as g,c as F,f as w,cu as V,q as X,w as h,aJ as z,v as b,h as P,t as k,a4 as y,av as Y,F as Z,_ as aa,C as ta,e as ea,aS as O,ax as j,bm as $,am as sa,__tla as oa}from"./index-d2088aec.js";import{u as na,__tla as ia}from"./useForm-0d24fddf.js";import{d as ra}from"./download-20922b56.js";let q,B,N,ca=Promise.all([(()=>{try{return J}catch{}})(),(()=>{try{return H}catch{}})(),(()=>{try{return oa}catch{}})(),(()=>{try{return ia}catch{}})()]).then(async()=>{let A,c;B=E(I,[["__scopeId","data-v-1ee0f9ba"]]),A={key:0},q=K({name:"Search",__name:"Search",props:{schema:{type:Array,default:()=>[]},isCol:u.bool.def(!1),labelWidth:u.oneOfType([String,Number]).def("auto"),layout:u.string.validate(a=>["inline","bottom"].includes(a)).def("inline"),buttomPosition:u.string.validate(a=>["left","center","right"].includes(a)).def("center"),showSearch:u.bool.def(!0),showReset:u.bool.def(!0),expand:u.bool.def(!1),expandField:u.string.def(""),inline:u.bool.def(!0),model:{type:Object,default:()=>({})}},emits:["search","reset"],setup(a,{emit:e}){const{t:m}=M(),l=a,L=e,r=v(!0),S=C(()=>{let n=Q(l.schema);if(l.expand&&l.expandField&&!s(r)){const _=U(n,i=>i.field===l.expandField);if(_>-1){const i=n.length;n.splice(_+1,i)}}return l.layout==="inline"&&(n=n.concat([{field:"action",formItemProps:{labelWidth:"0px"}}])),n}),{register:p,elFormRef:t,methods:o}=na({model:l.model||{}}),d=async()=>{var n;await((n=s(t))==null?void 0:n.validate(async _=>{if(_){const{getFormData:i}=o,f=await i();L("search",f)}}))},x=async()=>{var i;(i=s(t))==null||i.resetFields();const{getFormData:n}=o,_=await n();L("reset",_)},D=C(()=>({textAlign:l.buttomPosition})),R=()=>{var n;(n=s(t))==null||n.resetFields(),r.value=!s(r)};return(n,_)=>{const i=aa,f=ta,W=G;return g(),F(Z,null,[w(W,{inline:a.inline,"is-col":a.isCol,"is-custom":!1,"label-width":a.labelWidth,schema:s(S),class:"-mb-15px","hide-required-asterisk":"",onRegister:s(p)},V({action:h(()=>[a.layout==="inline"?(g(),F("div",A,[a.showSearch?(g(),b(f,{key:0,onClick:d},{default:h(()=>[w(i,{class:"mr-5px",icon:"ep:search"}),P(" "+k(s(m)("common.query")),1)]),_:1})):y("",!0),a.showReset?(g(),b(f,{key:1,onClick:x},{default:h(()=>[w(i,{class:"mr-5px",icon:"ep:refresh"}),P(" "+k(s(m)("common.reset")),1)]),_:1})):y("",!0),a.expand?(g(),b(f,{key:2,text:"",onClick:R},{default:h(()=>[P(k(s(m)(s(r)?"common.shrink":"common.expand"))+" ",1),w(i,{icon:s(r)?"ep:arrow-up":"ep:arrow-down"},null,8,["icon"])]),_:1})):y("",!0),z(n.$slots,"actionMore")])):y("",!0)]),_:2},[X(Object.keys(n.$slots),T=>({name:T,fn:h(()=>[z(n.$slots,T)])}))]),1032,["inline","is-col","label-width","schema","onRegister"]),a.layout==="bottom"?(g(),F("div",{key:0,style:Y(s(D))},[a.showSearch?(g(),b(f,{key:0,type:"primary",onClick:d},{default:h(()=>[w(i,{class:"mr-5px",icon:"ep:search"}),P(" "+k(s(m)("common.query")),1)]),_:1})):y("",!0),a.showReset?(g(),b(f,{key:1,onClick:x},{default:h(()=>[w(i,{class:"mr-5px",icon:"ep:refresh-right"}),P(" "+k(s(m)("common.reset")),1)]),_:1})):y("",!0),a.expand?(g(),b(f,{key:2,text:"",onClick:R},{default:h(()=>[P(k(s(m)(s(r)?"common.shrink":"common.expand"))+" ",1),w(i,{icon:s(r)?"ep:arrow-up":"ep:arrow-down"},null,8,["icon"])]),_:1})):y("",!0),z(n.$slots,"actionMore")],4)):y("",!0)],64)}}}),{t:c}=M(),N=a=>{const e=ea({pageSize:10,currentPage:1,total:10,tableList:[],params:{...(a==null?void 0:a.defaultParams)||{}},loading:!0,exportLoading:!1,currentRow:null}),m=C(()=>({...e.params,pageSize:e.pageSize,pageNo:e.currentPage}));O(()=>e.currentPage,()=>{p.getList()}),O(()=>e.pageSize,()=>{e.currentPage===1||(e.currentPage=1),p.getList()});const l=v(),L=v(),r=async()=>(await sa(),s(l)),S=async t=>{let o=1;t instanceof Array?(o=t.length,await Promise.all(t.map(async d=>{await((a==null?void 0:a.delListApi)&&(a==null?void 0:a.delListApi(d)))}))):await((a==null?void 0:a.delListApi)&&(a==null?void 0:a.delListApi(t))),j.success(c("common.delSuccess")),e.currentPage=(e.total%e.pageSize===o||e.pageSize===1)&&e.currentPage>1?e.currentPage-1:e.currentPage,await p.getList()},p={getList:async()=>{e.loading=!0;const t=await(a==null?void 0:a.getListApi(s(m)).finally(()=>{e.loading=!1}));t&&(e.tableList=t.list,e.total=t.total??0)},setProps:async(t={})=>{const o=await r();o==null||o.setProps(t)},setColumn:async t=>{const o=await r();o==null||o.setColumn(t)},getSelections:async()=>{const t=await r();return(t==null?void 0:t.selections)||[]},setSearchParams:t=>{e.params=Object.assign(e.params,{pageSize:e.pageSize,pageNo:1,...t}),e.currentPage!==1?e.currentPage=1:p.getList()},delList:async(t,o,d=!0)=>{const x=await r();!o||x!=null&&x.selections.length?d?$.confirm(c("common.delMessage"),c("common.confirmTitle"),{confirmButtonText:c("common.ok"),cancelButtonText:c("common.cancel"),type:"warning"}).then(async()=>{await S(t)}):await S(t):j.warning(c("common.delNoData"))},exportList:async t=>{e.exportLoading=!0,$.confirm(c("common.exportMessage"),c("common.confirmTitle"),{confirmButtonText:c("common.ok"),cancelButtonText:c("common.cancel"),type:"warning"}).then(async()=>{var d;const o=await((d=a==null?void 0:a.exportListApi)==null?void 0:d.call(a,s(m)));o&&ra.excel(o,t)}).finally(()=>{e.exportLoading=!1})}};return a!=null&&a.props&&p.setProps(a.props),{register:(t,o)=>{l.value=t,L.value=o},elTableRef:L,tableObject:e,methods:p,tableMethods:p}}});export{q as _,ca as __tla,B as a,N as u};
