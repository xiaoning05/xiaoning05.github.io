import{d as ue,k as de,r,n as L,o as v,q as V,e as o,b as l,a,h as b,w as re,i as se,c as q,F as B,g as O,j as ie,K as ne,y as ce,E as me,a8 as pe,aa as ve,A as _e,dR as fe,s as ye,x as Ve,z as be,B as ge,v as he,__tla as we}from"./index-34f06ebd.js";import{_ as Ue,__tla as Ie}from"./Dialog.vue_vue_type_style_index_0_lang-08560286.js";import{_ as ke,__tla as Te}from"./index.vue_vue_type_script_setup_true_lang-68fe248c.js";import{_ as Se,__tla as Pe}from"./DictTag.vue_vue_type_script_lang-942df0b2.js";import{g as Re,c as Ce,u as Ne,__tla as xe}from"./index-afd15d48.js";import{g as Ee,a as ze,__tla as Me}from"./index-a1941d5a.js";import{g as Fe,__tla as Le}from"./index-93aed665.js";import{D as j,__tla as qe}from"./dict-e142e39a.js";import{u as Be,__tla as Oe}from"./useMessage-7a5ab7ef.js";let D,je=Promise.all([(()=>{try{return we}catch{}})(),(()=>{try{return Ie}catch{}})(),(()=>{try{return Te}catch{}})(),(()=>{try{return Pe}catch{}})(),(()=>{try{return xe}catch{}})(),(()=>{try{return Me}catch{}})(),(()=>{try{return Le}catch{}})(),(()=>{try{return qe}catch{}})(),(()=>{try{return Oe}catch{}})()]).then(async()=>{D=ue({__name:"BusinessForm",emits:["success"],setup(De,{expose:A,emit:H}){const{t:g}=de(),U=Be(),i=r(!1),I=r(""),n=r(!1),k=r(""),u=r({id:void 0,name:void 0,statusTypeId:void 0,statusId:void 0,contactNextTime:void 0,customerId:void 0,dealTime:void 0,price:void 0,discountPercent:void 0,productPrice:void 0,remark:void 0,ownerUserId:void 0,roUserIds:void 0,rwUserIds:void 0,endStatus:void 0,endRemark:void 0,contactLastTime:void 0,followUpStatus:void 0}),K=L({name:[{required:!0,message:"\u5546\u673A\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),f=r(),T=r([]),S=r([]),P=r(!0),R=r(0),C=r([]);A({open:async(d,t)=>{if(i.value=!0,I.value=g("action."+d),k.value=d,J(),t){n.value=!0;try{u.value=await Re(t)}finally{n.value=!1}}S.value=await Ee()}});const Z=H,G=async()=>{if(f&&await f.value.validate()){n.value=!0;try{const d=u.value;k.value==="create"?(await Ce(d),U.success(g("common.createSuccess"))):(await Ne(d),U.success(g("common.updateSuccess"))),i.value=!1,Z("success")}finally{n.value=!1}}},J=()=>{var d;u.value={id:void 0,name:void 0,statusTypeId:void 0,statusId:void 0,contactNextTime:void 0,customerId:void 0,dealTime:void 0,price:void 0,discountPercent:void 0,productPrice:void 0,remark:void 0,ownerUserId:void 0,roUserIds:void 0,rwUserIds:void 0,endStatus:void 0,endRemark:void 0,contactLastTime:void 0,followUpStatus:void 0},(d=f.value)==null||d.resetFields()},Q=async d=>{T.value=await ze(d)},c=L({pageNo:1,pageSize:10,name:null,mobile:null,industryId:null,level:null,source:null,pool:!1}),m=r(!1),W=()=>{m.value=!m.value,c.pageNo=1,N()},N=async()=>{P.value=!0;try{const d=await Fe(c);C.value=d.list,R.value=d.total}finally{P.value=!1}},h=r(),w=r(),X=({},d)=>{w.value=d,h.value.clearSelection(),h.value.toggleRowSelection(d,void 0)},Y=()=>{u.value.customerId=w.value.id,u.value.customerName=w.value.name,m.value=!m.value};return(d,t)=>{const p=ne,s=ce,_=me,x=Se,$=ke,E=pe,z=ve,y=_e,ee=fe,M=ye,F=Ve,le=be,ae=ge,te=Ue,oe=he;return v(),V(te,{title:a(I),modelValue:a(i),"onUpdate:modelValue":t[13]||(t[13]=e=>ie(i)?i.value=e:null)},{footer:o(()=>[l(y,{onClick:G,type:"primary",disabled:a(n)},{default:o(()=>[b("\u786E \u5B9A")]),_:1},8,["disabled"]),l(y,{onClick:t[12]||(t[12]=e=>i.value=!1)},{default:o(()=>[b("\u53D6 \u6D88")]),_:1})]),default:o(()=>[re((v(),V(ae,{ref_key:"formRef",ref:f,model:a(u),rules:a(K),"label-width":"100px"},{default:o(()=>[l(s,{label:"\u5546\u673A\u540D\u79F0",prop:"name"},{default:o(()=>[l(p,{modelValue:a(u).name,"onUpdate:modelValue":t[0]||(t[0]=e=>a(u).name=e),placeholder:"\u8BF7\u8F93\u5165\u5546\u673A\u540D\u79F0"},null,8,["modelValue"])]),_:1}),l(s,{label:"\u5BA2\u6237\u540D\u79F0",prop:"customerName"},{default:o(()=>[l(ee,{placement:"bottom",width:600,trigger:"click",teleported:!1,visible:a(m),offset:10},{reference:o(()=>[l(p,{placeholder:"\u8BF7\u9009\u62E9\u5BA2\u6237",onClick:W,modelValue:a(u).customerName,"onUpdate:modelValue":t[1]||(t[1]=e=>a(u).customerName=e)},null,8,["modelValue"])]),default:o(()=>[l(a(se),{data:a(C),ref_key:"multipleTableRef",ref:h,onSelect:X},{default:o(()=>[l(_,{width:"55",label:"\u9009\u62E9",type:"selection"}),l(_,{width:"100",label:"\u7F16\u53F7",property:"id"}),l(_,{width:"150",label:"\u5BA2\u6237\u540D\u79F0",property:"name"}),l(_,{width:"100",label:"\u5BA2\u6237\u6765\u6E90",prop:"source",align:"center"},{default:o(e=>[l(x,{type:a(j).CRM_CUSTOMER_SOURCE,value:e.row.source},null,8,["type","value"])]),_:1}),l(_,{label:"\u5BA2\u6237\u7B49\u7EA7",align:"center",prop:"level",width:"120"},{default:o(e=>[l(x,{type:a(j).CRM_CUSTOMER_LEVEL,value:e.row.level},null,8,["type","value"])]),_:1})]),_:1},8,["data"]),l(z,{gutter:20},{default:o(()=>[l(E,null,{default:o(()=>[l($,{total:a(R),page:a(c).pageNo,"onUpdate:page":t[2]||(t[2]=e=>a(c).pageNo=e),limit:a(c).pageSize,"onUpdate:limit":t[3]||(t[3]=e=>a(c).pageSize=e),onPagination:N,layout:"sizes, prev, pager, next"},null,8,["total","page","limit"])]),_:1})]),_:1}),l(z,{gutter:20},{default:o(()=>[l(E,{span:10,offset:13},{default:o(()=>[l(y,{onClick:Y},{default:o(()=>[b("\u786E\u8BA4")]),_:1}),l(y,{onClick:t[4]||(t[4]=e=>m.value=!1)},{default:o(()=>[b("\u53D6\u6D88")]),_:1})]),_:1})]),_:1})]),_:1},8,["visible"])]),_:1}),l(s,{label:"\u5546\u673A\u72B6\u6001\u7C7B\u578B",prop:"statusTypeId"},{default:o(()=>[l(F,{modelValue:a(u).statusTypeId,"onUpdate:modelValue":t[5]||(t[5]=e=>a(u).statusTypeId=e),placeholder:"\u8BF7\u9009\u62E9\u5546\u673A\u72B6\u6001\u7C7B\u578B",clearable:"",onChange:Q},{default:o(()=>[(v(!0),q(B,null,O(a(S),e=>(v(),V(M,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(s,{label:"\u5546\u673A\u72B6\u6001",prop:"statusId"},{default:o(()=>[l(F,{modelValue:a(u).statusId,"onUpdate:modelValue":t[6]||(t[6]=e=>a(u).statusId=e),placeholder:"\u8BF7\u9009\u62E9\u5546\u673A\u72B6\u6001",clearable:""},{default:o(()=>[(v(!0),q(B,null,O(a(T),e=>(v(),V(M,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(s,{label:"\u9884\u8BA1\u6210\u4EA4\u65E5\u671F",prop:"dealTime"},{default:o(()=>[l(le,{modelValue:a(u).dealTime,"onUpdate:modelValue":t[7]||(t[7]=e=>a(u).dealTime=e),type:"date","value-format":"x",placeholder:"\u9009\u62E9\u9884\u8BA1\u6210\u4EA4\u65E5\u671F"},null,8,["modelValue"])]),_:1}),l(s,{label:"\u5546\u673A\u91D1\u989D",prop:"price"},{default:o(()=>[l(p,{modelValue:a(u).price,"onUpdate:modelValue":t[8]||(t[8]=e=>a(u).price=e),placeholder:"\u8BF7\u8F93\u5165\u5546\u673A\u91D1\u989D"},null,8,["modelValue"])]),_:1}),l(s,{label:"\u6574\u5355\u6298\u6263",prop:"discountPercent"},{default:o(()=>[l(p,{modelValue:a(u).discountPercent,"onUpdate:modelValue":t[9]||(t[9]=e=>a(u).discountPercent=e),placeholder:"\u8BF7\u8F93\u5165\u6574\u5355\u6298\u6263"},null,8,["modelValue"])]),_:1}),l(s,{label:"\u4EA7\u54C1\u603B\u91D1\u989D",prop:"productPrice"},{default:o(()=>[l(p,{modelValue:a(u).productPrice,"onUpdate:modelValue":t[10]||(t[10]=e=>a(u).productPrice=e),placeholder:"\u8BF7\u8F93\u5165\u4EA7\u54C1\u603B\u91D1\u989D"},null,8,["modelValue"])]),_:1}),l(s,{label:"\u5907\u6CE8",prop:"remark"},{default:o(()=>[l(p,{modelValue:a(u).remark,"onUpdate:modelValue":t[11]||(t[11]=e=>a(u).remark=e),placeholder:"\u8BF7\u8F93\u5165\u5907\u6CE8"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])),[[oe,a(n)]])]),_:1},8,["title","modelValue"])}}})});export{D as _,je as __tla};
