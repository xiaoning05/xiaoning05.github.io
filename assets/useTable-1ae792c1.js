import{d as ae,ag as c,r as v,p as pe,a,a1 as $,aS as R,x as ue,I as ge,f as g,H as me,aj as J,s as fe,G as W,i as ne,as as he,c8 as ye,o as S,c as X,cu as we,q as xe,w as k,aJ as Y,v as I,h as M,t as q,a4 as z,av as be,F as _e,_ as ve,C as Se,e as Pe,ax as oe,bm as re,am as Ae,__tla as ke}from"./index-d5b00dc9.js";import{g as B,__tla as ze}from"./Form.vue_vue_type_style_index_0_scoped_09f6ff61_lang-b9f82e9e.js";import{E as Le,__tla as Oe}from"./index-9ed43bfb.js";import{_ as Te}from"./_plugin-vue_export-helper-1b428a4d.js";import{_ as Ce,__tla as je}from"./Form-12d0097a.js";import{u as Fe,__tla as $e}from"./useForm-5fd37651.js";import{d as Re}from"./download-20922b56.js";let le,ie,se,Ie=Promise.all([(()=>{try{return ke}catch{}})(),(()=>{try{return ze}catch{}})(),(()=>{try{return Oe}catch{}})(),(()=>{try{return je}catch{}})(),(()=>{try{return $e}catch{}})()]).then(async()=>{let Z,y;ie=Te(ae({name:"Table",props:{pageSize:c.number.def(10),currentPage:c.number.def(1),selection:c.bool.def(!1),showOverflowTooltip:c.bool.def(!0),columns:{type:Array,default:()=>[]},expand:c.bool.def(!1),pagination:{type:Object,default:()=>{}},reserveSelection:c.bool.def(!1),loading:c.bool.def(!1),reserveIndex:c.bool.def(!1),align:c.string.validate(e=>["left","center","right"].includes(e)).def("center"),headerAlign:c.string.validate(e=>["left","center","right"].includes(e)).def("center"),data:{type:Array,default:()=>[]}},emits:["update:pageSize","update:currentPage","register"],setup(e,{attrs:o,slots:p,emit:m,expose:L}){const u=v();pe(()=>{const t=a(u);m("register",t==null?void 0:t.$parent,u)});const x=v(e.pageSize),f=v(e.currentPage),n=v({}),r=v({}),l=$(()=>{const t={...e};return Object.assign(t,a(r)),t}),b=(t,O)=>{var P;const{columns:T}=a(l);for(const C of O||T)for(const j of t)C.field===j.field?fe(C,j.path,j.value):(P=C.children)!=null&&P.length&&b(t,C.children)},D=v([]),U=t=>{D.value=t};L({setProps:(t={})=>{r.value=Object.assign(a(r),t),n.value=t},setColumn:b,selections:D});const i=$(()=>Object.assign({small:!1,background:!0,pagerCount:document.body.clientWidth<992?5:7,layout:"total, sizes, prev, pager, next, jumper",pageSizes:[10,20,30,50,100],disabled:!1,hideOnSinglePage:!1,total:10},a(l).pagination));R(()=>a(l).pageSize,t=>{x.value=t}),R(()=>a(l).currentPage,t=>{f.value=t}),R(()=>x.value,t=>{m("update:pageSize",t)}),R(()=>f.value,t=>{m("update:currentPage",t)});const _=$(()=>{const t={...o,...e};return delete t.columns,delete t.data,t}),d=()=>{const{selection:t,reserveSelection:O,align:T,headerAlign:P}=a(l);return t?g(W,{type:"selection",reserveSelection:O,align:T,headerAlign:P,width:"50"},null):void 0},w=()=>{const{align:t,headerAlign:O,expand:T}=a(l);return T?g(W,{type:"expand",align:t,headerAlign:O},{default:P=>B(p,"expand",P)}):void 0},E=t=>{const{columns:O,reserveIndex:T,pageSize:P,currentPage:C,align:j,headerAlign:ee,showOverflowTooltip:ce}=a(l);return[w(),d()].concat((t||O).map(s=>{if(s.type==="index")return g(W,{type:"index",index:s.index?s.index:N=>((A,G,K,Q)=>{const H=G+1;return A?K*(Q-1)+H:H})(T,N,P,C),align:s.align||j,headerAlign:s.headerAlign||ee,label:s.label,width:"65px"},null);{const N={...s};return N.children&&delete N.children,g(W,J({showOverflowTooltip:ce,align:j,headerAlign:ee},N,{prop:s.field}),{default:A=>{var G;return s.children&&s.children.length?(K=>{const{align:Q,headerAlign:H,showOverflowTooltip:de}=a(l);return K.map(h=>{const V={...h};return V.children&&delete V.children,g(W,J({showOverflowTooltip:de,align:Q,headerAlign:H},V,{prop:h.field}),{default:F=>{var te;return h.children&&h.children.length?E(h.children):B(p,h.field,F)||((te=h==null?void 0:h.formatter)==null?void 0:te.call(h,F.row,F.column,F.row[h.field],F.$index))||F.row[h.field]},header:B(p,`${h.field}-header`)})})})(s.children):B(p,s.field,A)||((G=s==null?void 0:s.formatter)==null?void 0:G.call(s,A.row,A.column,A.row[s.field],A.$index))||A.row[s.field]},header:()=>B(p,`${s.field}-header`)||s.label})}}))};return()=>ue(g("div",null,[g(me,J({ref:u,data:a(l).data,"onSelection-change":U},a(_)),{default:()=>E(),append:()=>B(p,"append")}),a(l).pagination?g(Le,J({pageSize:x.value,"onUpdate:pageSize":t=>x.value=t,currentPage:f.value,"onUpdate:currentPage":t=>f.value=t,class:"float-right mb-15px mt-15px"},a(i)),null):void 0]),[[ge,a(l).loading]])}}),[["__scopeId","data-v-1ee0f9ba"]]),Z={key:0},le=ae({name:"Search",__name:"Search",props:{schema:{type:Array,default:()=>[]},isCol:c.bool.def(!1),labelWidth:c.oneOfType([String,Number]).def("auto"),layout:c.string.validate(e=>["inline","bottom"].includes(e)).def("inline"),buttomPosition:c.string.validate(e=>["left","center","right"].includes(e)).def("center"),showSearch:c.bool.def(!0),showReset:c.bool.def(!0),expand:c.bool.def(!1),expandField:c.string.def(""),inline:c.bool.def(!0),model:{type:Object,default:()=>({})}},emits:["search","reset"],setup(e,{emit:o}){const{t:p}=ne(),m=e,L=o,u=v(!0),x=$(()=>{let i=he(m.schema);if(m.expand&&m.expandField&&!a(u)){const _=ye(i,d=>d.field===m.expandField);if(_>-1){const d=i.length;i.splice(_+1,d)}}return m.layout==="inline"&&(i=i.concat([{field:"action",formItemProps:{labelWidth:"0px"}}])),i}),{register:f,elFormRef:n,methods:r}=Fe({model:m.model||{}}),l=async()=>{var i;await((i=a(n))==null?void 0:i.validate(async _=>{if(_){const{getFormData:d}=r,w=await d();L("search",w)}}))},b=async()=>{var d;(d=a(n))==null||d.resetFields();const{getFormData:i}=r,_=await i();L("reset",_)},D=$(()=>({textAlign:m.buttomPosition})),U=()=>{var i;(i=a(n))==null||i.resetFields(),u.value=!a(u)};return(i,_)=>{const d=ve,w=Se,E=Ce;return S(),X(_e,null,[g(E,{inline:e.inline,"is-col":e.isCol,"is-custom":!1,"label-width":e.labelWidth,schema:a(x),class:"-mb-15px","hide-required-asterisk":"",onRegister:a(f)},we({action:k(()=>[e.layout==="inline"?(S(),X("div",Z,[e.showSearch?(S(),I(w,{key:0,onClick:l},{default:k(()=>[g(d,{class:"mr-5px",icon:"ep:search"}),M(" "+q(a(p)("common.query")),1)]),_:1})):z("",!0),e.showReset?(S(),I(w,{key:1,onClick:b},{default:k(()=>[g(d,{class:"mr-5px",icon:"ep:refresh"}),M(" "+q(a(p)("common.reset")),1)]),_:1})):z("",!0),e.expand?(S(),I(w,{key:2,text:"",onClick:U},{default:k(()=>[M(q(a(p)(a(u)?"common.shrink":"common.expand"))+" ",1),g(d,{icon:a(u)?"ep:arrow-up":"ep:arrow-down"},null,8,["icon"])]),_:1})):z("",!0),Y(i.$slots,"actionMore")])):z("",!0)]),_:2},[xe(Object.keys(i.$slots),t=>({name:t,fn:k(()=>[Y(i.$slots,t)])}))]),1032,["inline","is-col","label-width","schema","onRegister"]),e.layout==="bottom"?(S(),X("div",{key:0,style:be(a(D))},[e.showSearch?(S(),I(w,{key:0,type:"primary",onClick:l},{default:k(()=>[g(d,{class:"mr-5px",icon:"ep:search"}),M(" "+q(a(p)("common.query")),1)]),_:1})):z("",!0),e.showReset?(S(),I(w,{key:1,onClick:b},{default:k(()=>[g(d,{class:"mr-5px",icon:"ep:refresh-right"}),M(" "+q(a(p)("common.reset")),1)]),_:1})):z("",!0),e.expand?(S(),I(w,{key:2,text:"",onClick:U},{default:k(()=>[M(q(a(p)(a(u)?"common.shrink":"common.expand"))+" ",1),g(d,{icon:a(u)?"ep:arrow-up":"ep:arrow-down"},null,8,["icon"])]),_:1})):z("",!0),Y(i.$slots,"actionMore")],4)):z("",!0)],64)}}}),{t:y}=ne(),se=e=>{const o=Pe({pageSize:10,currentPage:1,total:10,tableList:[],params:{...(e==null?void 0:e.defaultParams)||{}},loading:!0,exportLoading:!1,currentRow:null}),p=$(()=>({...o.params,pageSize:o.pageSize,pageNo:o.currentPage}));R(()=>o.currentPage,()=>{f.getList()}),R(()=>o.pageSize,()=>{o.currentPage===1||(o.currentPage=1),f.getList()});const m=v(),L=v(),u=async()=>(await Ae(),a(m)),x=async n=>{let r=1;n instanceof Array?(r=n.length,await Promise.all(n.map(async l=>{await((e==null?void 0:e.delListApi)&&(e==null?void 0:e.delListApi(l)))}))):await((e==null?void 0:e.delListApi)&&(e==null?void 0:e.delListApi(n))),oe.success(y("common.delSuccess")),o.currentPage=(o.total%o.pageSize===r||o.pageSize===1)&&o.currentPage>1?o.currentPage-1:o.currentPage,await f.getList()},f={getList:async()=>{o.loading=!0;const n=await(e==null?void 0:e.getListApi(a(p)).finally(()=>{o.loading=!1}));n&&(o.tableList=n.list,o.total=n.total??0)},setProps:async(n={})=>{const r=await u();r==null||r.setProps(n)},setColumn:async n=>{const r=await u();r==null||r.setColumn(n)},getSelections:async()=>{const n=await u();return(n==null?void 0:n.selections)||[]},setSearchParams:n=>{o.params=Object.assign(o.params,{pageSize:o.pageSize,pageNo:1,...n}),o.currentPage!==1?o.currentPage=1:f.getList()},delList:async(n,r,l=!0)=>{const b=await u();!r||b!=null&&b.selections.length?l?re.confirm(y("common.delMessage"),y("common.confirmTitle"),{confirmButtonText:y("common.ok"),cancelButtonText:y("common.cancel"),type:"warning"}).then(async()=>{await x(n)}):await x(n):oe.warning(y("common.delNoData"))},exportList:async n=>{o.exportLoading=!0,re.confirm(y("common.exportMessage"),y("common.confirmTitle"),{confirmButtonText:y("common.ok"),cancelButtonText:y("common.cancel"),type:"warning"}).then(async()=>{var l;const r=await((l=e==null?void 0:e.exportListApi)==null?void 0:l.call(e,a(p)));r&&Re.excel(r,n)}).finally(()=>{o.exportLoading=!1})}};return e!=null&&e.props&&f.setProps(e.props),{register:(n,r)=>{m.value=n,L.value=r},elTableRef:L,tableObject:o,methods:f,tableMethods:f}}});export{le as _,Ie as __tla,ie as a,se as u};
