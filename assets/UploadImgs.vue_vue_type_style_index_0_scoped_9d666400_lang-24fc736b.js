import{d as G,ah as s,ct as H,r as n,aT as J,o as b,c as U,f,w as $,a as p,l as N,S as Q,g as r,aK as j,v as Y,a5 as A,bo as g,bm as Z,aS as ee,C as ae,W as le,X as te,__tla as se}from"./index-f0743f71.js";import{E as ie,__tla as re}from"./el-image-viewer-d97aa530.js";import{u as ue,__tla as de}from"./useUpload-27a6f734.js";import{u as oe,__tla as ne}from"./useMessage-75a00a06.js";let O,pe=Promise.all([(()=>{try{return se}catch{}})(),(()=>{try{return re}catch{}})(),(()=>{try{return de}catch{}})(),(()=>{try{return ne}catch{}})()]).then(async()=>{let _,x,w,k,C,S,z,T,V;_=l=>(le("data-v-9d666400"),l=l(),te(),l),x={class:"upload-box"},w={class:"upload-empty"},k=["src"],C=["onClick"],S=_(()=>r("span",null,"\u67E5\u770B",-1)),z=["onClick"],T=_(()=>r("span",null,"\u5220\u9664",-1)),V={class:"el-upload__tip"},O=G({name:"UploadImgs",__name:"UploadImgs",props:{modelValue:s.oneOfType([String,Array]).isRequired,drag:s.bool.def(!0),disabled:s.bool.def(!1),limit:s.number.def(5),fileSize:s.number.def(5),fileType:s.array.def(["image/jpeg","image/png","image/gif"]),height:s.string.def("150px"),width:s.string.def("150px"),borderradius:s.string.def("8px")},emits:["update:modelValue"],setup(l,{emit:R}){H(a=>({"9d666400-borderradius":l.borderradius,"9d666400-width":l.width,"9d666400-height":l.height}));const E=oe(),o=l,{uploadUrl:K,httpRequest:L}=ue(),t=n([]),h=n(0),c=n([]),M=a=>{const e=a.size/1024/1024<o.fileSize,i=o.fileType;return i.includes(a.type)||g({title:"\u6E29\u99A8\u63D0\u793A",message:"\u4E0A\u4F20\u56FE\u7247\u4E0D\u7B26\u5408\u6240\u9700\u7684\u683C\u5F0F\uFF01",type:"warning"}),e||g({title:"\u6E29\u99A8\u63D0\u793A",message:`\u4E0A\u4F20\u56FE\u7247\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC7 ${o.fileSize}M\uFF01`,type:"warning"}),h.value++,i.includes(a.type)&&e},q=R,W=a=>{E.success("\u4E0A\u4F20\u6210\u529F");const e=t.value.findIndex(i=>{var m;return((m=i.response)==null?void 0:m.data)===a.data});t.value.splice(e,1),c.value.push({name:a.data,url:a.data}),c.value.length==h.value&&(t.value.push(...c.value),c.value=[],h.value=0,X())};J(()=>o.modelValue,a=>{a?(t.value=[],t.value.push(...a.map(e=>({name:e.substring(e.lastIndexOf("/")+1),url:e})))):t.value=[]},{immediate:!0,deep:!0});const X=()=>{let a=t.value.map(e=>e.url);q("update:modelValue",a)},B=()=>{g({title:"\u6E29\u99A8\u63D0\u793A",message:"\u56FE\u7247\u4E0A\u4F20\u5931\u8D25\uFF0C\u8BF7\u60A8\u91CD\u65B0\u4E0A\u4F20\uFF01",type:"error"})},D=()=>{g({title:"\u6E29\u99A8\u63D0\u793A",message:`\u5F53\u524D\u6700\u591A\u53EA\u80FD\u4E0A\u4F20 ${o.limit} \u5F20\u56FE\u7247\uFF0C\u8BF7\u79FB\u9664\u540E\u4E0A\u4F20\uFF01`,type:"warning"})},I=n(""),y=n(!1);return(a,e)=>{const i=ae,m=Z,F=ie;return b(),U("div",x,[f(m,{"file-list":p(t),"onUpdate:fileList":e[1]||(e[1]=u=>N(t)?t.value=u:null),accept:l.fileType.join(","),action:p(K),"before-upload":M,class:Q(["upload",l.drag?"no-border":""]),drag:l.drag,limit:l.limit,multiple:!0,"on-error":B,"on-exceed":D,"on-success":W,"http-request":p(L),"list-type":"picture-card"},{file:$(({file:u})=>[r("img",{src:u.url,class:"upload-image"},null,8,k),r("div",{class:"upload-handle",onClick:e[0]||(e[0]=ee(()=>{},["stop"]))},[r("div",{class:"handle-icon",onClick:P=>{return d=u,I.value=d.url,void(y.value=!0);var d}},[f(i,{icon:"ep:zoom-in"}),S],8,C),l.disabled?A("",!0):(b(),U("div",{key:0,class:"handle-icon",onClick:P=>{return d=u,t.value=t.value.filter(v=>v.url!==d.url||v.name!==d.name),void q("update:modelValue",t.value.map(v=>v.url));var d}},[f(i,{icon:"ep:delete"}),T],8,z))])]),default:$(()=>[r("div",w,[j(a.$slots,"empty",{},()=>[f(i,{icon:"ep:plus"})],!0)])]),_:3},8,["file-list","accept","action","class","drag","limit","http-request"]),r("div",V,[j(a.$slots,"tip",{},void 0,!0)]),p(y)?(b(),Y(F,{key:0,"url-list":[p(I)],onClose:e[2]||(e[2]=u=>y.value=!1)},null,8,["url-list"])):A("",!0)])}}})});export{O as _,pe as __tla};
