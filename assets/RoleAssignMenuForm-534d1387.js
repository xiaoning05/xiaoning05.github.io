import{d as j,i as J,r as d,e as X,o as k,v as V,w as l,f as t,a as u,h as m,x as Y,t as w,l as h,al as Z,A as P,a0 as $,dV as q,G as z,D as B,J as L,_ as O,__tla as Q}from"./index-f0743f71.js";import{_ as T,__tla as W}from"./Dialog-8f786edd.js";import{d as ee,h as ae}from"./tree-02f455f9.js";import{g as le,__tla as te}from"./index-fc19a86d.js";import{g as se,a as ue,__tla as oe}from"./index-4c66278d.js";import{u as de,__tla as ne}from"./useMessage-75a00a06.js";import{E as re,__tla as ce}from"./index-a48a5540.js";let C,ie=Promise.all([(()=>{try{return Q}catch{}})(),(()=>{try{return W}catch{}})(),(()=>{try{return te}catch{}})(),(()=>{try{return oe}catch{}})(),(()=>{try{return ne}catch{}})(),(()=>{try{return ce}catch{}})()]).then(async()=>{C=O(j({name:"SystemRoleAssignMenuForm",__name:"RoleAssignMenuForm",emits:["success"],setup(me,{expose:I,emit:b}){const{t:M}=J(),A=de(),n=d(!1),r=d(!1),s=X({id:0,name:"",code:"",menuIds:[]}),f=d(),p=d([]),c=d(!1),o=d(),_=d(!1);I({open:async a=>{n.value=!0,U(),p.value=ae(await le()),s.id=a.id,s.name=a.name,s.code=a.code,r.value=!0;try{s.value.menuIds=await se(a.id),s.value.menuIds.forEach(e=>{o.value.setChecked(e,!0,!1)})}finally{r.value=!1}}});const R=b,F=async()=>{if(f&&await f.value.validate()){r.value=!0;try{const a={roleId:s.id,menuIds:[...o.value.getCheckedKeys(!1),...o.value.getHalfCheckedKeys()]};await ue(a),A.success(M("common.updateSuccess")),n.value=!1,R("success")}finally{r.value=!1}}},U=()=>{var a,e;_.value=!1,c.value=!1,s.value={id:0,name:"",code:"",menuIds:[]},(a=o.value)==null||a.setCheckedNodes([]),(e=f.value)==null||e.resetFields()},E=()=>{o.value.setCheckedNodes(_.value?p.value:[])},N=()=>{var e;const a=(e=o.value)==null?void 0:e.store.nodesMap;for(let v in a)a[v].expanded!==c.value&&(a[v].expanded=c.value)};return(a,e)=>{const v=Z,y=P,x=$,D=q,G=re,H=z,g=B,K=T,S=L;return k(),V(K,{modelValue:u(n),"onUpdate:modelValue":e[3]||(e[3]=i=>h(n)?n.value=i:null),title:"\u83DC\u5355\u6743\u9650"},{footer:l(()=>[t(g,{disabled:u(r),type:"primary",onClick:F},{default:l(()=>[m("\u786E \u5B9A")]),_:1},8,["disabled"]),t(g,{onClick:e[2]||(e[2]=i=>n.value=!1)},{default:l(()=>[m("\u53D6 \u6D88")]),_:1})]),default:l(()=>[Y((k(),V(H,{ref_key:"formRef",ref:f,model:u(s),"label-width":"80px"},{default:l(()=>[t(y,{label:"\u89D2\u8272\u540D\u79F0"},{default:l(()=>[t(v,null,{default:l(()=>[m(w(u(s).name),1)]),_:1})]),_:1}),t(y,{label:"\u89D2\u8272\u6807\u8BC6"},{default:l(()=>[t(v,null,{default:l(()=>[m(w(u(s).code),1)]),_:1})]),_:1}),t(y,{label:"\u83DC\u5355\u6743\u9650"},{default:l(()=>[t(G,{class:"cardHeight"},{header:l(()=>[m(" \u5168\u9009/\u5168\u4E0D\u9009: "),t(x,{modelValue:u(_),"onUpdate:modelValue":e[0]||(e[0]=i=>h(_)?_.value=i:null),"active-text":"\u662F","inactive-text":"\u5426","inline-prompt":"",onChange:E},null,8,["modelValue"]),m(" \u5168\u90E8\u5C55\u5F00/\u6298\u53E0: "),t(x,{modelValue:u(c),"onUpdate:modelValue":e[1]||(e[1]=i=>h(c)?c.value=i:null),"active-text":"\u5C55\u5F00","inactive-text":"\u6298\u53E0","inline-prompt":"",onChange:N},null,8,["modelValue"])]),default:l(()=>[t(D,{ref_key:"treeRef",ref:o,data:u(p),props:u(ee),"empty-text":"\u52A0\u8F7D\u4E2D\uFF0C\u8BF7\u7A0D\u5019","node-key":"id","show-checkbox":""},null,8,["data","props"])]),_:1})]),_:1})]),_:1},8,["model"])),[[S,u(r)]])]),_:1},8,["modelValue"])}}}),[["__scopeId","data-v-4316139b"],["__file","E:/newCode/GYZX-UI-ADMIN/src/views/system/role/RoleAssignMenuForm.vue"]])});export{ie as __tla,C as default};
