import{d as j,r as p,u as A,W as B,X as C,a as t,n as H,aQ as W,p as Z,w as D,Z as J,o as Y,q as $,e as r,b as a,G as aa,h as v,t as V,k as ea,a2 as k,a0 as ta,a4 as ra,a5 as la,a6 as oa,a7 as na,y as sa,a8 as ia,K as pa,a9 as ma,aa as da,B as ca,P as ua,Q as _a,f as fa,ab as ga,ac as ha,__tla as ya}from"./index-34f06ebd.js";import{_ as wa,__tla as xa}from"./Verify-cf8eab2c.js";import{_ as ba,__tla as Fa}from"./XButton-764a1d39.js";import{E as va,__tla as Va}from"./el-link-6a9ddb0c.js";import{u as _,__tla as ka}from"./useIcon-b9cfbf1e.js";import{u as Na,L as La,a as Pa,__tla as Ma}from"./useLogin-53ef9fe7.js";import{u as Sa,__tla as Ta}from"./useMessage-7a5ab7ef.js";import{r as f,__tla as za}from"./formRules-ecd4de8b.js";import{_ as Ea}from"./_plugin-vue_export-helper-1b428a4d.js";import{__tla as Ia}from"./index-176464f7.js";let N,Ua=Promise.all([(()=>{try{return ya}catch{}})(),(()=>{try{return xa}catch{}})(),(()=>{try{return Fa}catch{}})(),(()=>{try{return Va}catch{}})(),(()=>{try{return ka}catch{}})(),(()=>{try{return Ma}catch{}})(),(()=>{try{return Ta}catch{}})(),(()=>{try{return za}catch{}})(),(()=>{try{return Ia}catch{}})()]).then(async()=>{let g;g=(c=>(ua("data-v-e5788c3a"),c=c(),_a(),c))(()=>fa("div",{style:{color:"#747579"}}," \u7528\u6237\u767B\u5F55 ",-1)),N=Ea(j({name:"LoginForm",__name:"LoginForm",setup(c){const{t:m}=ea();Sa(),_({icon:"ep:house"});const L=_({icon:"ep:avatar"}),P=_({icon:"ep:lock"}),h=p(),{validForm:M}=Pa(h),{setLoginState:qa,getLoginState:S}=Na(),{currentRoute:T,push:y}=A(),z=B(),d=p(""),u=p(!1),E=p(),I=p("blockPuzzle"),U=C(()=>t(S)===La.LOGIN),q={tenantName:[f],username:[f],password:[f]},e=H({isShowPassword:!1,captchaEnable:"true",tenantEnable:"true",loginForm:{tenantName:"cmcc",username:"admin",password:"Aa123456",captchaVerification:"",rememberMe:!1}}),w=async()=>{k({accessToken:"a5e0d44b86d045c189882518a40b479e",expiresTime:1708635958255,refreshToken:"e079913cb8bb455383ebe97c977b5c83",userId:1}),y("/index")},x=p(),G=async o=>{u.value=!0;try{if(await(async()=>{if(e.tenantEnable==="true"){const n=await ga(e.loginForm.tenantName);ha(n)}})(),!await M())return;e.loginForm.captchaVerification=o.captchaVerification;const l=await ra(e.loginForm);if(!l)return;x.value=la.service({lock:!0,text:"\u6B63\u5728\u52A0\u8F7D\u7CFB\u7EDF\u4E2D...",background:"rgba(0, 0, 0, 0.7)"}),e.loginForm.rememberMe?oa(e.loginForm):na(),k(l),d.value||(d.value="/"),d.value.indexOf("sso")!==-1?window.location.href=window.location.href.replace("/login?redirect=",""):y({path:d.value||z.addRouters[0].path})}finally{u.value=!1,x.value.close()}};return W(()=>T.value,o=>{var l;d.value=(l=o==null?void 0:o.query)==null?void 0:l.redirect},{immediate:!0}),Z(()=>{(()=>{const o=ta();o&&(e.loginForm={...e.loginForm,username:o.username?o.username:e.loginForm.username,password:o.password?o.password:e.loginForm.password,rememberMe:!!o.rememberMe,tenantName:o.tenantName?o.tenantName:e.loginForm.tenantName})})()}),(o,l)=>{const n=sa,s=ia,b=pa,K=ma,O=va,F=da,Q=ba,R=wa,X=ca;return D((Y(),$(X,{ref_key:"formLogin",ref:h,model:t(e).loginForm,rules:q,class:"login-form","label-position":"top","label-width":"120px",size:"large"},{default:r(()=>[a(F,{style:{"margin-right":"-10px","margin-left":"-10px"}},{default:r(()=>[a(s,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:r(()=>[a(n,null,{default:r(()=>[g]),_:1})]),_:1}),a(s,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:r(()=>[a(n,{prop:"username"},{default:r(()=>[a(b,{modelValue:t(e).loginForm.username,"onUpdate:modelValue":l[0]||(l[0]=i=>t(e).loginForm.username=i),placeholder:t(m)("login.usernamePlaceholder"),"prefix-icon":t(L)},null,8,["modelValue","placeholder","prefix-icon"])]),_:1})]),_:1}),a(s,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:r(()=>[a(n,{prop:"password"},{default:r(()=>[a(b,{modelValue:t(e).loginForm.password,"onUpdate:modelValue":l[1]||(l[1]=i=>t(e).loginForm.password=i),placeholder:t(m)("login.passwordPlaceholder"),"prefix-icon":t(P),"show-password":"",type:"password",onKeyup:l[2]||(l[2]=aa(i=>w(),["enter"]))},null,8,["modelValue","placeholder","prefix-icon"])]),_:1})]),_:1}),a(s,{span:24,style:{"padding-right":"10px","padding-left":"10px","margin-top":"-20px","margin-bottom":"-20px"}},{default:r(()=>[a(n,null,{default:r(()=>[a(F,{justify:"space-between",style:{width:"100%"}},{default:r(()=>[a(s,{span:6},{default:r(()=>[a(K,{modelValue:t(e).loginForm.rememberMe,"onUpdate:modelValue":l[3]||(l[3]=i=>t(e).loginForm.rememberMe=i)},{default:r(()=>[v(V(t(m)("login.remember")),1)]),_:1},8,["modelValue"])]),_:1}),a(s,{offset:6,span:12},{default:r(()=>[a(O,{style:{float:"right"},type:"primary"},{default:r(()=>[v(V(t(m)("login.forgetPassword")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(s,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:r(()=>[a(n,null,{default:r(()=>[a(Q,{loading:t(u),title:t(m)("login.login"),class:"w-[100%]",type:"primary",onClick:l[4]||(l[4]=i=>w())},null,8,["loading","title"])]),_:1})]),_:1}),a(R,{ref_key:"verify",ref:E,captchaType:t(I),imgSize:{width:"400px",height:"200px"},mode:"pop",onSuccess:G},null,8,["captchaType"])]),_:1})]),_:1},8,["model"])),[[J,t(U)]])}}}),[["__scopeId","data-v-e5788c3a"]])});export{Ua as __tla,N as default};
