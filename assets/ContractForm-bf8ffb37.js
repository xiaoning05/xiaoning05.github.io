import{d as O,k as Q,r as m,n as W,aR as $,Y as ee,o as n,q as c,e as t,b as a,a as l,h as w,w as ae,c as b,F as v,g as y,t as le,at as te,j as re,L as ue,y as de,a9 as oe,s as se,x as ne,z as me,bX as _e,ab as ce,C as pe,B as ie,v as fe,_ as Ve,__tla as be}from"./index-b079f499.js";import{_ as ve,__tla as ye}from"./Dialog-07bcd661.js";import{b as he,__tla as Ie}from"./index-d9e52664.js";import{a as ge,c as Ue,u as we,__tla as ke}from"./index-58c76737.js";import{g as Pe,__tla as xe}from"./index-41e17afa.js";import{g as Ce,__tla as qe}from"./index-0332faa5.js";import{h as De,__tla as Te}from"./index-d63be095.js";import Fe,{__tla as Ne}from"./ProductList-ebc92bf6.js";import{u as Le,__tla as Re}from"./useMessage-66b9cf03.js";import{__tla as Ye}from"./DictTag-6d4c3489.js";import"./color-f5b6e279.js";import{__tla as Me}from"./dict-2c56908b.js";import{__tla as Se}from"./index-a8f905db.js";import{__tla as Xe}from"./formatter-8ff0c24b.js";import{__tla as je}from"./Table.vue_vue_type_style_index_0_scoped_b4105caf_lang-16b2ef26.js";import{__tla as ze}from"./tsxHelper-b83ae8eb.js";import{__tla as Ae}from"./index-c1a7e444.js";import{__tla as Be}from"./index-749396de.js";let F,Ee=Promise.all([(()=>{try{return be}catch{}})(),(()=>{try{return ye}catch{}})(),(()=>{try{return Ie}catch{}})(),(()=>{try{return ke}catch{}})(),(()=>{try{return xe}catch{}})(),(()=>{try{return qe}catch{}})(),(()=>{try{return Te}catch{}})(),(()=>{try{return Ne}catch{}})(),(()=>{try{return Re}catch{}})(),(()=>{try{return Ye}catch{}})(),(()=>{try{return Me}catch{}})(),(()=>{try{return Se}catch{}})(),(()=>{try{return Xe}catch{}})(),(()=>{try{return je}catch{}})(),(()=>{try{return ze}catch{}})(),(()=>{try{return Ae}catch{}})(),(()=>{try{return Be}catch{}})()]).then(async()=>{F=Ve(O({__name:"ContractForm",emits:["success"],setup(Ge,{expose:N,emit:L}){const{t:I}=Q(),k=Le(),p=m(!1),P=m(""),i=m(!1),x=m(""),r=m({}),R=W({name:[{required:!0,message:"\u5408\u540C\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],customerId:[{required:!0,message:"\u5BA2\u6237\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],orderDate:[{required:!0,message:"\u4E0B\u5355\u65E5\u671F\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],ownerUserId:[{required:!0,message:"\u8D1F\u8D23\u4EBA\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],no:[{required:!0,message:"\u5408\u540C\u7F16\u53F7\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),h=m();$(()=>r.value.productItems,d=>{d&&d.length!==0?r.value.productPrice=d.reduce((u,_)=>isNaN(u+_.totalPrice)?0:u+_.totalPrice,0):r.value.productPrice=0},{deep:!0}),N({open:async(d,u)=>{if(p.value=!0,P.value=I("action."+d),x.value=d,S(),u){i.value=!0;try{r.value=await ge(u)}finally{i.value=!1}}await X()}});const Y=L,M=async()=>{if(h&&await h.value.validate()){i.value=!0;try{const d=l(r.value);x.value==="create"?(await Ue(d),k.success(I("common.createSuccess"))):(await we(d),k.success(I("common.updateSuccess"))),p.value=!1,Y("success")}finally{i.value=!1}}},S=()=>{var d;r.value={},(d=h.value)==null||d.resetFields()},X=async()=>{await Promise.all([j(),B(),A(),E()])},C=m([]),j=async()=>{C.value=await he()},q=m([]),z=ee(()=>q.value.filter(d=>d.customerId===r.value.customerId)),A=async()=>{q.value=await Ce()},g=m([]),B=async()=>{g.value=await Pe()},D=m([]),E=async()=>{D.value=await De()};return(d,u)=>{const _=ue,o=de,s=oe,f=se,V=ne,U=me,G=_e,Z=ce,H=pe,T=ie,J=ve,K=fe;return n(),c(J,{modelValue:l(p),"onUpdate:modelValue":u[15]||(u[15]=e=>re(p)?p.value=e:null),title:l(P),width:"820"},{footer:t(()=>[a(T,{disabled:l(i),type:"primary",onClick:M},{default:t(()=>[w("\u4FDD\u5B58")]),_:1},8,["disabled"]),a(T,{onClick:u[14]||(u[14]=e=>p.value=!1)},{default:t(()=>[w("\u53D6 \u6D88")]),_:1})]),default:t(()=>[ae((n(),c(H,{ref_key:"formRef",ref:h,model:l(r),rules:l(R),"label-width":"110px"},{default:t(()=>[a(Z,{gutter:20},{default:t(()=>[a(s,{span:12},{default:t(()=>[a(o,{label:"\u5408\u540C\u7F16\u53F7",prop:"no"},{default:t(()=>[a(_,{modelValue:l(r).no,"onUpdate:modelValue":u[0]||(u[0]=e=>l(r).no=e),placeholder:"\u8BF7\u8F93\u5165\u5408\u540C\u7F16\u53F7"},null,8,["modelValue"])]),_:1})]),_:1}),a(s,{span:12},{default:t(()=>[a(o,{label:"\u5408\u540C\u540D\u79F0",prop:"name"},{default:t(()=>[a(_,{modelValue:l(r).name,"onUpdate:modelValue":u[1]||(u[1]=e=>l(r).name=e),placeholder:"\u8BF7\u8F93\u5165\u5408\u540C\u540D\u79F0"},null,8,["modelValue"])]),_:1})]),_:1}),a(s,{span:12},{default:t(()=>[a(o,{label:"\u5BA2\u6237\u540D\u79F0",prop:"customerId"},{default:t(()=>[a(V,{modelValue:l(r).customerId,"onUpdate:modelValue":u[2]||(u[2]=e=>l(r).customerId=e)},{default:t(()=>[(n(!0),b(v,null,y(l(C),e=>(n(),c(f,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),a(s,{span:12},{default:t(()=>[a(o,{label:"\u5546\u673A\u540D\u79F0",prop:"businessId"},{default:t(()=>[a(V,{modelValue:l(r).businessId,"onUpdate:modelValue":u[3]||(u[3]=e=>l(r).businessId=e)},{default:t(()=>[(n(!0),b(v,null,y(l(D),e=>(n(),c(f,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),a(s,{span:12},{default:t(()=>[a(o,{label:"\u4E0B\u5355\u65E5\u671F",prop:"orderDate"},{default:t(()=>[a(U,{modelValue:l(r).orderDate,"onUpdate:modelValue":u[4]||(u[4]=e=>l(r).orderDate=e),placeholder:"\u9009\u62E9\u4E0B\u5355\u65E5\u671F",type:"date","value-format":"x"},null,8,["modelValue"])]),_:1})]),_:1}),a(s,{span:12},{default:t(()=>[a(o,{label:"\u5408\u540C\u91D1\u989D",prop:"price"},{default:t(()=>[a(_,{modelValue:l(r).price,"onUpdate:modelValue":u[5]||(u[5]=e=>l(r).price=e),placeholder:"\u8BF7\u8F93\u5165\u5408\u540C\u91D1\u989D"},null,8,["modelValue"])]),_:1})]),_:1}),a(s,{span:12},{default:t(()=>[a(o,{label:"\u5F00\u59CB\u65F6\u95F4",prop:"startTime"},{default:t(()=>[a(U,{modelValue:l(r).startTime,"onUpdate:modelValue":u[6]||(u[6]=e=>l(r).startTime=e),placeholder:"\u9009\u62E9\u5F00\u59CB\u65F6\u95F4",type:"date","value-format":"x"},null,8,["modelValue"])]),_:1})]),_:1}),a(s,{span:12},{default:t(()=>[a(o,{label:"\u7ED3\u675F\u65F6\u95F4",prop:"endTime"},{default:t(()=>[a(U,{modelValue:l(r).endTime,"onUpdate:modelValue":u[7]||(u[7]=e=>l(r).endTime=e),placeholder:"\u9009\u62E9\u7ED3\u675F\u65F6\u95F4",type:"date","value-format":"x"},null,8,["modelValue"])]),_:1})]),_:1}),a(s,{span:12},{default:t(()=>[a(o,{label:"\u516C\u53F8\u7B7E\u7EA6\u4EBA",prop:"signUserId"},{default:t(()=>[a(V,{modelValue:l(r).signUserId,"onUpdate:modelValue":u[8]||(u[8]=e=>l(r).signUserId=e)},{default:t(()=>[(n(!0),b(v,null,y(l(g),e=>(n(),c(f,{key:e.id,label:e.nickname,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),a(s,{span:12},{default:t(()=>[a(o,{label:"\u5BA2\u6237\u7B7E\u7EA6\u4EBA",prop:"contactId"},{default:t(()=>[a(V,{modelValue:l(r).contactId,"onUpdate:modelValue":u[9]||(u[9]=e=>l(r).contactId=e),disabled:!l(r).customerId},{default:t(()=>[(n(!0),b(v,null,y(l(z),e=>(n(),c(f,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1})]),_:1}),a(s,{span:12},{default:t(()=>[a(o,{label:"\u8D1F\u8D23\u4EBA",prop:"ownerUserId"},{default:t(()=>[a(V,{modelValue:l(r).ownerUserId,"onUpdate:modelValue":u[10]||(u[10]=e=>l(r).ownerUserId=e)},{default:t(()=>[(n(!0),b(v,null,y(l(g),e=>(n(),c(f,{key:e.id,label:e.nickname,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),a(s,{span:24},{default:t(()=>[a(o,{label:"\u5907\u6CE8",prop:"remark"},{default:t(()=>[a(_,{modelValue:l(r).remark,"onUpdate:modelValue":u[11]||(u[11]=e=>l(r).remark=e),rows:3,placeholder:"\u8BF7\u8F93\u5165\u5907\u6CE8",type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1}),a(s,{span:24},{default:t(()=>[a(o,{label:"\u4EA7\u54C1\u5217\u8868",prop:"productList"},{default:t(()=>[a(Fe,{modelValue:l(r).productItems,"onUpdate:modelValue":u[12]||(u[12]=e=>l(r).productItems=e)},null,8,["modelValue"])]),_:1})]),_:1}),a(s,{span:12},{default:t(()=>[a(o,{label:"\u6574\u5355\u6298\u6263(%)",prop:"discountPercent"},{default:t(()=>[a(G,{modelValue:l(r).discountPercent,"onUpdate:modelValue":u[13]||(u[13]=e=>l(r).discountPercent=e),min:0,max:100,precision:0,placeholder:"\u8BF7\u8F93\u5165\u6574\u5355\u6298\u6263",class:"!w-100%"},null,8,["modelValue"])]),_:1})]),_:1}),a(s,{span:12},{default:t(()=>[a(o,{label:"\u4EA7\u54C1\u603B\u91D1\u989D(\u5143)",prop:"productPrice"},{default:t(()=>[w(le(l(te)(l(r).productPrice)),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])),[[K,l(i)]])]),_:1},8,["modelValue","title"])}}}),[["__file","E:/newCode/GYZX-UI-ADMIN/src/views/crm/contract/ContractForm.vue"]])});export{Ee as __tla,F as default};
