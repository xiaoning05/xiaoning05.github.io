import{d as D,r as p,u as G,a0 as W,a1 as X,a as t,e as B,aS as H,p as J,x as Q,a3 as Y,o as Z,v as $,w as r,f as a,L as aa,h as v,t as V,i as ea,a7 as k,a5 as ta,a9 as ra,aa as la,ab as oa,ac as na,A as sa,j as ia,P as pa,ad as ma,k as da,D as ca,V as ua,W as _a,g as fa,ae as ga,af as ha,__tla as ya}from"./index-d2088aec.js";import{_ as wa,__tla as xa}from"./Verify-81dedee1.js";import{_ as ba,__tla as Fa}from"./XButton-832d2f9f.js";import{E as va,__tla as Va}from"./el-link-3f427b16.js";import{u as _,__tla as ka}from"./useIcon-86292988.js";import{u as La,L as Na,a as Pa,__tla as Sa}from"./useLogin-909228df.js";import{u as Ma,__tla as Ta}from"./useMessage-c5990e2c.js";import{r as f,__tla as Ea}from"./formRules-fb12266a.js";import{_ as za}from"./_plugin-vue_export-helper-1b428a4d.js";import{__tla as Ia}from"./index-a70e1e2c.js";let L,Ua=Promise.all([(()=>{try{return ya}catch{}})(),(()=>{try{return xa}catch{}})(),(()=>{try{return Fa}catch{}})(),(()=>{try{return Va}catch{}})(),(()=>{try{return ka}catch{}})(),(()=>{try{return Sa}catch{}})(),(()=>{try{return Ta}catch{}})(),(()=>{try{return Ea}catch{}})(),(()=>{try{return Ia}catch{}})()]).then(async()=>{let g;g=(c=>(ua("data-v-e5788c3a"),c=c(),_a(),c))(()=>fa("div",{style:{color:"#747579"}}," \u7528\u6237\u767B\u5F55 ",-1)),L=za(D({name:"LoginForm",__name:"LoginForm",setup(c){const{t:m}=ea();Ma(),_({icon:"ep:house"});const N=_({icon:"ep:avatar"}),P=_({icon:"ep:lock"}),h=p(),{validForm:S}=Pa(h),{setLoginState:ja,getLoginState:M}=La(),{currentRoute:T,push:y}=G(),E=W(),d=p(""),u=p(!1),z=p(),I=p("blockPuzzle"),U=X(()=>t(M)===Na.LOGIN),j={tenantName:[f],username:[f],password:[f]},e=B({isShowPassword:!1,captchaEnable:"true",tenantEnable:"true",loginForm:{tenantName:"cmcc",username:"admin",password:"Aa123456",captchaVerification:"",rememberMe:!1}}),w=async()=>{k({accessToken:"a5e0d44b86d045c189882518a40b479e",expiresTime:1708635958255,refreshToken:"e079913cb8bb455383ebe97c977b5c83",userId:1}),y("/index")},x=p(),A=async o=>{u.value=!0;try{if(await(async()=>{if(e.tenantEnable==="true"){const n=await ga(e.loginForm.tenantName);ha(n)}})(),!await S())return;e.loginForm.captchaVerification=o.captchaVerification;const l=await ra(e.loginForm);if(!l)return;x.value=la.service({lock:!0,text:"\u6B63\u5728\u52A0\u8F7D\u7CFB\u7EDF\u4E2D...",background:"rgba(0, 0, 0, 0.7)"}),e.loginForm.rememberMe?oa(e.loginForm):na(),k(l),d.value||(d.value="/"),d.value.indexOf("sso")!==-1?window.location.href=window.location.href.replace("/login?redirect=",""):y({path:d.value||E.addRouters[0].path})}finally{u.value=!1,x.value.close()}};return H(()=>T.value,o=>{var l;d.value=(l=o==null?void 0:o.query)==null?void 0:l.redirect},{immediate:!0}),J(()=>{(()=>{const o=ta();o&&(e.loginForm={...e.loginForm,username:o.username?o.username:e.loginForm.username,password:o.password?o.password:e.loginForm.password,rememberMe:!!o.rememberMe,tenantName:o.tenantName?o.tenantName:e.loginForm.tenantName})})()}),(o,l)=>{const n=sa,s=ia,b=pa,K=ma,O=va,F=da,R=ba,q=wa,C=ca;return Q((Z(),$(C,{ref_key:"formLogin",ref:h,model:t(e).loginForm,rules:j,class:"login-form","label-position":"top","label-width":"120px",size:"large"},{default:r(()=>[a(F,{style:{"margin-right":"-10px","margin-left":"-10px"}},{default:r(()=>[a(s,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:r(()=>[a(n,null,{default:r(()=>[g]),_:1})]),_:1}),a(s,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:r(()=>[a(n,{prop:"username"},{default:r(()=>[a(b,{modelValue:t(e).loginForm.username,"onUpdate:modelValue":l[0]||(l[0]=i=>t(e).loginForm.username=i),placeholder:t(m)("login.usernamePlaceholder"),"prefix-icon":t(N)},null,8,["modelValue","placeholder","prefix-icon"])]),_:1})]),_:1}),a(s,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:r(()=>[a(n,{prop:"password"},{default:r(()=>[a(b,{modelValue:t(e).loginForm.password,"onUpdate:modelValue":l[1]||(l[1]=i=>t(e).loginForm.password=i),placeholder:t(m)("login.passwordPlaceholder"),"prefix-icon":t(P),"show-password":"",type:"password",onKeyup:l[2]||(l[2]=aa(i=>w(),["enter"]))},null,8,["modelValue","placeholder","prefix-icon"])]),_:1})]),_:1}),a(s,{span:24,style:{"padding-right":"10px","padding-left":"10px","margin-top":"-20px","margin-bottom":"-20px"}},{default:r(()=>[a(n,null,{default:r(()=>[a(F,{justify:"space-between",style:{width:"100%"}},{default:r(()=>[a(s,{span:6},{default:r(()=>[a(K,{modelValue:t(e).loginForm.rememberMe,"onUpdate:modelValue":l[3]||(l[3]=i=>t(e).loginForm.rememberMe=i)},{default:r(()=>[v(V(t(m)("login.remember")),1)]),_:1},8,["modelValue"])]),_:1}),a(s,{offset:6,span:12},{default:r(()=>[a(O,{style:{float:"right"},type:"primary"},{default:r(()=>[v(V(t(m)("login.forgetPassword")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(s,{span:24,style:{"padding-right":"10px","padding-left":"10px"}},{default:r(()=>[a(n,null,{default:r(()=>[a(R,{loading:t(u),title:t(m)("login.login"),class:"w-[100%]",type:"primary",onClick:l[4]||(l[4]=i=>w())},null,8,["loading","title"])]),_:1})]),_:1}),a(q,{ref_key:"verify",ref:z,captchaType:t(I),imgSize:{width:"400px",height:"200px"},mode:"pop",onSuccess:A},null,8,["captchaType"])]),_:1})]),_:1},8,["model"])),[[Y,t(U)]])}}}),[["__scopeId","data-v-e5788c3a"]])});export{Ua as __tla,L as default};
