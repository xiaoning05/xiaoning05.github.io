import{_ as I,__tla as H}from"./Table.vue_vue_type_style_index_0_scoped_1ee0f9ba_lang-2275dbf6.js";import{_ as Q}from"./_plugin-vue_export-helper-1b428a4d.js";import{_ as X,__tla as E}from"./Form-980450b6.js";import{d as G,ad as u,k as q,r as v,X as A,aq as J,a as s,c2 as K,o as g,c as C,b as w,cq as U,g as V,e as h,aH as F,q as b,h as k,t as P,$ as y,at as Y,F as Z,_ as aa,A as ta,n as ea,aQ as M,av as O,bh as $,ak as sa,__tla as oa}from"./index-34f06ebd.js";import{u as na,__tla as ia}from"./useForm-c2e486b9.js";import{d as ra}from"./download-20922b56.js";let j,B,N,ca=Promise.all([(()=>{try{return H}catch{}})(),(()=>{try{return E}catch{}})(),(()=>{try{return oa}catch{}})(),(()=>{try{return ia}catch{}})()]).then(async()=>{let z,c;B=Q(I,[["__scopeId","data-v-1ee0f9ba"]]),z={key:0},j=G({name:"Search",__name:"Search",props:{schema:{type:Array,default:()=>[]},isCol:u.bool.def(!1),labelWidth:u.oneOfType([String,Number]).def("auto"),layout:u.string.validate(a=>["inline","bottom"].includes(a)).def("inline"),buttomPosition:u.string.validate(a=>["left","center","right"].includes(a)).def("center"),showSearch:u.bool.def(!0),showReset:u.bool.def(!0),expand:u.bool.def(!1),expandField:u.string.def(""),inline:u.bool.def(!0),model:{type:Object,default:()=>({})}},emits:["search","reset"],setup(a,{emit:e}){const{t:m}=q(),l=a,L=e,r=v(!0),S=A(()=>{let n=J(l.schema);if(l.expand&&l.expandField&&!s(r)){const _=K(n,i=>i.field===l.expandField);if(_>-1){const i=n.length;n.splice(_+1,i)}}return l.layout==="inline"&&(n=n.concat([{field:"action",formItemProps:{labelWidth:"0px"}}])),n}),{register:p,elFormRef:t,methods:o}=na({model:l.model||{}}),d=async()=>{var n;await((n=s(t))==null?void 0:n.validate(async _=>{if(_){const{getFormData:i}=o,f=await i();L("search",f)}}))},x=async()=>{var i;(i=s(t))==null||i.resetFields();const{getFormData:n}=o,_=await n();L("reset",_)},D=A(()=>({textAlign:l.buttomPosition})),R=()=>{var n;(n=s(t))==null||n.resetFields(),r.value=!s(r)};return(n,_)=>{const i=aa,f=ta,W=X;return g(),C(Z,null,[w(W,{inline:a.inline,"is-col":a.isCol,"is-custom":!1,"label-width":a.labelWidth,schema:s(S),class:"-mb-15px","hide-required-asterisk":"",onRegister:s(p)},U({action:h(()=>[a.layout==="inline"?(g(),C("div",z,[a.showSearch?(g(),b(f,{key:0,onClick:d},{default:h(()=>[w(i,{class:"mr-5px",icon:"ep:search"}),k(" "+P(s(m)("common.query")),1)]),_:1})):y("",!0),a.showReset?(g(),b(f,{key:1,onClick:x},{default:h(()=>[w(i,{class:"mr-5px",icon:"ep:refresh"}),k(" "+P(s(m)("common.reset")),1)]),_:1})):y("",!0),a.expand?(g(),b(f,{key:2,text:"",onClick:R},{default:h(()=>[k(P(s(m)(s(r)?"common.shrink":"common.expand"))+" ",1),w(i,{icon:s(r)?"ep:arrow-up":"ep:arrow-down"},null,8,["icon"])]),_:1})):y("",!0),F(n.$slots,"actionMore")])):y("",!0)]),_:2},[V(Object.keys(n.$slots),T=>({name:T,fn:h(()=>[F(n.$slots,T)])}))]),1032,["inline","is-col","label-width","schema","onRegister"]),a.layout==="bottom"?(g(),C("div",{key:0,style:Y(s(D))},[a.showSearch?(g(),b(f,{key:0,type:"primary",onClick:d},{default:h(()=>[w(i,{class:"mr-5px",icon:"ep:search"}),k(" "+P(s(m)("common.query")),1)]),_:1})):y("",!0),a.showReset?(g(),b(f,{key:1,onClick:x},{default:h(()=>[w(i,{class:"mr-5px",icon:"ep:refresh-right"}),k(" "+P(s(m)("common.reset")),1)]),_:1})):y("",!0),a.expand?(g(),b(f,{key:2,text:"",onClick:R},{default:h(()=>[k(P(s(m)(s(r)?"common.shrink":"common.expand"))+" ",1),w(i,{icon:s(r)?"ep:arrow-up":"ep:arrow-down"},null,8,["icon"])]),_:1})):y("",!0),F(n.$slots,"actionMore")],4)):y("",!0)],64)}}}),{t:c}=q(),N=a=>{const e=ea({pageSize:10,currentPage:1,total:10,tableList:[],params:{...(a==null?void 0:a.defaultParams)||{}},loading:!0,exportLoading:!1,currentRow:null}),m=A(()=>({...e.params,pageSize:e.pageSize,pageNo:e.currentPage}));M(()=>e.currentPage,()=>{p.getList()}),M(()=>e.pageSize,()=>{e.currentPage===1||(e.currentPage=1),p.getList()});const l=v(),L=v(),r=async()=>(await sa(),s(l)),S=async t=>{let o=1;t instanceof Array?(o=t.length,await Promise.all(t.map(async d=>{await((a==null?void 0:a.delListApi)&&(a==null?void 0:a.delListApi(d)))}))):await((a==null?void 0:a.delListApi)&&(a==null?void 0:a.delListApi(t))),O.success(c("common.delSuccess")),e.currentPage=(e.total%e.pageSize===o||e.pageSize===1)&&e.currentPage>1?e.currentPage-1:e.currentPage,await p.getList()},p={getList:async()=>{e.loading=!0;const t=await(a==null?void 0:a.getListApi(s(m)).finally(()=>{e.loading=!1}));t&&(e.tableList=t.list,e.total=t.total??0)},setProps:async(t={})=>{const o=await r();o==null||o.setProps(t)},setColumn:async t=>{const o=await r();o==null||o.setColumn(t)},getSelections:async()=>{const t=await r();return(t==null?void 0:t.selections)||[]},setSearchParams:t=>{e.params=Object.assign(e.params,{pageSize:e.pageSize,pageNo:1,...t}),e.currentPage!==1?e.currentPage=1:p.getList()},delList:async(t,o,d=!0)=>{const x=await r();!o||x!=null&&x.selections.length?d?$.confirm(c("common.delMessage"),c("common.confirmTitle"),{confirmButtonText:c("common.ok"),cancelButtonText:c("common.cancel"),type:"warning"}).then(async()=>{await S(t)}):await S(t):O.warning(c("common.delNoData"))},exportList:async t=>{e.exportLoading=!0,$.confirm(c("common.exportMessage"),c("common.confirmTitle"),{confirmButtonText:c("common.ok"),cancelButtonText:c("common.cancel"),type:"warning"}).then(async()=>{var d;const o=await((d=a==null?void 0:a.exportListApi)==null?void 0:d.call(a,s(m)));o&&ra.excel(o,t)}).finally(()=>{e.exportLoading=!1})}};return a!=null&&a.props&&p.setProps(a.props),{register:(t,o)=>{l.value=t,L.value=o},elTableRef:L,tableObject:e,methods:p,tableMethods:p}}});export{j as _,ca as __tla,B as a,N as u};
