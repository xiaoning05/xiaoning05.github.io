import{d as J,k as L,r as y,o as m,c as h,b as l,e as t,a as o,h as u,w as j,q as k,F as G,g as X,t as Y,a0 as q,j as Z,L as $,y as H,af as Q,ag as W,A as ee,B as le,bh as ae,C as te,v as oe,_ as re,__tla as ie}from"./index-b079f499.js";import{_ as ne,__tla as de}from"./Dialog-07bcd661.js";import{C as ue}from"./constants-99751ef9.js";import{d as pe,D as se,__tla as ce}from"./dict-2c56908b.js";import{g as fe,c as me,u as ge,__tla as ye}from"./index-4aca9e3d.js";import{u as be,__tla as _e}from"./useMessage-66b9cf03.js";let A,Ce=Promise.all([(()=>{try{return ie}catch{}})(),(()=>{try{return de}catch{}})(),(()=>{try{return ce}catch{}})(),(()=>{try{return ye}catch{}})(),(()=>{try{return _e}catch{}})()]).then(async()=>{let x,R,p;x={key:0},R={key:1},p=".crt",A=re(J({name:"AlipayChannelForm",__name:"AlipayChannelForm",emits:["success"],setup(he,{expose:I,emit:K}){const{t:U}=L(),b=be(),s=y(!1),P=y(""),c=y(!1),a=y({appId:"",code:"",status:void 0,feeRate:void 0,remark:"",config:{appId:"",serverUrl:null,signType:"",mode:null,privateKey:"",alipayPublicKey:"",appCertContent:"",alipayPublicCertContent:"",rootCertContent:""}}),F={feeRate:[{required:!0,message:"\u8BF7\u8F93\u5165\u6E20\u9053\u8D39\u7387",trigger:"blur"}],status:[{required:!0,message:"\u6E20\u9053\u72B6\u6001\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],"config.appId":[{required:!0,message:"\u8BF7\u8F93\u5165\u5F00\u653E\u5E73\u53F0\u4E0A\u521B\u5EFA\u7684\u5E94\u7528\u7684 ID",trigger:"blur"}],"config.serverUrl":[{required:!0,message:"\u8BF7\u4F20\u5165\u7F51\u5173\u5730\u5740",trigger:"blur"}],"config.signType":[{required:!0,message:"\u8BF7\u4F20\u5165\u7B7E\u540D\u7B97\u6CD5\u7C7B\u578B",trigger:"blur"}],"config.mode":[{required:!0,message:"\u516C\u94A5\u7C7B\u578B\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],"config.privateKey":[{required:!0,message:"\u8BF7\u8F93\u5165\u5546\u6237\u79C1\u94A5",trigger:"blur"}],"config.alipayPublicKey":[{required:!0,message:"\u8BF7\u8F93\u5165\u652F\u4ED8\u5B9D\u516C\u94A5\u5B57\u7B26\u4E32",trigger:"blur"}],"config.appCertContent":[{required:!0,message:"\u8BF7\u4E0A\u4F20\u5546\u6237\u516C\u94A5\u5E94\u7528\u8BC1\u4E66",trigger:"blur"}],"config.alipayPublicCertContent":[{required:!0,message:"\u8BF7\u4E0A\u4F20\u652F\u4ED8\u5B9D\u516C\u94A5\u8BC1\u4E66",trigger:"blur"}],"config.rootCertContent":[{required:!0,message:"\u8BF7\u4E0A\u4F20\u6307\u5B9A\u6839\u8BC1\u4E66",trigger:"blur"}]},_=y();I({open:async(n,e)=>{s.value=!0,c.value=!0,z(n,e);try{const i=await fe(n,e);i&&i.id&&(a.value=i,a.value.config=JSON.parse(i.config)),P.value=a.value.id?"\u7F16\u8F91\u652F\u4ED8\u6E20\u9053":"\u521B\u5EFA\u652F\u4ED8\u6E20\u9053"}finally{c.value=!1}}});const T=K,S=async()=>{if(_&&await _.value.validate()){c.value=!0;try{const n={...a.value};n.config=JSON.stringify(a.value.config),n.id?(await ge(n),b.success(U("common.updateSuccess"))):(await me(n),b.success(U("common.createSuccess"))),s.value=!1,T("success")}finally{c.value=!1}}},z=(n,e)=>{var i;a.value={appId:n,code:e,status:ue.ENABLE,remark:"",feeRate:null,config:{appId:"",serverUrl:null,signType:"RSA2",mode:null,privateKey:"",alipayPublicKey:"",appCertContent:"",alipayPublicCertContent:"",rootCertContent:""}},(i=_.value)==null||i.resetFields()},v=n=>{if("."+n.name.split(".")[1]!==p)return b.error(`\u8BF7\u4E0A\u4F20\u6307\u5B9A\u683C\u5F0F"${p}"\u6587\u4EF6`),!1;let e=n.size/1024/1024<2;return e||b.error("\u6587\u4EF6\u5927\u5C0F\u8D85\u8FC7 2MB"),e},D=n=>{const e=new FileReader;e.onload=i=>{a.value.config.appCertContent=i.target.result},e.readAsText(n.file)},M=n=>{const e=new FileReader;e.onload=i=>{a.value.config.alipayPublicCertContent=i.target.result},e.readAsText(n.file)},N=n=>{const e=new FileReader;e.onload=i=>{a.value.config.rootCertContent=i.target.result},e.readAsText(n.file)};return(n,e)=>{const i=$,d=H,f=Q,C=W,w=ee,g=le,V=ae,O=te,B=ne,E=oe;return m(),h("div",null,[l(B,{modelValue:o(s),"onUpdate:modelValue":e[14]||(e[14]=r=>Z(s)?s.value=r:null),title:o(P),onClosed:n.close,width:"830px"},{footer:t(()=>[l(g,{disabled:o(c),type:"primary",onClick:S},{default:t(()=>[u("\u786E \u5B9A")]),_:1},8,["disabled"]),l(g,{onClick:e[13]||(e[13]=r=>s.value=!1)},{default:t(()=>[u("\u53D6 \u6D88")]),_:1})]),default:t(()=>[j((m(),k(O,{ref_key:"formRef",ref:_,model:o(a),formRules:F,"label-width":"100px"},{default:t(()=>[l(d,{"label-width":"180px",label:"\u6E20\u9053\u8D39\u7387",prop:"feeRate"},{default:t(()=>[l(i,{modelValue:o(a).feeRate,"onUpdate:modelValue":e[0]||(e[0]=r=>o(a).feeRate=r),placeholder:"\u8BF7\u8F93\u5165\u6E20\u9053\u8D39\u7387",clearable:""},{append:t(()=>[u("%")]),_:1},8,["modelValue"])]),_:1}),l(d,{"label-width":"180px",label:"\u5F00\u653E\u5E73\u53F0 APPID",prop:"config.appId"},{default:t(()=>[l(i,{modelValue:o(a).config.appId,"onUpdate:modelValue":e[1]||(e[1]=r=>o(a).config.appId=r),placeholder:"\u8BF7\u8F93\u5165\u5F00\u653E\u5E73\u53F0 APPID",clearable:""},null,8,["modelValue"])]),_:1}),l(d,{"label-width":"180px",label:"\u6E20\u9053\u72B6\u6001",prop:"status"},{default:t(()=>[l(C,{modelValue:o(a).status,"onUpdate:modelValue":e[2]||(e[2]=r=>o(a).status=r)},{default:t(()=>[(m(!0),h(G,null,X(o(pe)(o(se).COMMON_STATUS),r=>(m(),k(f,{key:parseInt(r.value),label:parseInt(r.value)},{default:t(()=>[u(Y(r.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(d,{"label-width":"180px",label:"\u7F51\u5173\u5730\u5740",prop:"config.serverUrl"},{default:t(()=>[l(C,{modelValue:o(a).config.serverUrl,"onUpdate:modelValue":e[3]||(e[3]=r=>o(a).config.serverUrl=r)},{default:t(()=>[l(f,{label:"https://openapi.alipay.com/gateway.do"},{default:t(()=>[u("\u7EBF\u4E0A\u73AF\u5883")]),_:1}),l(f,{label:"https://openapi-sandbox.dl.alipaydev.com/gateway.do"},{default:t(()=>[u(" \u6C99\u7BB1\u73AF\u5883 ")]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(d,{"label-width":"180px",label:"\u7B97\u6CD5\u7C7B\u578B",prop:"config.signType"},{default:t(()=>[l(C,{modelValue:o(a).config.signType,"onUpdate:modelValue":e[4]||(e[4]=r=>o(a).config.signType=r)},{default:t(()=>[l(f,{key:"RSA2",label:"RSA2"},{default:t(()=>[u("RSA2")]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(d,{"label-width":"180px",label:"\u516C\u94A5\u7C7B\u578B",prop:"config.mode"},{default:t(()=>[l(C,{modelValue:o(a).config.mode,"onUpdate:modelValue":e[5]||(e[5]=r=>o(a).config.mode=r)},{default:t(()=>[l(f,{key:"\u516C\u94A5\u6A21\u5F0F",label:1},{default:t(()=>[u("\u516C\u94A5\u6A21\u5F0F")]),_:1}),l(f,{key:"\u8BC1\u4E66\u6A21\u5F0F",label:2},{default:t(()=>[u("\u8BC1\u4E66\u6A21\u5F0F")]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(a).config.mode===1?(m(),h("div",x,[l(d,{"label-width":"180px",label:"\u5E94\u7528\u79C1\u94A5",prop:"config.privateKey"},{default:t(()=>[l(i,{type:"textarea",autosize:{minRows:8,maxRows:8},modelValue:o(a).config.privateKey,"onUpdate:modelValue":e[6]||(e[6]=r=>o(a).config.privateKey=r),placeholder:"\u8BF7\u8F93\u5165\u5E94\u7528\u79C1\u94A5",clearable:"",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),l(d,{"label-width":"180px",label:"\u652F\u4ED8\u5B9D\u516C\u94A5",prop:"config.alipayPublicKey"},{default:t(()=>[l(i,{type:"textarea",autosize:{minRows:8,maxRows:8},modelValue:o(a).config.alipayPublicKey,"onUpdate:modelValue":e[7]||(e[7]=r=>o(a).config.alipayPublicKey=r),placeholder:"\u8BF7\u8F93\u5165\u652F\u4ED8\u5B9D\u516C\u94A5",clearable:"",style:{width:"100%"}},null,8,["modelValue"])]),_:1})])):q("",!0),o(a).config.mode===2?(m(),h("div",R,[l(d,{"label-width":"180px",label:"\u5E94\u7528\u79C1\u94A5",prop:"config.privateKey"},{default:t(()=>[l(i,{type:"textarea",autosize:{minRows:8,maxRows:8},modelValue:o(a).config.privateKey,"onUpdate:modelValue":e[8]||(e[8]=r=>o(a).config.privateKey=r),placeholder:"\u8BF7\u8F93\u5165\u5E94\u7528\u79C1\u94A5",clearable:"",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),l(d,{"label-width":"180px",label:"\u5546\u6237\u516C\u94A5\u5E94\u7528\u8BC1\u4E66",prop:"config.appCertContent"},{default:t(()=>[l(i,{modelValue:o(a).config.appCertContent,"onUpdate:modelValue":e[9]||(e[9]=r=>o(a).config.appCertContent=r),type:"textarea",placeholder:"\u8BF7\u4E0A\u4F20\u5546\u6237\u516C\u94A5\u5E94\u7528\u8BC1\u4E66",readonly:"",autosize:{minRows:8,maxRows:8},style:{width:"100%"}},null,8,["modelValue"])]),_:1}),l(d,{"label-width":"180px",label:""},{default:t(()=>[l(V,{action:"",ref:"privateKeyContentFile",limit:1,accept:p,"http-request":D,"before-upload":v},{default:t(()=>[l(g,{type:"primary"},{default:t(()=>[l(w,{icon:"ep:upload",class:"mr-5px"}),u(" \u70B9\u51FB\u4E0A\u4F20 ")]),_:1})]),_:1},512)]),_:1}),l(d,{"label-width":"180px",label:"\u652F\u4ED8\u5B9D\u516C\u94A5\u8BC1\u4E66",prop:"config.alipayPublicCertContent"},{default:t(()=>[l(i,{modelValue:o(a).config.alipayPublicCertContent,"onUpdate:modelValue":e[10]||(e[10]=r=>o(a).config.alipayPublicCertContent=r),type:"textarea",placeholder:"\u8BF7\u4E0A\u4F20\u652F\u4ED8\u5B9D\u516C\u94A5\u8BC1\u4E66",readonly:"",autosize:{minRows:8,maxRows:8},style:{width:"100%"}},null,8,["modelValue"])]),_:1}),l(d,{"label-width":"180px",label:""},{default:t(()=>[l(V,{ref:"privateCertContentFile",action:"",limit:1,accept:p,"before-upload":v,"http-request":M},{default:t(()=>[l(g,{type:"primary"},{default:t(()=>[l(w,{icon:"ep:upload",class:"mr-5px"}),u(" \u70B9\u51FB\u4E0A\u4F20 ")]),_:1})]),_:1},512)]),_:1}),l(d,{"label-width":"180px",label:"\u6839\u8BC1\u4E66",prop:"config.rootCertContent"},{default:t(()=>[l(i,{modelValue:o(a).config.rootCertContent,"onUpdate:modelValue":e[11]||(e[11]=r=>o(a).config.rootCertContent=r),type:"textarea",placeholder:"\u8BF7\u4E0A\u4F20\u6839\u8BC1\u4E66",readonly:"",autosize:{minRows:8,maxRows:8},style:{width:"100%"}},null,8,["modelValue"])]),_:1}),l(d,{"label-width":"180px",label:""},{default:t(()=>[l(V,{ref:"privateCertContentFile",limit:1,accept:p,action:"","before-upload":v,"http-request":N},{default:t(()=>[l(g,{type:"primary"},{default:t(()=>[l(w,{icon:"ep:upload",class:"mr-5px"}),u(" \u70B9\u51FB\u4E0A\u4F20 ")]),_:1})]),_:1},512)]),_:1})])):q("",!0),l(d,{"label-width":"180px",label:"\u5907\u6CE8",prop:"remark"},{default:t(()=>[l(i,{modelValue:o(a).remark,"onUpdate:modelValue":e[12]||(e[12]=r=>o(a).remark=r),style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])),[[E,o(c)]])]),_:1},8,["modelValue","title","onClosed"])])}}}),[["__file","E:/newCode/GYZX-UI-ADMIN/src/views/pay/app/components/channel/AlipayChannelForm.vue"]])});export{Ce as __tla,A as default};
