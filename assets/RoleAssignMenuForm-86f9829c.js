import{d as B,k as z,r as o,n as D,o as V,q as b,e as l,b as t,a as u,h as _,w as G,t as C,j as y,ah as J,y as O,V as P,dS as L,B as Q,A as T,v as W,__tla as X}from"./index-34f06ebd.js";import{_ as Y,__tla as Z}from"./Dialog.vue_vue_type_style_index_0_lang-08560286.js";import{d as $,h as ee}from"./tree-82bb3b99.js";import{g as ae,__tla as le}from"./index-97882b9e.js";import{g as te,a as se,__tla as ue}from"./index-647c6ebb.js";import{u as de,__tla as oe}from"./useMessage-7a5ab7ef.js";import{E as ne,__tla as re}from"./index-460c50ff.js";import{_ as me}from"./_plugin-vue_export-helper-1b428a4d.js";let g,ce=Promise.all([(()=>{try{return X}catch{}})(),(()=>{try{return Z}catch{}})(),(()=>{try{return le}catch{}})(),(()=>{try{return ue}catch{}})(),(()=>{try{return oe}catch{}})(),(()=>{try{return re}catch{}})()]).then(async()=>{g=me(B({name:"SystemRoleAssignMenuForm",__name:"RoleAssignMenuForm",emits:["success"],setup(_e,{expose:w,emit:I}){const{t:R}=z(),M=de(),n=o(!1),r=o(!1),s=D({id:0,name:"",code:"",menuIds:[]}),f=o(),p=o([]),m=o(!1),d=o(),i=o(!1);w({open:async a=>{n.value=!0,S(),p.value=ee(await ae()),s.id=a.id,s.name=a.name,s.code=a.code,r.value=!0;try{s.value.menuIds=await te(a.id),s.value.menuIds.forEach(e=>{d.value.setChecked(e,!0,!1)})}finally{r.value=!1}}});const A=I,F=async()=>{if(f&&await f.value.validate()){r.value=!0;try{const a={roleId:s.id,menuIds:[...d.value.getCheckedKeys(!1),...d.value.getHalfCheckedKeys()]};await se(a),M.success(R("common.updateSuccess")),n.value=!1,A("success")}finally{r.value=!1}}},S=()=>{var a,e;i.value=!1,m.value=!1,s.value={id:0,name:"",code:"",menuIds:[]},(a=d.value)==null||a.setCheckedNodes([]),(e=f.value)==null||e.resetFields()},U=()=>{d.value.setCheckedNodes(i.value?p.value:[])},j=()=>{var e;const a=(e=d.value)==null?void 0:e.store.nodesMap;for(let v in a)a[v].expanded!==m.value&&(a[v].expanded=m.value)};return(a,e)=>{const v=J,h=O,k=P,E=L,H=ne,K=Q,x=T,N=Y,q=W;return V(),b(N,{modelValue:u(n),"onUpdate:modelValue":e[3]||(e[3]=c=>y(n)?n.value=c:null),title:"\u83DC\u5355\u6743\u9650"},{footer:l(()=>[t(x,{disabled:u(r),type:"primary",onClick:F},{default:l(()=>[_("\u786E \u5B9A")]),_:1},8,["disabled"]),t(x,{onClick:e[2]||(e[2]=c=>n.value=!1)},{default:l(()=>[_("\u53D6 \u6D88")]),_:1})]),default:l(()=>[G((V(),b(K,{ref_key:"formRef",ref:f,model:u(s),"label-width":"80px"},{default:l(()=>[t(h,{label:"\u89D2\u8272\u540D\u79F0"},{default:l(()=>[t(v,null,{default:l(()=>[_(C(u(s).name),1)]),_:1})]),_:1}),t(h,{label:"\u89D2\u8272\u6807\u8BC6"},{default:l(()=>[t(v,null,{default:l(()=>[_(C(u(s).code),1)]),_:1})]),_:1}),t(h,{label:"\u83DC\u5355\u6743\u9650"},{default:l(()=>[t(H,{class:"cardHeight"},{header:l(()=>[_(" \u5168\u9009/\u5168\u4E0D\u9009: "),t(k,{modelValue:u(i),"onUpdate:modelValue":e[0]||(e[0]=c=>y(i)?i.value=c:null),"active-text":"\u662F","inactive-text":"\u5426","inline-prompt":"",onChange:U},null,8,["modelValue"]),_(" \u5168\u90E8\u5C55\u5F00/\u6298\u53E0: "),t(k,{modelValue:u(m),"onUpdate:modelValue":e[1]||(e[1]=c=>y(m)?m.value=c:null),"active-text":"\u5C55\u5F00","inactive-text":"\u6298\u53E0","inline-prompt":"",onChange:j},null,8,["modelValue"])]),default:l(()=>[t(E,{ref_key:"treeRef",ref:d,data:u(p),props:u($),"empty-text":"\u52A0\u8F7D\u4E2D\uFF0C\u8BF7\u7A0D\u5019","node-key":"id","show-checkbox":""},null,8,["data","props"])]),_:1})]),_:1})]),_:1},8,["model"])),[[q,u(r)]])]),_:1},8,["modelValue"])}}}),[["__scopeId","data-v-16ab792e"]])});export{ce as __tla,g as default};
