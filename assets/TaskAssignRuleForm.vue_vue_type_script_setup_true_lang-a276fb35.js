import{_ as H,__tla as J}from"./Dialog.vue_vue_type_style_index_0_lang-08560286.js";import{an as h,d as O,r as p,n as W,o as r,q as o,e as u,b as d,h as x,a as l,c as y,g as I,F as v,$ as f,j as X,k as Z,K as Q,y as ee,s as ae,x as le,B as te,A as se,__tla as ue}from"./index-34f06ebd.js";import{E as re,__tla as de}from"./el-tree-select-45b5cb50.js";import{a as K,D as R,__tla as oe}from"./dict-e142e39a.js";import{d as pe,h as ie}from"./tree-82bb3b99.js";import{g as ne,__tla as me}from"./index-87f4f1d4.js";import{g as _e,__tla as ce}from"./index-90fcf1c8.js";import{g as ye,__tla as Ie}from"./index-43170a96.js";import{g as ve,__tla as fe}from"./index-cd2bb9f6.js";import{g as ge,__tla as be}from"./index-4d82cf43.js";import{u as he,__tla as ke}from"./useMessage-7a5ab7ef.js";let T,P,Ve=Promise.all([(()=>{try{return J}catch{}})(),(()=>{try{return ue}catch{}})(),(()=>{try{return de}catch{}})(),(()=>{try{return oe}catch{}})(),(()=>{try{return me}catch{}})(),(()=>{try{return ce}catch{}})(),(()=>{try{return Ie}catch{}})(),(()=>{try{return fe}catch{}})(),(()=>{try{return be}catch{}})(),(()=>{try{return ke}catch{}})()]).then(async()=>{P=async k=>await h.get({url:"/bpm/task-assign-rule/list",params:k}),T=O({name:"BpmTaskAssignRuleForm",__name:"TaskAssignRuleForm",emits:["success"],setup(k,{expose:B,emit:F}){const{t:V}=Z(),w=he(),n=p(!1),b=p(!1),t=p({type:NaN,modelId:"",options:[],roleIds:[],deptIds:[],postIds:[],userIds:[],userGroupIds:[],scripts:[]}),C=W({type:[{required:!0,message:"\u89C4\u5219\u7C7B\u578B\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],roleIds:[{required:!0,message:"\u6307\u5B9A\u89D2\u8272\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],deptIds:[{required:!0,message:"\u6307\u5B9A\u90E8\u95E8\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],postIds:[{required:!0,message:"\u6307\u5B9A\u5C97\u4F4D\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],userIds:[{required:!0,message:"\u6307\u5B9A\u7528\u6237\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],userGroupIds:[{required:!0,message:"\u6307\u5B9A\u7528\u6237\u7EC4\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}],scripts:[{required:!0,message:"\u6307\u5B9A\u811A\u672C\u4E0D\u80FD\u4E3A\u7A7A",trigger:"change"}]}),g=p(),G=p([]),U=p([]),S=p(),q=p([]),D=p([]),A=p([]),E=K(R.BPM_TASK_ASSIGN_SCRIPT);B({open:async(s,a)=>{L(),t.value={...a,modelId:s,options:[],roleIds:[],deptIds:[],postIds:[],userIds:[],userGroupIds:[],scripts:[]},a.type===10?t.value.roleIds.push(...a.options):a.type===20||a.type===21?t.value.deptIds.push(...a.options):a.type===22?t.value.postIds.push(...a.options):a.type===30||a.type===31||a.type===32?t.value.userIds.push(...a.options):a.type===40?t.value.userGroupIds.push(...a.options):a.type===50&&t.value.scripts.push(...a.options),n.value=!0,G.value=await ne(),U.value=await _e(),S.value=ie(U.value,"id"),q.value=await ye(),D.value=await ve(),A.value=await ge()}});const M=F,j=async()=>{if(!g||!await g.value.validate())return;const s={...t.value,taskDefinitionName:void 0};s.type===10?s.options=s.roleIds:s.type===20||s.type===21?s.options=s.deptIds:s.type===22?s.options=s.postIds:s.type===30||s.type===31||s.type===32?s.options=s.userIds:s.type===40?s.options=s.userGroupIds:s.type===50&&(s.options=s.scripts),s.roleIds=void 0,s.deptIds=void 0,s.postIds=void 0,s.userIds=void 0,s.userGroupIds=void 0,s.scripts=void 0,b.value=!0;try{const a=s;a.id?(await(async m=>await h.put({url:"/bpm/task-assign-rule/update",data:m}))(a),w.success(V("common.updateSuccess"))):(await(async m=>await h.post({url:"/bpm/task-assign-rule/create",data:m}))(a),w.success(V("common.createSuccess"))),n.value=!1,M("success")}finally{b.value=!1}},L=()=>{var s;(s=g.value)==null||s.resetFields()};return(s,a)=>{const m=Q,i=ee,_=ae,c=le,Y=re,$=te,N=se,z=H;return r(),o(z,{modelValue:l(n),"onUpdate:modelValue":a[10]||(a[10]=e=>X(n)?n.value=e:null),title:"\u4FEE\u6539\u4EFB\u52A1\u89C4\u5219",width:"600"},{footer:u(()=>[d(N,{disabled:l(b),type:"primary",onClick:j},{default:u(()=>[x("\u786E \u5B9A")]),_:1},8,["disabled"]),d(N,{onClick:a[9]||(a[9]=e=>n.value=!1)},{default:u(()=>[x("\u53D6 \u6D88")]),_:1})]),default:u(()=>[d($,{ref_key:"formRef",ref:g,model:l(t),rules:l(C),"label-width":"80px"},{default:u(()=>[d(i,{label:"\u4EFB\u52A1\u540D\u79F0",prop:"taskDefinitionName"},{default:u(()=>[d(m,{modelValue:l(t).taskDefinitionName,"onUpdate:modelValue":a[0]||(a[0]=e=>l(t).taskDefinitionName=e),disabled:"",placeholder:"\u8BF7\u8F93\u5165\u6D41\u6807\u6807\u8BC6"},null,8,["modelValue"])]),_:1}),d(i,{label:"\u4EFB\u52A1\u6807\u8BC6",prop:"taskDefinitionKey"},{default:u(()=>[d(m,{modelValue:l(t).taskDefinitionKey,"onUpdate:modelValue":a[1]||(a[1]=e=>l(t).taskDefinitionKey=e),disabled:"",placeholder:"\u8BF7\u8F93\u5165\u4EFB\u52A1\u6807\u8BC6"},null,8,["modelValue"])]),_:1}),d(i,{label:"\u89C4\u5219\u7C7B\u578B",prop:"type"},{default:u(()=>[d(c,{modelValue:l(t).type,"onUpdate:modelValue":a[2]||(a[2]=e=>l(t).type=e),clearable:"",style:{width:"100%"}},{default:u(()=>[(r(!0),y(v,null,I(l(K)(l(R).BPM_TASK_ASSIGN_RULE_TYPE),e=>(r(),o(_,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(t).type===10?(r(),o(i,{key:0,label:"\u6307\u5B9A\u89D2\u8272",prop:"roleIds"},{default:u(()=>[d(c,{modelValue:l(t).roleIds,"onUpdate:modelValue":a[3]||(a[3]=e=>l(t).roleIds=e),clearable:"",multiple:"",style:{width:"100%"}},{default:u(()=>[(r(!0),y(v,null,I(l(G),e=>(r(),o(_,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):f("",!0),l(t).type===20||l(t).type===21?(r(),o(i,{key:1,label:"\u6307\u5B9A\u90E8\u95E8",prop:"deptIds",span:"24"},{default:u(()=>[d(Y,{ref:"treeRef",modelValue:l(t).deptIds,"onUpdate:modelValue":a[4]||(a[4]=e=>l(t).deptIds=e),data:l(S),props:l(pe),"empty-text":"\u52A0\u8F7D\u4E2D\uFF0C\u8BF7\u7A0D\u540E",multiple:"","node-key":"id","show-checkbox":""},null,8,["modelValue","data","props"])]),_:1})):f("",!0),l(t).type===22?(r(),o(i,{key:2,label:"\u6307\u5B9A\u5C97\u4F4D",prop:"postIds",span:"24"},{default:u(()=>[d(c,{modelValue:l(t).postIds,"onUpdate:modelValue":a[5]||(a[5]=e=>l(t).postIds=e),clearable:"",multiple:"",style:{width:"100%"}},{default:u(()=>[(r(!0),y(v,null,I(l(q),e=>(r(),o(_,{key:parseInt(e.id),label:e.name,value:parseInt(e.id)},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):f("",!0),l(t).type===30||l(t).type===31||l(t).type===32?(r(),o(i,{key:3,label:"\u6307\u5B9A\u7528\u6237",prop:"userIds",span:"24"},{default:u(()=>[d(c,{modelValue:l(t).userIds,"onUpdate:modelValue":a[6]||(a[6]=e=>l(t).userIds=e),clearable:"",multiple:"",style:{width:"100%"}},{default:u(()=>[(r(!0),y(v,null,I(l(D),e=>(r(),o(_,{key:parseInt(e.id),label:e.nickname,value:parseInt(e.id)},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):f("",!0),l(t).type===40?(r(),o(i,{key:4,label:"\u6307\u5B9A\u7528\u6237\u7EC4",prop:"userGroupIds"},{default:u(()=>[d(c,{modelValue:l(t).userGroupIds,"onUpdate:modelValue":a[7]||(a[7]=e=>l(t).userGroupIds=e),clearable:"",multiple:"",style:{width:"100%"}},{default:u(()=>[(r(!0),y(v,null,I(l(A),e=>(r(),o(_,{key:parseInt(e.id),label:e.name,value:parseInt(e.id)},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):f("",!0),l(t).type===50?(r(),o(i,{key:5,label:"\u6307\u5B9A\u811A\u672C",prop:"scripts"},{default:u(()=>[d(c,{modelValue:l(t).scripts,"onUpdate:modelValue":a[8]||(a[8]=e=>l(t).scripts=e),clearable:"",multiple:"",style:{width:"100%"}},{default:u(()=>[(r(!0),y(v,null,I(l(E),e=>(r(),o(_,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):f("",!0)]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])}}})});export{T as _,Ve as __tla,P as g};
