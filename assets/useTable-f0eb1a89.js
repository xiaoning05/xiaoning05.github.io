import{_ as E,__tla as G}from"./Table.vue_vue_type_style_index_0_scoped_b4105caf_lang-16b2ef26.js";import{_ as M,d as U,ae as u,k as N,r as A,Y as C,ar as X,a as s,c5 as Z,o as g,c as v,b as w,cs as H,g as J,e as f,aI as T,q as x,h as P,t as k,a0 as y,au as K,F as Q,A as V,B as ee,n as ae,aR as B,aw as D,bi as j,al as te,__tla as se}from"./index-b079f499.js";import{_ as oe,__tla as ne}from"./Form-ee45a7be.js";import{u as re,__tla as ie}from"./useForm-c1601035.js";import{d as ce}from"./download-20922b56.js";let O,q,$,le=Promise.all([(()=>{try{return G}catch{}})(),(()=>{try{return se}catch{}})(),(()=>{try{return ne}catch{}})(),(()=>{try{return ie}catch{}})()]).then(async()=>{let R,z,c;q=M(E,[["__scopeId","data-v-b4105caf"],["__file","E:/newCode/GYZX-UI-ADMIN/src/components/Table/src/Table.vue"]]),R={key:0},z=U({name:"Search",__name:"Search",props:{schema:{type:Array,default:()=>[]},isCol:u.bool.def(!1),labelWidth:u.oneOfType([String,Number]).def("auto"),layout:u.string.validate(e=>["inline","bottom"].includes(e)).def("inline"),buttomPosition:u.string.validate(e=>["left","center","right"].includes(e)).def("center"),showSearch:u.bool.def(!0),showReset:u.bool.def(!0),expand:u.bool.def(!1),expandField:u.string.def(""),inline:u.bool.def(!0),model:{type:Object,default:()=>({})}},emits:["search","reset"],setup(e,{emit:t}){const{t:m}=N(),l=e,L=t,i=A(!0),S=C(()=>{let n=X(l.schema);if(l.expand&&l.expandField&&!s(i)){const _=Z(n,r=>r.field===l.expandField);if(_>-1){const r=n.length;n.splice(_+1,r)}}return l.layout==="inline"&&(n=n.concat([{field:"action",formItemProps:{labelWidth:"0px"}}])),n}),{register:p,elFormRef:a,methods:o}=re({model:l.model||{}}),d=async()=>{var n;await((n=s(a))==null?void 0:n.validate(async _=>{if(_){const{getFormData:r}=o,h=await r();L("search",h)}}))},b=async()=>{var r;(r=s(a))==null||r.resetFields();const{getFormData:n}=o,_=await n();L("reset",_)},W=C(()=>({textAlign:l.buttomPosition})),F=()=>{var n;(n=s(a))==null||n.resetFields(),i.value=!s(i)};return(n,_)=>{const r=V,h=ee,Y=oe;return g(),v(Q,null,[w(Y,{inline:e.inline,"is-col":e.isCol,"is-custom":!1,"label-width":e.labelWidth,schema:s(S),class:"-mb-15px","hide-required-asterisk":"",onRegister:s(p)},H({action:f(()=>[e.layout==="inline"?(g(),v("div",R,[e.showSearch?(g(),x(h,{key:0,onClick:d},{default:f(()=>[w(r,{class:"mr-5px",icon:"ep:search"}),P(" "+k(s(m)("common.query")),1)]),_:1})):y("",!0),e.showReset?(g(),x(h,{key:1,onClick:b},{default:f(()=>[w(r,{class:"mr-5px",icon:"ep:refresh"}),P(" "+k(s(m)("common.reset")),1)]),_:1})):y("",!0),e.expand?(g(),x(h,{key:2,text:"",onClick:F},{default:f(()=>[P(k(s(m)(s(i)?"common.shrink":"common.expand"))+" ",1),w(r,{icon:s(i)?"ep:arrow-up":"ep:arrow-down"},null,8,["icon"])]),_:1})):y("",!0),T(n.$slots,"actionMore")])):y("",!0)]),_:2},[J(Object.keys(n.$slots),I=>({name:I,fn:f(()=>[T(n.$slots,I)])}))]),1032,["inline","is-col","label-width","schema","onRegister"]),e.layout==="bottom"?(g(),v("div",{key:0,style:K(s(W))},[e.showSearch?(g(),x(h,{key:0,type:"primary",onClick:d},{default:f(()=>[w(r,{class:"mr-5px",icon:"ep:search"}),P(" "+k(s(m)("common.query")),1)]),_:1})):y("",!0),e.showReset?(g(),x(h,{key:1,onClick:b},{default:f(()=>[w(r,{class:"mr-5px",icon:"ep:refresh-right"}),P(" "+k(s(m)("common.reset")),1)]),_:1})):y("",!0),e.expand?(g(),x(h,{key:2,text:"",onClick:F},{default:f(()=>[P(k(s(m)(s(i)?"common.shrink":"common.expand"))+" ",1),w(r,{icon:s(i)?"ep:arrow-up":"ep:arrow-down"},null,8,["icon"])]),_:1})):y("",!0),T(n.$slots,"actionMore")],4)):y("",!0)],64)}}}),O=M(z,[["__file","E:/newCode/GYZX-UI-ADMIN/src/components/Search/src/Search.vue"]]),{t:c}=N(),$=e=>{const t=ae({pageSize:10,currentPage:1,total:10,tableList:[],params:{...(e==null?void 0:e.defaultParams)||{}},loading:!0,exportLoading:!1,currentRow:null}),m=C(()=>({...t.params,pageSize:t.pageSize,pageNo:t.currentPage}));B(()=>t.currentPage,()=>{p.getList()}),B(()=>t.pageSize,()=>{t.currentPage===1||(t.currentPage=1),p.getList()});const l=A(),L=A(),i=async()=>{await te();const a=s(l);return a||console.error("The table is not registered. Please use the register method to register"),a},S=async a=>{let o=1;a instanceof Array?(o=a.length,await Promise.all(a.map(async d=>{await((e==null?void 0:e.delListApi)&&(e==null?void 0:e.delListApi(d)))}))):await((e==null?void 0:e.delListApi)&&(e==null?void 0:e.delListApi(a))),D.success(c("common.delSuccess")),t.currentPage=(t.total%t.pageSize===o||t.pageSize===1)&&t.currentPage>1?t.currentPage-1:t.currentPage,await p.getList()},p={getList:async()=>{t.loading=!0;const a=await(e==null?void 0:e.getListApi(s(m)).finally(()=>{t.loading=!1}));a&&(t.tableList=a.list,t.total=a.total??0)},setProps:async(a={})=>{const o=await i();o==null||o.setProps(a)},setColumn:async a=>{const o=await i();o==null||o.setColumn(a)},getSelections:async()=>{const a=await i();return(a==null?void 0:a.selections)||[]},setSearchParams:a=>{t.params=Object.assign(t.params,{pageSize:t.pageSize,pageNo:1,...a}),t.currentPage!==1?t.currentPage=1:p.getList()},delList:async(a,o,d=!0)=>{const b=await i();!o||b!=null&&b.selections.length?d?j.confirm(c("common.delMessage"),c("common.confirmTitle"),{confirmButtonText:c("common.ok"),cancelButtonText:c("common.cancel"),type:"warning"}).then(async()=>{await S(a)}):await S(a):D.warning(c("common.delNoData"))},exportList:async a=>{t.exportLoading=!0,j.confirm(c("common.exportMessage"),c("common.confirmTitle"),{confirmButtonText:c("common.ok"),cancelButtonText:c("common.cancel"),type:"warning"}).then(async()=>{var d;const o=await((d=e==null?void 0:e.exportListApi)==null?void 0:d.call(e,s(m)));o&&ce.excel(o,a)}).finally(()=>{t.exportLoading=!1})}};return e!=null&&e.props&&p.setProps(e.props),{register:(a,o)=>{l.value=a,L.value=o},elTableRef:L,tableObject:t,methods:p,tableMethods:p}}});export{O as _,le as __tla,q as a,$ as u};
