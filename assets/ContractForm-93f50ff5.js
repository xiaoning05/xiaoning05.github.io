import{d as K,i as O,r as m,e as W,aT as $,a2 as ee,o as n,v as c,w as t,f as a,a as l,h as w,x as ae,c as v,F as y,q as b,t as le,av as te,l as re,Q as ue,A as de,j as oe,y as se,z as ne,B as me,c0 as _e,k as ce,G as pe,D as ie,J as fe,_ as Ve,__tla as ve}from"./index-f0743f71.js";import{_ as ye,__tla as be}from"./Dialog-8f786edd.js";import{b as he,__tla as Ie}from"./index-3518afc7.js";import{a as Ue,c as ge,u as we,__tla as ke}from"./index-19d240e6.js";import{g as Pe,__tla as xe}from"./index-5f468446.js";import{g as De,__tla as Te}from"./index-8255f94a.js";import{h as qe,__tla as Ce}from"./index-109e656c.js";import Fe,{__tla as Ne}from"./ProductList-a32d3fc0.js";import{u as Ae,__tla as Ge}from"./useMessage-75a00a06.js";import{__tla as Se}from"./DictTag-4f08045a.js";import"./color-f5b6e279.js";import{__tla as Je}from"./dict-4a9940b3.js";import{__tla as je}from"./index-71d2ef9b.js";import{__tla as ze}from"./formatter-d3f1795f.js";import{__tla as Be}from"./Table.vue_vue_type_style_index_0_scoped_b4105caf_lang-6757bef5.js";import{__tla as Ee}from"./tsxHelper-0d496dea.js";import{__tla as Le}from"./index-8beae3df.js";import{__tla as Me}from"./index-cf7b3541.js";let F,Qe=Promise.all([(()=>{try{return ve}catch{}})(),(()=>{try{return be}catch{}})(),(()=>{try{return Ie}catch{}})(),(()=>{try{return ke}catch{}})(),(()=>{try{return xe}catch{}})(),(()=>{try{return Te}catch{}})(),(()=>{try{return Ce}catch{}})(),(()=>{try{return Ne}catch{}})(),(()=>{try{return Ge}catch{}})(),(()=>{try{return Se}catch{}})(),(()=>{try{return Je}catch{}})(),(()=>{try{return je}catch{}})(),(()=>{try{return ze}catch{}})(),(()=>{try{return Be}catch{}})(),(()=>{try{return Ee}catch{}})(),(()=>{try{return Le}catch{}})(),(()=>{try{return Me}catch{}})()]).then(async()=>{F=Ve(K({__name:"ContractForm",emits:["success"],setup(Re,{expose:N,emit:A}){const{t:I}=O(),k=Ae(),p=m(!1),P=m(""),i=m(!1),x=m(""),r=m({}),G=W({name:[{required:!0,message:"\u5408\u540C\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],customerId:[{required:!0,message:"\u5BA2\u6237\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],orderDate:[{required:!0,message:"\u4E0B\u5355\u65E5\u671F\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],ownerUserId:[{required:!0,message:"\u8D1F\u8D23\u4EBA\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],no:[{required:!0,message:"\u5408\u540C\u7F16\u53F7\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),h=m();$(()=>r.value.productItems,d=>{d&&d.length!==0?r.value.productPrice=d.reduce((u,_)=>isNaN(u+_.totalPrice)?0:u+_.totalPrice,0):r.value.productPrice=0},{deep:!0}),N({open:async(d,u)=>{if(p.value=!0,P.value=I("action."+d),x.value=d,j(),u){i.value=!0;try{r.value=await Ue(u)}finally{i.value=!1}}await z()}});const S=A,J=async()=>{if(h&&await h.value.validate()){i.value=!0;try{const d=l(r.value);x.value==="create"?(await ge(d),k.success(I("common.createSuccess"))):(await we(d),k.success(I("common.updateSuccess"))),p.value=!1,S("success")}finally{i.value=!1}}},j=()=>{var d;r.value={},(d=h.value)==null||d.resetFields()},z=async()=>{await Promise.all([B(),M(),L(),Q()])},D=m([]),B=async()=>{D.value=await he()},T=m([]),E=ee(()=>T.value.filter(d=>d.customerId===r.value.customerId)),L=async()=>{T.value=await De()},U=m([]),M=async()=>{U.value=await Pe()},q=m([]),Q=async()=>{q.value=await qe()};return(d,u)=>{const _=ue,o=de,s=oe,f=se,V=ne,g=me,R=_e,X=ce,Y=pe,C=ie,Z=ye,H=fe;return n(),c(Z,{modelValue:l(p),"onUpdate:modelValue":u[15]||(u[15]=e=>re(p)?p.value=e:null),title:l(P),width:"820"},{footer:t(()=>[a(C,{disabled:l(i),type:"primary",onClick:J},{default:t(()=>[w("\u4FDD\u5B58")]),_:1},8,["disabled"]),a(C,{onClick:u[14]||(u[14]=e=>p.value=!1)},{default:t(()=>[w("\u53D6 \u6D88")]),_:1})]),default:t(()=>[ae((n(),c(Y,{ref_key:"formRef",ref:h,model:l(r),rules:l(G),"label-width":"110px"},{default:t(()=>[a(X,{gutter:20},{default:t(()=>[a(s,{span:12},{default:t(()=>[a(o,{label:"\u5408\u540C\u7F16\u53F7",prop:"no"},{default:t(()=>[a(_,{modelValue:l(r).no,"onUpdate:modelValue":u[0]||(u[0]=e=>l(r).no=e),placeholder:"\u8BF7\u8F93\u5165\u5408\u540C\u7F16\u53F7"},null,8,["modelValue"])]),_:1})]),_:1}),a(s,{span:12},{default:t(()=>[a(o,{label:"\u5408\u540C\u540D\u79F0",prop:"name"},{default:t(()=>[a(_,{modelValue:l(r).name,"onUpdate:modelValue":u[1]||(u[1]=e=>l(r).name=e),placeholder:"\u8BF7\u8F93\u5165\u5408\u540C\u540D\u79F0"},null,8,["modelValue"])]),_:1})]),_:1}),a(s,{span:12},{default:t(()=>[a(o,{label:"\u5BA2\u6237\u540D\u79F0",prop:"customerId"},{default:t(()=>[a(V,{modelValue:l(r).customerId,"onUpdate:modelValue":u[2]||(u[2]=e=>l(r).customerId=e)},{default:t(()=>[(n(!0),v(y,null,b(l(D),e=>(n(),c(f,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),a(s,{span:12},{default:t(()=>[a(o,{label:"\u5546\u673A\u540D\u79F0",prop:"businessId"},{default:t(()=>[a(V,{modelValue:l(r).businessId,"onUpdate:modelValue":u[3]||(u[3]=e=>l(r).businessId=e)},{default:t(()=>[(n(!0),v(y,null,b(l(q),e=>(n(),c(f,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),a(s,{span:12},{default:t(()=>[a(o,{label:"\u4E0B\u5355\u65E5\u671F",prop:"orderDate"},{default:t(()=>[a(g,{modelValue:l(r).orderDate,"onUpdate:modelValue":u[4]||(u[4]=e=>l(r).orderDate=e),placeholder:"\u9009\u62E9\u4E0B\u5355\u65E5\u671F",type:"date","value-format":"x"},null,8,["modelValue"])]),_:1})]),_:1}),a(s,{span:12},{default:t(()=>[a(o,{label:"\u5408\u540C\u91D1\u989D",prop:"price"},{default:t(()=>[a(_,{modelValue:l(r).price,"onUpdate:modelValue":u[5]||(u[5]=e=>l(r).price=e),placeholder:"\u8BF7\u8F93\u5165\u5408\u540C\u91D1\u989D"},null,8,["modelValue"])]),_:1})]),_:1}),a(s,{span:12},{default:t(()=>[a(o,{label:"\u5F00\u59CB\u65F6\u95F4",prop:"startTime"},{default:t(()=>[a(g,{modelValue:l(r).startTime,"onUpdate:modelValue":u[6]||(u[6]=e=>l(r).startTime=e),placeholder:"\u9009\u62E9\u5F00\u59CB\u65F6\u95F4",type:"date","value-format":"x"},null,8,["modelValue"])]),_:1})]),_:1}),a(s,{span:12},{default:t(()=>[a(o,{label:"\u7ED3\u675F\u65F6\u95F4",prop:"endTime"},{default:t(()=>[a(g,{modelValue:l(r).endTime,"onUpdate:modelValue":u[7]||(u[7]=e=>l(r).endTime=e),placeholder:"\u9009\u62E9\u7ED3\u675F\u65F6\u95F4",type:"date","value-format":"x"},null,8,["modelValue"])]),_:1})]),_:1}),a(s,{span:12},{default:t(()=>[a(o,{label:"\u516C\u53F8\u7B7E\u7EA6\u4EBA",prop:"signUserId"},{default:t(()=>[a(V,{modelValue:l(r).signUserId,"onUpdate:modelValue":u[8]||(u[8]=e=>l(r).signUserId=e)},{default:t(()=>[(n(!0),v(y,null,b(l(U),e=>(n(),c(f,{key:e.id,label:e.nickname,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),a(s,{span:12},{default:t(()=>[a(o,{label:"\u5BA2\u6237\u7B7E\u7EA6\u4EBA",prop:"contactId"},{default:t(()=>[a(V,{modelValue:l(r).contactId,"onUpdate:modelValue":u[9]||(u[9]=e=>l(r).contactId=e),disabled:!l(r).customerId},{default:t(()=>[(n(!0),v(y,null,b(l(E),e=>(n(),c(f,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1})]),_:1}),a(s,{span:12},{default:t(()=>[a(o,{label:"\u8D1F\u8D23\u4EBA",prop:"ownerUserId"},{default:t(()=>[a(V,{modelValue:l(r).ownerUserId,"onUpdate:modelValue":u[10]||(u[10]=e=>l(r).ownerUserId=e)},{default:t(()=>[(n(!0),v(y,null,b(l(U),e=>(n(),c(f,{key:e.id,label:e.nickname,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),a(s,{span:24},{default:t(()=>[a(o,{label:"\u5907\u6CE8",prop:"remark"},{default:t(()=>[a(_,{modelValue:l(r).remark,"onUpdate:modelValue":u[11]||(u[11]=e=>l(r).remark=e),rows:3,placeholder:"\u8BF7\u8F93\u5165\u5907\u6CE8",type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1}),a(s,{span:24},{default:t(()=>[a(o,{label:"\u4EA7\u54C1\u5217\u8868",prop:"productList"},{default:t(()=>[a(Fe,{modelValue:l(r).productItems,"onUpdate:modelValue":u[12]||(u[12]=e=>l(r).productItems=e)},null,8,["modelValue"])]),_:1})]),_:1}),a(s,{span:12},{default:t(()=>[a(o,{label:"\u6574\u5355\u6298\u6263(%)",prop:"discountPercent"},{default:t(()=>[a(R,{modelValue:l(r).discountPercent,"onUpdate:modelValue":u[13]||(u[13]=e=>l(r).discountPercent=e),min:0,max:100,precision:0,placeholder:"\u8BF7\u8F93\u5165\u6574\u5355\u6298\u6263",class:"!w-100%"},null,8,["modelValue"])]),_:1})]),_:1}),a(s,{span:12},{default:t(()=>[a(o,{label:"\u4EA7\u54C1\u603B\u91D1\u989D(\u5143)",prop:"productPrice"},{default:t(()=>[w(le(l(te)(l(r).productPrice)),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])),[[H,l(i)]])]),_:1},8,["modelValue","title"])}}}),[["__file","E:/newCode/GYZX-UI-ADMIN/src/views/crm/contract/ContractForm.vue"]])});export{Qe as __tla,F as default};
